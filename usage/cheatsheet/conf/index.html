<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Aetherinox">
      
      
        <link rel="canonical" href="https://aetherinox.github.io/csf-firewall/usage/cheatsheet/conf/">
      
      
        <link rel="prev" href="../commands/">
      
      
        <link rel="next" href="../ports/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Cheatsheet › Example Configs - ConfigServer Security &amp; Firewall</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../css/timeago.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css?v1.000">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    <link rel="stylesheet" href="../../../assets/stylesheets/custom.00c04c01.min.css">

  <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: black; }
            .glightbox-clean .gslide-media { -webkit-box-shadow: none; box-shadow: none; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cheatsheet-example-configs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
              </button>
            
            
    <span class="csf-alert">:aetherx-axs-exclamation: Security Alert: Original ConfigServer Update Domain Hihacked</span>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
    You're not viewing the latest version.
    <a href="../../../.."> 
      <strong>Click here to go to latest.</strong>
    </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ConfigServer Security &amp; Firewall" class="md-header__button md-logo" aria-label="ConfigServer Security &amp; Firewall" data-md-component="logo">
      
  
  <svg viewBox="0 0 512 512" id="svgContainer" xmlns="http://www.w3.org/2000/svg">
      <path d="M 153.171 309.301 C 148.062 327.815, 138.987 342.266, 119.133 363.500 C 109.551 373.749, 107.194 376.959, 102.985 385.500 C 100.275 391, 97.535 397.965, 96.897 400.979 C 95.424 407.931, 96.292 425.010, 98.416 430.876 C 100.650 437.047, 100.462 439.887, 97.750 440.926 C 95.766 441.686, 96.504 442.273, 104 445.893 C 132.088 459.458, 175.989 459.768, 204.481 446.604 C 210.886 443.645, 212.098 442.722, 211.493 441.263 C 210.463 438.780, 210.501 438.470, 212.999 429.045 C 214.880 421.949, 215.157 418.895, 214.727 410.045 C 213.852 392.089, 209.622 383.465, 192.358 364.444 C 173.286 343.430, 166.546 332.810, 160.138 313.672 C 157.960 307.167, 156.010 301.677, 155.806 301.472 C 155.601 301.268, 154.415 304.791, 153.171 309.301" stroke="none" fill="#ffffff" fill-rule="evenodd"></path>
      <path d="M 120.443 42.092 C 120.072 42.692, 120.334 48.892, 121.025 55.868 C 122.734 73.123, 121.834 101.029, 119.098 115.650 C 113.658 144.719, 102.901 172.578, 86.723 199.500 C 79.301 211.850, 71.923 222.169, 58.657 238.756 C 46.630 253.794, 40.414 263.476, 35.702 274.509 C 28.692 290.924, 26 305.061, 26 325.455 C 26 359.052, 35.782 385.759, 56.918 409.867 C 67.788 422.265, 88.355 438.659, 95.136 440.331 C 99.522 441.412, 100.624 438.988, 98.594 432.724 C 93.944 418.376, 94.445 403.998, 100.066 390.496 C 104.313 380.295, 107.276 376.029, 119.039 363.175 C 133.842 347.001, 139.451 339.666, 144.411 330 C 148.769 321.509, 153.300 309.246, 154.557 302.548 C 154.923 300.597, 155.510 299.003, 155.861 299.007 C 156.213 299.011, 157.235 302.048, 158.133 305.757 C 163.479 327.837, 171.047 340.053, 198.553 371 C 206.162 379.561, 211.611 389.038, 214.079 398 C 216.152 405.531, 215.660 421.296, 213.056 430.746 C 209.570 443.393, 211.350 444.796, 222.095 437.873 C 244.494 423.441, 262.315 404.262, 272.925 383.171 C 277.465 374.146, 282.641 358.067, 284.570 347 C 286.561 335.581, 286.034 313.718, 283.487 302 C 278.365 278.442, 267.866 256.933, 252.003 237.500 C 225.216 204.685, 206.613 159.041, 204.156 120.105 C 203.619 111.600, 203.171 109.510, 201.691 108.605 C 199.052 106.992, 197.527 109.581, 196.129 118.050 C 195.486 121.940, 191.811 133.439, 187.961 143.602 C 184.112 153.765, 179.940 165.620, 178.691 169.947 L 176.420 177.814 173.725 163.521 C 168.619 136.444, 157.730 102.947, 146.074 78.467 C 140.130 65.984, 128.918 45.801, 126.231 42.750 C 124.499 40.784, 121.465 40.439, 120.443 42.092" stroke="none" fill="#cc1414" fill-rule="evenodd"></path>
      <path d="M 255.366 195.488 C 254.607 197.466, 258.183 203.384, 267.458 215.500 C 285.451 239.004, 288.248 242.987, 293.242 252.222 L 298.500 261.943 317.782 261.972 C 340.632 262.005, 343.009 261.400, 346.010 254.788 C 347.749 250.956, 347.958 248.130, 347.978 228.218 C 348.002 203.832, 347.410 200.562, 342.199 196.286 C 339.510 194.080, 339.342 194.072, 297.719 194.036 C 261.634 194.005, 255.859 194.203, 255.366 195.488 M 378.164 195.689 C 371.640 198.904, 371.500 199.581, 371.500 228 C 371.500 256.524, 371.638 257.177, 378.326 260.351 C 381.406 261.812, 387.258 262, 429.651 261.996 C 475.880 261.993, 477.612 261.924, 480.810 259.974 C 486.469 256.524, 487 253.781, 487 228 C 487 202.219, 486.469 199.476, 480.810 196.026 C 477.610 194.075, 475.902 194.008, 429.500 194.027 C 387.011 194.043, 381.117 194.234, 378.164 195.689 M 307.499 284.001 C 307.159 284.552, 307.902 289.615, 309.151 295.251 C 311.112 304.102, 311.444 308.638, 311.579 328.500 L 311.735 351.500 394.784 351.756 L 477.833 352.011 481.052 349.302 C 486.590 344.643, 487 342.435, 486.998 317.282 C 486.997 291.276, 486.516 289.226, 479.500 285.282 L 475.500 283.033 391.809 283.016 C 336.993 283.006, 307.904 283.346, 307.499 284.001 M 124.437 357.250 L 121.500 360.500 124.750 357.563 C 126.537 355.948, 128 354.485, 128 354.313 C 128 353.540, 127.175 354.221, 124.437 357.250 M 191 363.313 C 191 363.485, 192.463 364.948, 194.250 366.563 L 197.500 369.500 194.563 366.250 C 191.825 363.221, 191 362.540, 191 363.313 M 306.233 374.250 C 305.676 374.938, 303.326 380, 301.011 385.500 C 293.737 402.778, 283.812 418.621, 270.668 433.940 C 268.101 436.932, 266 440.004, 266 440.767 C 266 441.929, 271.858 442.100, 302.250 441.827 C 334.949 441.532, 338.860 441.321, 342.173 439.673 C 348.608 436.471, 349 434.525, 349 405.802 L 349 380.406 345.208 376.703 L 341.416 373 324.330 373 C 311.868  373, 306.971 373.338, 306.233 374.250 M 376.697 376.798 L 372.905 380.682 373.203 407.262 L 373.500 433.842 376 436.516 C 381.224 442.103, 380.227 442, 429.200 441.994 C 457.195 441.991, 475.917 441.595, 478.209 440.959 C 480.248 440.392, 483.286 438.560, 484.959 436.887 L 488 433.846 488 408.324 C 488 387.712, 487.712 382.194, 486.500 379.642 C 483.497 373.312, 485.379 373.529, 430.495 373.207 L 380.489 372.915 376.697 376.798 M 95.286 412.500 C 95.294 415.250, 95.488 416.256, 95.718 414.736 C  95.947 413.216, 95.941  410.966, 95.704 409.736 C 95.467 408.506, 95.279 409.750, 95.286 412.500 M 215.286 412.500 C 215.294 415.250, 215.488 416.256, 215.718 414.736 C 215.947 413.216, 215.941 410.966, 215.704 409.736 C 215.467 408.506, 215.279 409.750, 215.286 412.500" stroke="none" fill="#b3b3b3" fill-rule="evenodd"></path>
</svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ConfigServer Security &amp; Firewall
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cheatsheet › Example Configs
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="main" data-md-color-primary="custom" data-md-color-accent="custom" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aetherinox/csf-firewall" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
  </div>
  <div class="md-source__repository">
    Aetherinox/csf-firewall
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../home/" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../about/csf/" class="md-tabs__link">
          
  
  
    
  
  About

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../install/dependencies/" class="md-tabs__link">
          
  
  
    
  
  Install

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../getting-started/" class="md-tabs__link">
          
  
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../advanced/" class="md-tabs__link">
          
  
  
    
  
  Advanced

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../services/" class="md-tabs__link">
          
  
  
    
  
  Services

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../insiders/about/" class="md-tabs__link">
          
  
  
    
  
  Insiders

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../about/changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://discord.configserver.dev" class="md-tabs__link">
        
  
  
    
  
  Discord

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://tickets.configserver.dev" class="md-tabs__link">
        
  
  
    
  
  Create Ticket

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://buymeacoffee.com/aetherinox" class="md-tabs__link">
        
  
  
    
  
  Sponsor

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ConfigServer Security &amp; Firewall" class="md-nav__button md-logo" aria-label="ConfigServer Security &amp; Firewall" data-md-component="logo">
      
  
  <svg viewBox="0 0 512 512" id="svgContainer" xmlns="http://www.w3.org/2000/svg">
      <path d="M 153.171 309.301 C 148.062 327.815, 138.987 342.266, 119.133 363.500 C 109.551 373.749, 107.194 376.959, 102.985 385.500 C 100.275 391, 97.535 397.965, 96.897 400.979 C 95.424 407.931, 96.292 425.010, 98.416 430.876 C 100.650 437.047, 100.462 439.887, 97.750 440.926 C 95.766 441.686, 96.504 442.273, 104 445.893 C 132.088 459.458, 175.989 459.768, 204.481 446.604 C 210.886 443.645, 212.098 442.722, 211.493 441.263 C 210.463 438.780, 210.501 438.470, 212.999 429.045 C 214.880 421.949, 215.157 418.895, 214.727 410.045 C 213.852 392.089, 209.622 383.465, 192.358 364.444 C 173.286 343.430, 166.546 332.810, 160.138 313.672 C 157.960 307.167, 156.010 301.677, 155.806 301.472 C 155.601 301.268, 154.415 304.791, 153.171 309.301" stroke="none" fill="#ffffff" fill-rule="evenodd"></path>
      <path d="M 120.443 42.092 C 120.072 42.692, 120.334 48.892, 121.025 55.868 C 122.734 73.123, 121.834 101.029, 119.098 115.650 C 113.658 144.719, 102.901 172.578, 86.723 199.500 C 79.301 211.850, 71.923 222.169, 58.657 238.756 C 46.630 253.794, 40.414 263.476, 35.702 274.509 C 28.692 290.924, 26 305.061, 26 325.455 C 26 359.052, 35.782 385.759, 56.918 409.867 C 67.788 422.265, 88.355 438.659, 95.136 440.331 C 99.522 441.412, 100.624 438.988, 98.594 432.724 C 93.944 418.376, 94.445 403.998, 100.066 390.496 C 104.313 380.295, 107.276 376.029, 119.039 363.175 C 133.842 347.001, 139.451 339.666, 144.411 330 C 148.769 321.509, 153.300 309.246, 154.557 302.548 C 154.923 300.597, 155.510 299.003, 155.861 299.007 C 156.213 299.011, 157.235 302.048, 158.133 305.757 C 163.479 327.837, 171.047 340.053, 198.553 371 C 206.162 379.561, 211.611 389.038, 214.079 398 C 216.152 405.531, 215.660 421.296, 213.056 430.746 C 209.570 443.393, 211.350 444.796, 222.095 437.873 C 244.494 423.441, 262.315 404.262, 272.925 383.171 C 277.465 374.146, 282.641 358.067, 284.570 347 C 286.561 335.581, 286.034 313.718, 283.487 302 C 278.365 278.442, 267.866 256.933, 252.003 237.500 C 225.216 204.685, 206.613 159.041, 204.156 120.105 C 203.619 111.600, 203.171 109.510, 201.691 108.605 C 199.052 106.992, 197.527 109.581, 196.129 118.050 C 195.486 121.940, 191.811 133.439, 187.961 143.602 C 184.112 153.765, 179.940 165.620, 178.691 169.947 L 176.420 177.814 173.725 163.521 C 168.619 136.444, 157.730 102.947, 146.074 78.467 C 140.130 65.984, 128.918 45.801, 126.231 42.750 C 124.499 40.784, 121.465 40.439, 120.443 42.092" stroke="none" fill="#cc1414" fill-rule="evenodd"></path>
      <path d="M 255.366 195.488 C 254.607 197.466, 258.183 203.384, 267.458 215.500 C 285.451 239.004, 288.248 242.987, 293.242 252.222 L 298.500 261.943 317.782 261.972 C 340.632 262.005, 343.009 261.400, 346.010 254.788 C 347.749 250.956, 347.958 248.130, 347.978 228.218 C 348.002 203.832, 347.410 200.562, 342.199 196.286 C 339.510 194.080, 339.342 194.072, 297.719 194.036 C 261.634 194.005, 255.859 194.203, 255.366 195.488 M 378.164 195.689 C 371.640 198.904, 371.500 199.581, 371.500 228 C 371.500 256.524, 371.638 257.177, 378.326 260.351 C 381.406 261.812, 387.258 262, 429.651 261.996 C 475.880 261.993, 477.612 261.924, 480.810 259.974 C 486.469 256.524, 487 253.781, 487 228 C 487 202.219, 486.469 199.476, 480.810 196.026 C 477.610 194.075, 475.902 194.008, 429.500 194.027 C 387.011 194.043, 381.117 194.234, 378.164 195.689 M 307.499 284.001 C 307.159 284.552, 307.902 289.615, 309.151 295.251 C 311.112 304.102, 311.444 308.638, 311.579 328.500 L 311.735 351.500 394.784 351.756 L 477.833 352.011 481.052 349.302 C 486.590 344.643, 487 342.435, 486.998 317.282 C 486.997 291.276, 486.516 289.226, 479.500 285.282 L 475.500 283.033 391.809 283.016 C 336.993 283.006, 307.904 283.346, 307.499 284.001 M 124.437 357.250 L 121.500 360.500 124.750 357.563 C 126.537 355.948, 128 354.485, 128 354.313 C 128 353.540, 127.175 354.221, 124.437 357.250 M 191 363.313 C 191 363.485, 192.463 364.948, 194.250 366.563 L 197.500 369.500 194.563 366.250 C 191.825 363.221, 191 362.540, 191 363.313 M 306.233 374.250 C 305.676 374.938, 303.326 380, 301.011 385.500 C 293.737 402.778, 283.812 418.621, 270.668 433.940 C 268.101 436.932, 266 440.004, 266 440.767 C 266 441.929, 271.858 442.100, 302.250 441.827 C 334.949 441.532, 338.860 441.321, 342.173 439.673 C 348.608 436.471, 349 434.525, 349 405.802 L 349 380.406 345.208 376.703 L 341.416 373 324.330 373 C 311.868  373, 306.971 373.338, 306.233 374.250 M 376.697 376.798 L 372.905 380.682 373.203 407.262 L 373.500 433.842 376 436.516 C 381.224 442.103, 380.227 442, 429.200 441.994 C 457.195 441.991, 475.917 441.595, 478.209 440.959 C 480.248 440.392, 483.286 438.560, 484.959 436.887 L 488 433.846 488 408.324 C 488 387.712, 487.712 382.194, 486.500 379.642 C 483.497 373.312, 485.379 373.529, 430.495 373.207 L 380.489 372.915 376.697 376.798 M 95.286 412.500 C 95.294 415.250, 95.488 416.256, 95.718 414.736 C  95.947 413.216, 95.941  410.966, 95.704 409.736 C 95.467 408.506, 95.279 409.750, 95.286 412.500 M 215.286 412.500 C 215.294 415.250, 215.488 416.256, 215.718 414.736 C 215.947 413.216, 215.941 410.966, 215.704 409.736 C 215.467 408.506, 215.279 409.750, 215.286 412.500" stroke="none" fill="#b3b3b3" fill-rule="evenodd"></path>
</svg>

    </a>
    ConfigServer Security &amp; Firewall
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aetherinox/csf-firewall" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"></path></svg>
  </div>
  <div class="md-source__repository">
    Aetherinox/csf-firewall
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    About
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/csf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/license/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/privacy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Privacy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5">
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Wiki
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Wiki
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/conventions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Conventions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/tags/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tags
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3">
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Install
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/dependencies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dependencies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Download
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Diagnostic Tests
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Start Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/webui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enable Web Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/uninstall/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Uninstall
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../install/update/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Update
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Update
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/update/v1500-to-v1501/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    v15.00 to v15.01
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/update/v1501-to-newer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    v15.01 to Newer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9">
        
          
          <label class="md-nav__link" for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/integrations/abuseipdb/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    AbuseIPDB
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/integrations/authentik/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentik
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/integrations/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Docker
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../install/integrations/traefik/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Traefik
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Usage
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../prepost/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pre &amp; Post Scripts
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../blocklists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blocklists
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ipset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ipsets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../geoip/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Geographical Blocks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../troubleshooting/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Troubleshooting
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_7" id="__nav_4_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Troubleshooting
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/cyberpanel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Cyberpanel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/dependencies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Dependencies
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--new" title="Recently Added">
    </span>
  

  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../troubleshooting/webui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Web Interface
  

    
  </span>
  
  
    
  
  
    <span class="md-status md-status--new" title="Recently Added">
    </span>
  

  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" checked>
        
          
          <label class="md-nav__link" for="__nav_4_8" id="__nav_4_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Cheatsheet
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cheatsheet
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../home/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commands/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Commands
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../control_panels.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Control Panels
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Example Configs
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Example Configs
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#full-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        Full Version
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean Version
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ports/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ports
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../structure/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Structure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../advanced/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Advanced
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../advanced/csget/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CSGet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../services/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Services
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/blocklist.configserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    blocklist.configserver.dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/download.configserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    download.configserver.dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/get.configserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    get.configserver.dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7">
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Insiders
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Insiders
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../insiders/about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../insiders/payments_and_billing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Payments and Billing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../insiders/join/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Join Insiders
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../insiders/sponsors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Our Sponsors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_5">
        
          
          <label class="md-nav__link" for="__nav_7_5" id="__nav_7_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Using Insiders
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Using Insiders
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../insiders/setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../insiders/disable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../about/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9">
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../blog/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_9" id="__nav_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_2">
        
          
          <label class="md-nav__link" for="__nav_9_2" id="__nav_9_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Archive
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Archive
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/2025/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    December 2025
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_3">
        
          
          <label class="md-nav__link" for="__nav_9_3" id="__nav_9_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/csfajaxtail/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csfajaxtail
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/csp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    csp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/cyberpanel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cyberpanel
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/downloadconfigserverdev/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    download.configserver.dev
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/initd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    init.d
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/release/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    release
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/release-alpha/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    release-alpha
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ui
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/v15x/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    v15.x
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/vestacp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    vestacp
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/web-inteface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    web-inteface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/web-login/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    web-login
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/web-theme-dark/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    web-theme-dark
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../blog/webmin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    webmin
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://discord.configserver.dev" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Discord
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://tickets.configserver.dev" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create Ticket
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://buymeacoffee.com/aetherinox" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sponsor
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#full-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        Full Version
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clean-version" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clean Version
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                




  <nav class="md-path" aria-label="Navigation">
    <ol class="md-path__list">
      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../../getting-started/" class="md-path__link">
          
  <span class="md-ellipsis">
    Usage
  </span>

        </a>
      </li>
    
  

      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../home/" class="md-path__link">
          
  <span class="md-ellipsis">
    Cheatsheet
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags">
    
      
      
      
        
        
      
      
        <a href="../../../about/tags/#tag:cheatsheet" class="md-tag md-tag-icon">cheatsheet</a>
      
    
      
      
      
        
        
      
      
        <a href="../../../about/tags/#tag:configs" class="md-tag md-tag-icon">configs</a>
      
    
      
      
      
        
        
      
      
        <a href="../../../about/tags/#tag:configure" class="md-tag md-tag-icon">configure</a>
      
    
      
      
      
        
        
      
      
        <a href="../../../about/tags/#tag:resource" class="md-tag md-tag-icon">resource</a>
      
    
  </nav>


  
    <a href="https://github.com/aetherinox/csf-firewall/edit/main/docs/docs/usage/cheatsheet/conf.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"></path></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/aetherinox/csf-firewall/raw/main/docs/docs/usage/cheatsheet/conf.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"></path></svg>
    </a>
  


<h1 id="cheatsheet-example-configs">Cheatsheet: Example Configs <!-- omit from toc --><a class="headerlink" data-preview="" href="#cheatsheet-example-configs" title="Permanent link">¶</a></h1>
<p>Two versions of the config file have been provided below. A <strong>full version</strong> which contains comments, and a <strong>clean version</strong> which contains no comments and only the config settings. </p>
<p>You may copy the contents, and place it within your server under the path <code>/etc/csf/csf.conf</code>.</p>
<ul>
<li><a data-preview="" href="#full-version">Full Version</a></li>
<li><a data-preview="" href="#clean-version">Clean Version</a></li>
</ul>
<p><br></p>
<p>After you have set your config file to its desired values; you must restart the <abbr title="ConfigServer Security &amp; Firewall">CSF</abbr> service to apply the configurations. Open Terminal and run:</p>
<div class="language-shell highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>csf<span class="w"> </span>-r
</code></pre></div>
<p><br></p>
<p>You can also restart both <abbr title="ConfigServer Security &amp; Firewall">CSF</abbr> and <abbr title="Login Failure Daemon">LFD</abbr> <abbr title="In Traefik, services represent the backend applications or containers that ultimately handle requests. A service defines how Traefik connects to your app (load balancing, health checks, servers list, etc.).">services</abbr> with <code>-ra, --restartall</code></p>
<div class="language-shell highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>csf<span class="w"> </span>-ra
</code></pre></div>
<p><br></p>
<hr>
<p><br></p>
<h2 id="full-version">Full Version<a class="headerlink" data-preview="" href="#full-version" title="Permanent link">¶</a></h2>
<p>This is a copy of the original <abbr title="ConfigServer Security &amp; Firewall">CSF</abbr> <code>/etc/csf/csf.conf</code> config file available from our <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM252.8 8c-138.7 0-244.8 105.3-244.8 244 0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1 100-33.2 167.8-128.1 167.8-239 0-138.7-112.5-244-251.2-244zM105.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> <a href="https://github.com/Aetherinox/csf-firewall">repository</a>. It contains all comments and is the version you receive when downloading the latest version of <abbr title="A security suite for Linux servers that provides firewall management, intrusion detection, and login failure monitoring.">ConfigServer Security &amp; Firewall</abbr>.</p>
<div class="language-ini highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="c1"># SECTION:Initial Settings</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="c1"># Testing flag - enables a CRON job that clears iptables incase of</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1"># configuration problems when you start csf. This should be enabled until you</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1"># are sure that the firewall works - i.e. incase you get locked out of your</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="c1"># server! Then do remember to set it to 0 and restart csf when you're sure</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="c1"># everything is OK. Stopping csf will remove the line from /etc/crontab</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="c1">#</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="c1"># lfd will not start while this is enabled</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="na">TESTING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="c1"># The interval for the crontab in minutes. Since this uses the system clock the</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="c1"># CRON job will run at the interval past the hour and not from when you issue</span>
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="c1"># the start command. Therefore an interval of 5 minutes means the firewall</span>
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="c1"># will be cleared in 0-5 minutes from the firewall start</span>
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="na">TESTING_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="c1"># SECURITY WARNING</span>
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="c1"># ================</span>
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="c1">#</span>
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="c1"># Unfortunately, syslog and rsyslog allow end-users to log messages to some</span>
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="c1"># system logs via the same unix socket that other local services use. This </span>
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="c1"># means that any log line shown in these system logs that syslog or rsyslog</span>
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a><span class="c1"># maintain can be spoofed (they are exactly the same as real log lines).</span>
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a><span class="c1">#</span>
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a><span class="c1"># Since some of the features of lfd rely on such log lines, spoofed messages</span>
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="c1"># can cause false-positive matches which can lead to confusion at best, or</span>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="c1"># blocking of any innocent IP address or making the server inaccessible at</span>
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="c1"># worst.</span>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="c1">#</span>
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="c1"># Any option that relies on the log entries in the files listed in</span>
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="c1"># /etc/syslog.conf and /etc/rsyslog.conf should therefore be considered</span>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a><span class="c1"># vulnerable to exploitation by end-users and scripts run by end-users.</span>
<a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a><span class="c1">#</span>
<a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a><span class="c1"># NOTE: Not all log files are affected as they may not use syslog/rsyslog</span>
<a id="__codelineno-2-37" name="__codelineno-2-37" href="#__codelineno-2-37"></a><span class="c1">#</span>
<a id="__codelineno-2-38" name="__codelineno-2-38" href="#__codelineno-2-38"></a><span class="c1"># The option RESTRICT_SYSLOG disables all these features that rely on affected</span>
<a id="__codelineno-2-39" name="__codelineno-2-39" href="#__codelineno-2-39"></a><span class="c1"># logs. These options are:</span>
<a id="__codelineno-2-40" name="__codelineno-2-40" href="#__codelineno-2-40"></a><span class="c1"># LF_SSHD LF_FTPD LF_IMAPD LF_POP3D LF_BIND LF_SUHOSIN LF_SSH_EMAIL_ALERT</span>
<a id="__codelineno-2-41" name="__codelineno-2-41" href="#__codelineno-2-41"></a><span class="c1"># LF_SU_EMAIL_ALERT LF_CONSOLE_EMAIL_ALERT LF_DISTATTACK LF_DISTFTP</span>
<a id="__codelineno-2-42" name="__codelineno-2-42" href="#__codelineno-2-42"></a><span class="c1"># LT_POP3D LT_IMAPD PS_INTERVAL UID_INTERVAL WEBMIN_LOG LF_WEBMIN_EMAIL_ALERT</span>
<a id="__codelineno-2-43" name="__codelineno-2-43" href="#__codelineno-2-43"></a><span class="c1"># PORTKNOCKING_ALERT LF_SUDO_EMAIL_ALERT</span>
<a id="__codelineno-2-44" name="__codelineno-2-44" href="#__codelineno-2-44"></a><span class="c1">#</span>
<a id="__codelineno-2-45" name="__codelineno-2-45" href="#__codelineno-2-45"></a><span class="c1"># This list of options use the logs but are not disabled by RESTRICT_SYSLOG:</span>
<a id="__codelineno-2-46" name="__codelineno-2-46" href="#__codelineno-2-46"></a><span class="c1"># ST_ENABLE SYSLOG_CHECK LOGSCANNER CUSTOM*_LOG</span>
<a id="__codelineno-2-47" name="__codelineno-2-47" href="#__codelineno-2-47"></a><span class="c1">#</span>
<a id="__codelineno-2-48" name="__codelineno-2-48" href="#__codelineno-2-48"></a><span class="c1"># The following options are still enabled by default on new installations so</span>
<a id="__codelineno-2-49" name="__codelineno-2-49" href="#__codelineno-2-49"></a><span class="c1"># that, on balance, csf/lfd still provides expected levels of security:</span>
<a id="__codelineno-2-50" name="__codelineno-2-50" href="#__codelineno-2-50"></a><span class="c1"># LF_SSHD LF_FTPD LF_POP3D LF_IMAPD LF_SSH_EMAIL_ALERT LF_SU_EMAIL_ALERT</span>
<a id="__codelineno-2-51" name="__codelineno-2-51" href="#__codelineno-2-51"></a><span class="c1">#</span>
<a id="__codelineno-2-52" name="__codelineno-2-52" href="#__codelineno-2-52"></a><span class="c1"># If you set RESTRICT_SYSLOG to "0" or "2" and enable any of the options listed</span>
<a id="__codelineno-2-53" name="__codelineno-2-53" href="#__codelineno-2-53"></a><span class="c1"># above, it should be done with the knowledge that any of the those options</span>
<a id="__codelineno-2-54" name="__codelineno-2-54" href="#__codelineno-2-54"></a><span class="c1"># that are enabled could be triggered by spoofed log lines and lead to the</span>
<a id="__codelineno-2-55" name="__codelineno-2-55" href="#__codelineno-2-55"></a><span class="c1"># server being inaccessible in the worst case. If you do not want to take that</span>
<a id="__codelineno-2-56" name="__codelineno-2-56" href="#__codelineno-2-56"></a><span class="c1"># risk you should set RESTRICT_SYSLOG to "1" and those features will not work</span>
<a id="__codelineno-2-57" name="__codelineno-2-57" href="#__codelineno-2-57"></a><span class="c1"># but you will not be protected from the exploits that they normally help block</span>
<a id="__codelineno-2-58" name="__codelineno-2-58" href="#__codelineno-2-58"></a><span class="c1">#</span>
<a id="__codelineno-2-59" name="__codelineno-2-59" href="#__codelineno-2-59"></a><span class="c1"># The recommended setting for RESTRICT_SYSLOG is "3" to restrict who can access</span>
<a id="__codelineno-2-60" name="__codelineno-2-60" href="#__codelineno-2-60"></a><span class="c1"># the syslog/rsyslog unix socket.</span>
<a id="__codelineno-2-61" name="__codelineno-2-61" href="#__codelineno-2-61"></a><span class="c1">#</span>
<a id="__codelineno-2-62" name="__codelineno-2-62" href="#__codelineno-2-62"></a><span class="c1"># For further advice on how to help mitigate these issues, see</span>
<a id="__codelineno-2-63" name="__codelineno-2-63" href="#__codelineno-2-63"></a><span class="c1"># /etc/csf/readme.txt</span>
<a id="__codelineno-2-64" name="__codelineno-2-64" href="#__codelineno-2-64"></a><span class="c1">#</span>
<a id="__codelineno-2-65" name="__codelineno-2-65" href="#__codelineno-2-65"></a><span class="c1"># 0 = Allow those options listed above to be used and configured</span>
<a id="__codelineno-2-66" name="__codelineno-2-66" href="#__codelineno-2-66"></a><span class="c1"># 1 = Disable all the options listed above and prevent them from being used</span>
<a id="__codelineno-2-67" name="__codelineno-2-67" href="#__codelineno-2-67"></a><span class="c1"># 2 = Disable only alerts about this feature and do nothing else</span>
<a id="__codelineno-2-68" name="__codelineno-2-68" href="#__codelineno-2-68"></a><span class="c1"># 3 = Restrict syslog/rsyslog access to RESTRICT_SYSLOG_GROUP ** RECOMMENDED **</span>
<a id="__codelineno-2-69" name="__codelineno-2-69" href="#__codelineno-2-69"></a><span class="na">RESTRICT_SYSLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-70" name="__codelineno-2-70" href="#__codelineno-2-70"></a>
<a id="__codelineno-2-71" name="__codelineno-2-71" href="#__codelineno-2-71"></a><span class="c1"># The following setting is used if RESTRICT_SYSLOG is set to 3. It restricts</span>
<a id="__codelineno-2-72" name="__codelineno-2-72" href="#__codelineno-2-72"></a><span class="c1"># write access to the syslog/rsyslog unix socket(s). The group must not already</span>
<a id="__codelineno-2-73" name="__codelineno-2-73" href="#__codelineno-2-73"></a><span class="c1"># exists in /etc/group before setting RESTRICT_SYSLOG to 3, so set the option</span>
<a id="__codelineno-2-74" name="__codelineno-2-74" href="#__codelineno-2-74"></a><span class="c1"># to a unique name for the server</span>
<a id="__codelineno-2-75" name="__codelineno-2-75" href="#__codelineno-2-75"></a><span class="c1">#</span>
<a id="__codelineno-2-76" name="__codelineno-2-76" href="#__codelineno-2-76"></a><span class="c1"># You can add users to this group by changing /etc/csf/csf.syslogusers and then</span>
<a id="__codelineno-2-77" name="__codelineno-2-77" href="#__codelineno-2-77"></a><span class="c1"># restarting lfd afterwards. This will create the system group and add the</span>
<a id="__codelineno-2-78" name="__codelineno-2-78" href="#__codelineno-2-78"></a><span class="c1"># users from csf.syslogusers if they exist to that group and will change the</span>
<a id="__codelineno-2-79" name="__codelineno-2-79" href="#__codelineno-2-79"></a><span class="c1"># permissions on the syslog/rsyslog unix socket(s). The socket(s) will be</span>
<a id="__codelineno-2-80" name="__codelineno-2-80" href="#__codelineno-2-80"></a><span class="c1"># monitored and the permissions re-applied should syslog/rsyslog be restarted</span>
<a id="__codelineno-2-81" name="__codelineno-2-81" href="#__codelineno-2-81"></a><span class="c1">#</span>
<a id="__codelineno-2-82" name="__codelineno-2-82" href="#__codelineno-2-82"></a><span class="c1"># Using this option will prevent some legitimate logging, e.g. end-user cron</span>
<a id="__codelineno-2-83" name="__codelineno-2-83" href="#__codelineno-2-83"></a><span class="c1"># job logs</span>
<a id="__codelineno-2-84" name="__codelineno-2-84" href="#__codelineno-2-84"></a><span class="c1">#</span>
<a id="__codelineno-2-85" name="__codelineno-2-85" href="#__codelineno-2-85"></a><span class="c1"># If you want to revert RESTRICT_SYSLOG to another option and disable this</span>
<a id="__codelineno-2-86" name="__codelineno-2-86" href="#__codelineno-2-86"></a><span class="c1"># feature, change the setting of RESTRICT_SYSLOG and then restart lfd and then</span>
<a id="__codelineno-2-87" name="__codelineno-2-87" href="#__codelineno-2-87"></a><span class="c1"># syslog/rsyslog and the unix sockets will be reset</span>
<a id="__codelineno-2-88" name="__codelineno-2-88" href="#__codelineno-2-88"></a><span class="na">RESTRICT_SYSLOG_GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"mysyslog"</span>
<a id="__codelineno-2-89" name="__codelineno-2-89" href="#__codelineno-2-89"></a>
<a id="__codelineno-2-90" name="__codelineno-2-90" href="#__codelineno-2-90"></a><span class="c1"># This options restricts the ability to modify settings within this file from</span>
<a id="__codelineno-2-91" name="__codelineno-2-91" href="#__codelineno-2-91"></a><span class="c1"># the csf UI. Should the parent control panel be compromised, these restricted</span>
<a id="__codelineno-2-92" name="__codelineno-2-92" href="#__codelineno-2-92"></a><span class="c1"># options could be used to further compromise the server. For this reason we</span>
<a id="__codelineno-2-93" name="__codelineno-2-93" href="#__codelineno-2-93"></a><span class="c1"># recommend leaving this option set to at least "1" and if any of the</span>
<a id="__codelineno-2-94" name="__codelineno-2-94" href="#__codelineno-2-94"></a><span class="c1"># restricted items need to be changed, they are done so from the root shell</span>
<a id="__codelineno-2-95" name="__codelineno-2-95" href="#__codelineno-2-95"></a><span class="c1">#</span>
<a id="__codelineno-2-96" name="__codelineno-2-96" href="#__codelineno-2-96"></a><span class="c1"># 0 = Unrestricted UI</span>
<a id="__codelineno-2-97" name="__codelineno-2-97" href="#__codelineno-2-97"></a><span class="c1"># 1 = Restricted UI</span>
<a id="__codelineno-2-98" name="__codelineno-2-98" href="#__codelineno-2-98"></a><span class="c1"># 2 = Disabled UI</span>
<a id="__codelineno-2-99" name="__codelineno-2-99" href="#__codelineno-2-99"></a><span class="na">RESTRICT_UI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-100" name="__codelineno-2-100" href="#__codelineno-2-100"></a>
<a id="__codelineno-2-101" name="__codelineno-2-101" href="#__codelineno-2-101"></a><span class="c1"># Enabling auto updates creates a cron job called /etc/cron.d/csf_update which</span>
<a id="__codelineno-2-102" name="__codelineno-2-102" href="#__codelineno-2-102"></a><span class="c1"># runs once per day to see if there is an update to csf+lfd and upgrades if</span>
<a id="__codelineno-2-103" name="__codelineno-2-103" href="#__codelineno-2-103"></a><span class="c1"># available and restarts csf and lfd</span>
<a id="__codelineno-2-104" name="__codelineno-2-104" href="#__codelineno-2-104"></a><span class="c1">#</span>
<a id="__codelineno-2-105" name="__codelineno-2-105" href="#__codelineno-2-105"></a><span class="c1"># You should check for new version announcements at https://github.com/Aetherinox/csf-firewall</span>
<a id="__codelineno-2-106" name="__codelineno-2-106" href="#__codelineno-2-106"></a><span class="na">AUTO_UPDATES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-107" name="__codelineno-2-107" href="#__codelineno-2-107"></a>
<a id="__codelineno-2-108" name="__codelineno-2-108" href="#__codelineno-2-108"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-109" name="__codelineno-2-109" href="#__codelineno-2-109"></a><span class="c1"># SECTION:IPv4 Port Settings</span>
<a id="__codelineno-2-110" name="__codelineno-2-110" href="#__codelineno-2-110"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-111" name="__codelineno-2-111" href="#__codelineno-2-111"></a><span class="c1"># Lists of ports in the following comma separated lists can be added using a</span>
<a id="__codelineno-2-112" name="__codelineno-2-112" href="#__codelineno-2-112"></a><span class="c1"># colon (e.g. 30000:35000).</span>
<a id="__codelineno-2-113" name="__codelineno-2-113" href="#__codelineno-2-113"></a>
<a id="__codelineno-2-114" name="__codelineno-2-114" href="#__codelineno-2-114"></a><span class="c1"># Some kernel/iptables setups do not perform stateful connection tracking</span>
<a id="__codelineno-2-115" name="__codelineno-2-115" href="#__codelineno-2-115"></a><span class="c1"># correctly (typically some virtual servers or custom compiled kernels), so a</span>
<a id="__codelineno-2-116" name="__codelineno-2-116" href="#__codelineno-2-116"></a><span class="c1"># SPI firewall will not function correctly. If this happens, LF_SPI can be set</span>
<a id="__codelineno-2-117" name="__codelineno-2-117" href="#__codelineno-2-117"></a><span class="c1"># to 0 to reconfigure csf as a static firewall.</span>
<a id="__codelineno-2-118" name="__codelineno-2-118" href="#__codelineno-2-118"></a><span class="c1">#</span>
<a id="__codelineno-2-119" name="__codelineno-2-119" href="#__codelineno-2-119"></a><span class="c1"># As connection tracking will not be configured, applications that rely on it</span>
<a id="__codelineno-2-120" name="__codelineno-2-120" href="#__codelineno-2-120"></a><span class="c1"># will not function unless all outgoing ports are opened. Therefore, all</span>
<a id="__codelineno-2-121" name="__codelineno-2-121" href="#__codelineno-2-121"></a><span class="c1"># outgoing connections will be allowed once all other tests have completed. So</span>
<a id="__codelineno-2-122" name="__codelineno-2-122" href="#__codelineno-2-122"></a><span class="c1"># TCP_OUT, UDP_OUT and ICMP_OUT will not have any affect.</span>
<a id="__codelineno-2-123" name="__codelineno-2-123" href="#__codelineno-2-123"></a><span class="c1">#</span>
<a id="__codelineno-2-124" name="__codelineno-2-124" href="#__codelineno-2-124"></a><span class="c1"># If you allow incoming DNS lookups you may need to use the following</span>
<a id="__codelineno-2-125" name="__codelineno-2-125" href="#__codelineno-2-125"></a><span class="c1"># directive in the options{} section of your named.conf:</span>
<a id="__codelineno-2-126" name="__codelineno-2-126" href="#__codelineno-2-126"></a><span class="c1">#</span>
<a id="__codelineno-2-127" name="__codelineno-2-127" href="#__codelineno-2-127"></a><span class="c1">#        query-source port 53;</span>
<a id="__codelineno-2-128" name="__codelineno-2-128" href="#__codelineno-2-128"></a><span class="c1">#</span>
<a id="__codelineno-2-129" name="__codelineno-2-129" href="#__codelineno-2-129"></a><span class="c1"># This will force incoming DNS traffic only through port 53</span>
<a id="__codelineno-2-130" name="__codelineno-2-130" href="#__codelineno-2-130"></a><span class="c1">#</span>
<a id="__codelineno-2-131" name="__codelineno-2-131" href="#__codelineno-2-131"></a><span class="c1"># Disabling this option will break firewall functionality that relies on</span>
<a id="__codelineno-2-132" name="__codelineno-2-132" href="#__codelineno-2-132"></a><span class="c1"># stateful packet inspection (e.g. DNAT, PACKET_FILTER) and makes the firewall</span>
<a id="__codelineno-2-133" name="__codelineno-2-133" href="#__codelineno-2-133"></a><span class="c1"># less secure</span>
<a id="__codelineno-2-134" name="__codelineno-2-134" href="#__codelineno-2-134"></a><span class="c1">#</span>
<a id="__codelineno-2-135" name="__codelineno-2-135" href="#__codelineno-2-135"></a><span class="c1"># This option should be set to "1" in all other circumstances</span>
<a id="__codelineno-2-136" name="__codelineno-2-136" href="#__codelineno-2-136"></a><span class="na">LF_SPI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-137" name="__codelineno-2-137" href="#__codelineno-2-137"></a>
<a id="__codelineno-2-138" name="__codelineno-2-138" href="#__codelineno-2-138"></a><span class="c1"># Allow incoming TCP ports</span>
<a id="__codelineno-2-139" name="__codelineno-2-139" href="#__codelineno-2-139"></a><span class="na">TCP_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,143,443,465,587,993,995,5000"</span>
<a id="__codelineno-2-140" name="__codelineno-2-140" href="#__codelineno-2-140"></a>
<a id="__codelineno-2-141" name="__codelineno-2-141" href="#__codelineno-2-141"></a><span class="c1"># Allow outgoing TCP ports</span>
<a id="__codelineno-2-142" name="__codelineno-2-142" href="#__codelineno-2-142"></a><span class="na">TCP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,113,443,587,993,995"</span>
<a id="__codelineno-2-143" name="__codelineno-2-143" href="#__codelineno-2-143"></a>
<a id="__codelineno-2-144" name="__codelineno-2-144" href="#__codelineno-2-144"></a><span class="c1"># Allow incoming UDP ports</span>
<a id="__codelineno-2-145" name="__codelineno-2-145" href="#__codelineno-2-145"></a><span class="na">UDP_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,80,443"</span>
<a id="__codelineno-2-146" name="__codelineno-2-146" href="#__codelineno-2-146"></a>
<a id="__codelineno-2-147" name="__codelineno-2-147" href="#__codelineno-2-147"></a><span class="c1"># Allow outgoing UDP ports</span>
<a id="__codelineno-2-148" name="__codelineno-2-148" href="#__codelineno-2-148"></a><span class="c1"># To allow outgoing traceroute add 33434:33523 to this list </span>
<a id="__codelineno-2-149" name="__codelineno-2-149" href="#__codelineno-2-149"></a><span class="na">UDP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,113,123"</span>
<a id="__codelineno-2-150" name="__codelineno-2-150" href="#__codelineno-2-150"></a>
<a id="__codelineno-2-151" name="__codelineno-2-151" href="#__codelineno-2-151"></a><span class="c1"># Allow incoming PING. Disabling PING will likely break external uptime</span>
<a id="__codelineno-2-152" name="__codelineno-2-152" href="#__codelineno-2-152"></a><span class="c1"># monitoring</span>
<a id="__codelineno-2-153" name="__codelineno-2-153" href="#__codelineno-2-153"></a><span class="na">ICMP_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-154" name="__codelineno-2-154" href="#__codelineno-2-154"></a>
<a id="__codelineno-2-155" name="__codelineno-2-155" href="#__codelineno-2-155"></a><span class="c1"># Set the per IP address incoming ICMP packet rate for PING requests. This</span>
<a id="__codelineno-2-156" name="__codelineno-2-156" href="#__codelineno-2-156"></a><span class="c1"># ratelimits PING requests which if exceeded results in silently rejected</span>
<a id="__codelineno-2-157" name="__codelineno-2-157" href="#__codelineno-2-157"></a><span class="c1"># packets. Disable or increase this value if you are seeing PING drops that you</span>
<a id="__codelineno-2-158" name="__codelineno-2-158" href="#__codelineno-2-158"></a><span class="c1"># do not want</span>
<a id="__codelineno-2-159" name="__codelineno-2-159" href="#__codelineno-2-159"></a><span class="c1">#</span>
<a id="__codelineno-2-160" name="__codelineno-2-160" href="#__codelineno-2-160"></a><span class="c1"># To disable rate limiting set to "0", otherwise set according to the iptables</span>
<a id="__codelineno-2-161" name="__codelineno-2-161" href="#__codelineno-2-161"></a><span class="c1"># documentation for the limit module. For example, "1/s" will limit to one</span>
<a id="__codelineno-2-162" name="__codelineno-2-162" href="#__codelineno-2-162"></a><span class="c1"># packet per second</span>
<a id="__codelineno-2-163" name="__codelineno-2-163" href="#__codelineno-2-163"></a><span class="na">ICMP_IN_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1/s"</span>
<a id="__codelineno-2-164" name="__codelineno-2-164" href="#__codelineno-2-164"></a>
<a id="__codelineno-2-165" name="__codelineno-2-165" href="#__codelineno-2-165"></a><span class="c1"># Allow outgoing PING</span>
<a id="__codelineno-2-166" name="__codelineno-2-166" href="#__codelineno-2-166"></a><span class="c1">#</span>
<a id="__codelineno-2-167" name="__codelineno-2-167" href="#__codelineno-2-167"></a><span class="c1"># Unless there is a specific reason, this option should NOT be disabled as it</span>
<a id="__codelineno-2-168" name="__codelineno-2-168" href="#__codelineno-2-168"></a><span class="c1"># could break OS functionality</span>
<a id="__codelineno-2-169" name="__codelineno-2-169" href="#__codelineno-2-169"></a><span class="na">ICMP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-170" name="__codelineno-2-170" href="#__codelineno-2-170"></a>
<a id="__codelineno-2-171" name="__codelineno-2-171" href="#__codelineno-2-171"></a><span class="c1"># Set the per IP address outgoing ICMP packet rate for PING requests. This</span>
<a id="__codelineno-2-172" name="__codelineno-2-172" href="#__codelineno-2-172"></a><span class="c1"># ratelimits PING requests which if exceeded results in silently rejected</span>
<a id="__codelineno-2-173" name="__codelineno-2-173" href="#__codelineno-2-173"></a><span class="c1"># packets. Disable or increase this value if you are seeing PING drops that you</span>
<a id="__codelineno-2-174" name="__codelineno-2-174" href="#__codelineno-2-174"></a><span class="c1"># do not want</span>
<a id="__codelineno-2-175" name="__codelineno-2-175" href="#__codelineno-2-175"></a><span class="c1">#</span>
<a id="__codelineno-2-176" name="__codelineno-2-176" href="#__codelineno-2-176"></a><span class="c1"># Unless there is a specific reason, this option should NOT be enabled as it</span>
<a id="__codelineno-2-177" name="__codelineno-2-177" href="#__codelineno-2-177"></a><span class="c1"># could break OS functionality</span>
<a id="__codelineno-2-178" name="__codelineno-2-178" href="#__codelineno-2-178"></a><span class="c1">#</span>
<a id="__codelineno-2-179" name="__codelineno-2-179" href="#__codelineno-2-179"></a><span class="c1"># To disable rate limiting set to "0", otherwise set according to the iptables</span>
<a id="__codelineno-2-180" name="__codelineno-2-180" href="#__codelineno-2-180"></a><span class="c1"># documentation for the limit module. For example, "1/s" will limit to one</span>
<a id="__codelineno-2-181" name="__codelineno-2-181" href="#__codelineno-2-181"></a><span class="c1"># packet per second</span>
<a id="__codelineno-2-182" name="__codelineno-2-182" href="#__codelineno-2-182"></a><span class="na">ICMP_OUT_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-183" name="__codelineno-2-183" href="#__codelineno-2-183"></a>
<a id="__codelineno-2-184" name="__codelineno-2-184" href="#__codelineno-2-184"></a><span class="c1"># For those with PCI Compliance tools that state that ICMP timestamps (type 13)</span>
<a id="__codelineno-2-185" name="__codelineno-2-185" href="#__codelineno-2-185"></a><span class="c1"># should be dropped, you can enable the following option. Otherwise, there</span>
<a id="__codelineno-2-186" name="__codelineno-2-186" href="#__codelineno-2-186"></a><span class="c1"># appears to be little evidence that it has anything to do with a security risk</span>
<a id="__codelineno-2-187" name="__codelineno-2-187" href="#__codelineno-2-187"></a><span class="c1"># and can impact network performance, so should be left disabled by everyone</span>
<a id="__codelineno-2-188" name="__codelineno-2-188" href="#__codelineno-2-188"></a><span class="c1"># else</span>
<a id="__codelineno-2-189" name="__codelineno-2-189" href="#__codelineno-2-189"></a><span class="na">ICMP_TIMESTAMPDROP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-190" name="__codelineno-2-190" href="#__codelineno-2-190"></a>
<a id="__codelineno-2-191" name="__codelineno-2-191" href="#__codelineno-2-191"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-192" name="__codelineno-2-192" href="#__codelineno-2-192"></a><span class="c1"># SECTION:IPv6 Port Settings</span>
<a id="__codelineno-2-193" name="__codelineno-2-193" href="#__codelineno-2-193"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-194" name="__codelineno-2-194" href="#__codelineno-2-194"></a><span class="c1"># IPv6: (Requires ip6tables)</span>
<a id="__codelineno-2-195" name="__codelineno-2-195" href="#__codelineno-2-195"></a><span class="c1">#</span>
<a id="__codelineno-2-196" name="__codelineno-2-196" href="#__codelineno-2-196"></a><span class="c1"># Pre v2.6.20 kernels do not perform stateful connection tracking, so a static</span>
<a id="__codelineno-2-197" name="__codelineno-2-197" href="#__codelineno-2-197"></a><span class="c1"># firewall is configured as a fallback instead if IPV6_SPI is set to 0 below</span>
<a id="__codelineno-2-198" name="__codelineno-2-198" href="#__codelineno-2-198"></a><span class="c1">#</span>
<a id="__codelineno-2-199" name="__codelineno-2-199" href="#__codelineno-2-199"></a><span class="c1"># Supported:</span>
<a id="__codelineno-2-200" name="__codelineno-2-200" href="#__codelineno-2-200"></a><span class="c1"># Temporary ACCEPT/DENY, GLOBAL_DENY, GLOBAL_ALLOW, SMTP_BLOCK, LF_PERMBLOCK,</span>
<a id="__codelineno-2-201" name="__codelineno-2-201" href="#__codelineno-2-201"></a><span class="c1"># PACKET_FILTER, Advanced Allow/Deny Filters, RELAY_*, CLUSTER_*, CC6_LOOKUPS, </span>
<a id="__codelineno-2-202" name="__codelineno-2-202" href="#__codelineno-2-202"></a><span class="c1"># SYNFLOOD, LF_NETBLOCK</span>
<a id="__codelineno-2-203" name="__codelineno-2-203" href="#__codelineno-2-203"></a><span class="c1">#</span>
<a id="__codelineno-2-204" name="__codelineno-2-204" href="#__codelineno-2-204"></a><span class="c1"># Supported if CC6_LOOKUPS and CC_LOOKUPS are enabled</span>
<a id="__codelineno-2-205" name="__codelineno-2-205" href="#__codelineno-2-205"></a><span class="c1"># CC_DENY, CC_ALLOW, CC_ALLOW_FILTER, CC_IGNORE, CC_ALLOW_PORTS, CC_DENY_PORTS,</span>
<a id="__codelineno-2-206" name="__codelineno-2-206" href="#__codelineno-2-206"></a><span class="c1"># CC_ALLOW_SMTPAUTH</span>
<a id="__codelineno-2-207" name="__codelineno-2-207" href="#__codelineno-2-207"></a><span class="c1">#</span>
<a id="__codelineno-2-208" name="__codelineno-2-208" href="#__codelineno-2-208"></a><span class="c1"># Supported if ip6tables &gt;= 1.4.3:</span>
<a id="__codelineno-2-209" name="__codelineno-2-209" href="#__codelineno-2-209"></a><span class="c1"># PORTFLOOD, CONNLIMIT</span>
<a id="__codelineno-2-210" name="__codelineno-2-210" href="#__codelineno-2-210"></a><span class="c1">#</span>
<a id="__codelineno-2-211" name="__codelineno-2-211" href="#__codelineno-2-211"></a><span class="c1"># Supported if ip6tables &gt;= 1.4.17 and perl module IO::Socket::INET6 is</span>
<a id="__codelineno-2-212" name="__codelineno-2-212" href="#__codelineno-2-212"></a><span class="c1"># installed:</span>
<a id="__codelineno-2-213" name="__codelineno-2-213" href="#__codelineno-2-213"></a><span class="c1"># MESSENGER DOCKER SMTP_REDIRECT</span>
<a id="__codelineno-2-214" name="__codelineno-2-214" href="#__codelineno-2-214"></a><span class="c1">#</span>
<a id="__codelineno-2-215" name="__codelineno-2-215" href="#__codelineno-2-215"></a><span class="c1"># Not supported:</span>
<a id="__codelineno-2-216" name="__codelineno-2-216" href="#__codelineno-2-216"></a><span class="c1"># ICMP_IN, ICMP_OUT</span>
<a id="__codelineno-2-217" name="__codelineno-2-217" href="#__codelineno-2-217"></a><span class="c1">#</span>
<a id="__codelineno-2-218" name="__codelineno-2-218" href="#__codelineno-2-218"></a><span class="na">IPV6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-219" name="__codelineno-2-219" href="#__codelineno-2-219"></a>
<a id="__codelineno-2-220" name="__codelineno-2-220" href="#__codelineno-2-220"></a><span class="c1"># IPv6 uses icmpv6 packets very heavily. By default, csf will allow all icmpv6</span>
<a id="__codelineno-2-221" name="__codelineno-2-221" href="#__codelineno-2-221"></a><span class="c1"># traffic in the INPUT and OUTPUT chains. However, this could increase the risk</span>
<a id="__codelineno-2-222" name="__codelineno-2-222" href="#__codelineno-2-222"></a><span class="c1"># of icmpv6 attacks. To restrict incoming icmpv6, set to "1" but may break some</span>
<a id="__codelineno-2-223" name="__codelineno-2-223" href="#__codelineno-2-223"></a><span class="c1"># connection types</span>
<a id="__codelineno-2-224" name="__codelineno-2-224" href="#__codelineno-2-224"></a><span class="na">IPV6_ICMP_STRICT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-225" name="__codelineno-2-225" href="#__codelineno-2-225"></a>
<a id="__codelineno-2-226" name="__codelineno-2-226" href="#__codelineno-2-226"></a><span class="c1"># Pre v2.6.20 kernel must set this option to "0" as no working state module is</span>
<a id="__codelineno-2-227" name="__codelineno-2-227" href="#__codelineno-2-227"></a><span class="c1"># present, so a static firewall is configured as a fallback</span>
<a id="__codelineno-2-228" name="__codelineno-2-228" href="#__codelineno-2-228"></a><span class="c1">#</span>
<a id="__codelineno-2-229" name="__codelineno-2-229" href="#__codelineno-2-229"></a><span class="c1"># A workaround has been added for CentOS/RedHat v5 and custom kernels that do</span>
<a id="__codelineno-2-230" name="__codelineno-2-230" href="#__codelineno-2-230"></a><span class="c1"># not support IPv6 connection tracking by opening ephemeral port range</span>
<a id="__codelineno-2-231" name="__codelineno-2-231" href="#__codelineno-2-231"></a><span class="c1"># 32768:61000. This is only applied if IPV6_SPI is not enabled. This is the</span>
<a id="__codelineno-2-232" name="__codelineno-2-232" href="#__codelineno-2-232"></a><span class="c1"># same workaround implemented by RedHat in the sample default IPv6 rules</span>
<a id="__codelineno-2-233" name="__codelineno-2-233" href="#__codelineno-2-233"></a><span class="c1">#</span>
<a id="__codelineno-2-234" name="__codelineno-2-234" href="#__codelineno-2-234"></a><span class="c1"># As connection tracking will not be configured, applications that rely on it</span>
<a id="__codelineno-2-235" name="__codelineno-2-235" href="#__codelineno-2-235"></a><span class="c1"># will not function unless all outgoing ports are opened. Therefore, all</span>
<a id="__codelineno-2-236" name="__codelineno-2-236" href="#__codelineno-2-236"></a><span class="c1"># outgoing connections will be allowed once all other tests have completed. So</span>
<a id="__codelineno-2-237" name="__codelineno-2-237" href="#__codelineno-2-237"></a><span class="c1"># TCP6_OUT, UDP6_OUT and ICMP6_OUT will not have any affect.</span>
<a id="__codelineno-2-238" name="__codelineno-2-238" href="#__codelineno-2-238"></a><span class="c1">#</span>
<a id="__codelineno-2-239" name="__codelineno-2-239" href="#__codelineno-2-239"></a><span class="c1"># If you allow incoming ipv6 DNS lookups you may need to use the following</span>
<a id="__codelineno-2-240" name="__codelineno-2-240" href="#__codelineno-2-240"></a><span class="c1"># directive in the options{} section of your named.conf:</span>
<a id="__codelineno-2-241" name="__codelineno-2-241" href="#__codelineno-2-241"></a><span class="c1">#</span>
<a id="__codelineno-2-242" name="__codelineno-2-242" href="#__codelineno-2-242"></a><span class="c1">#        query-source-v6 port 53;</span>
<a id="__codelineno-2-243" name="__codelineno-2-243" href="#__codelineno-2-243"></a><span class="c1">#</span>
<a id="__codelineno-2-244" name="__codelineno-2-244" href="#__codelineno-2-244"></a><span class="c1"># This will force ipv6 incoming DNS traffic only through port 53</span>
<a id="__codelineno-2-245" name="__codelineno-2-245" href="#__codelineno-2-245"></a><span class="c1">#</span>
<a id="__codelineno-2-246" name="__codelineno-2-246" href="#__codelineno-2-246"></a><span class="c1"># These changes are not necessary if the SPI firewall is used</span>
<a id="__codelineno-2-247" name="__codelineno-2-247" href="#__codelineno-2-247"></a><span class="na">IPV6_SPI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-248" name="__codelineno-2-248" href="#__codelineno-2-248"></a>
<a id="__codelineno-2-249" name="__codelineno-2-249" href="#__codelineno-2-249"></a><span class="c1"># Allow incoming IPv6 TCP ports</span>
<a id="__codelineno-2-250" name="__codelineno-2-250" href="#__codelineno-2-250"></a><span class="na">TCP6_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,143,443,465,587,993,995,5000"</span>
<a id="__codelineno-2-251" name="__codelineno-2-251" href="#__codelineno-2-251"></a>
<a id="__codelineno-2-252" name="__codelineno-2-252" href="#__codelineno-2-252"></a><span class="c1"># Allow outgoing IPv6 TCP ports</span>
<a id="__codelineno-2-253" name="__codelineno-2-253" href="#__codelineno-2-253"></a><span class="na">TCP6_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,113,443,587,993,995"</span>
<a id="__codelineno-2-254" name="__codelineno-2-254" href="#__codelineno-2-254"></a>
<a id="__codelineno-2-255" name="__codelineno-2-255" href="#__codelineno-2-255"></a><span class="c1"># Allow incoming IPv6 UDP ports</span>
<a id="__codelineno-2-256" name="__codelineno-2-256" href="#__codelineno-2-256"></a><span class="na">UDP6_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,80,443"</span>
<a id="__codelineno-2-257" name="__codelineno-2-257" href="#__codelineno-2-257"></a>
<a id="__codelineno-2-258" name="__codelineno-2-258" href="#__codelineno-2-258"></a><span class="c1"># Allow outgoing IPv6 UDP ports</span>
<a id="__codelineno-2-259" name="__codelineno-2-259" href="#__codelineno-2-259"></a><span class="c1"># To allow outgoing traceroute add 33434:33523 to this list </span>
<a id="__codelineno-2-260" name="__codelineno-2-260" href="#__codelineno-2-260"></a><span class="na">UDP6_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,113,123"</span>
<a id="__codelineno-2-261" name="__codelineno-2-261" href="#__codelineno-2-261"></a>
<a id="__codelineno-2-262" name="__codelineno-2-262" href="#__codelineno-2-262"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-263" name="__codelineno-2-263" href="#__codelineno-2-263"></a><span class="c1"># SECTION:General Settings</span>
<a id="__codelineno-2-264" name="__codelineno-2-264" href="#__codelineno-2-264"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-265" name="__codelineno-2-265" href="#__codelineno-2-265"></a><span class="c1"># By default, csf will auto-configure iptables to filter all traffic except on</span>
<a id="__codelineno-2-266" name="__codelineno-2-266" href="#__codelineno-2-266"></a><span class="c1"># the loopback device. If you only want iptables rules applied to a specific</span>
<a id="__codelineno-2-267" name="__codelineno-2-267" href="#__codelineno-2-267"></a><span class="c1"># NIC, then list it here (e.g. eth1, or eth+)</span>
<a id="__codelineno-2-268" name="__codelineno-2-268" href="#__codelineno-2-268"></a><span class="na">ETH_DEVICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-269" name="__codelineno-2-269" href="#__codelineno-2-269"></a>
<a id="__codelineno-2-270" name="__codelineno-2-270" href="#__codelineno-2-270"></a><span class="c1"># By adding a device to this option, ip6tables can be configured only on the</span>
<a id="__codelineno-2-271" name="__codelineno-2-271" href="#__codelineno-2-271"></a><span class="c1"># specified device. Otherwise, ETH_DEVICE and then the default setting will be</span>
<a id="__codelineno-2-272" name="__codelineno-2-272" href="#__codelineno-2-272"></a><span class="c1"># used</span>
<a id="__codelineno-2-273" name="__codelineno-2-273" href="#__codelineno-2-273"></a><span class="na">ETH6_DEVICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-274" name="__codelineno-2-274" href="#__codelineno-2-274"></a>
<a id="__codelineno-2-275" name="__codelineno-2-275" href="#__codelineno-2-275"></a><span class="c1"># If you don't want iptables rules applied to specific NICs, then list them in</span>
<a id="__codelineno-2-276" name="__codelineno-2-276" href="#__codelineno-2-276"></a><span class="c1"># a comma separated list (e.g "eth1,eth2")</span>
<a id="__codelineno-2-277" name="__codelineno-2-277" href="#__codelineno-2-277"></a><span class="na">ETH_DEVICE_SKIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-278" name="__codelineno-2-278" href="#__codelineno-2-278"></a>
<a id="__codelineno-2-279" name="__codelineno-2-279" href="#__codelineno-2-279"></a><span class="c1"># This option should be enabled unless the kernel does not support the</span>
<a id="__codelineno-2-280" name="__codelineno-2-280" href="#__codelineno-2-280"></a><span class="c1"># "conntrack" module</span>
<a id="__codelineno-2-281" name="__codelineno-2-281" href="#__codelineno-2-281"></a><span class="c1">#</span>
<a id="__codelineno-2-282" name="__codelineno-2-282" href="#__codelineno-2-282"></a><span class="c1"># To use the deprecated iptables "state" module, change this to 0</span>
<a id="__codelineno-2-283" name="__codelineno-2-283" href="#__codelineno-2-283"></a><span class="na">USE_CONNTRACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-284" name="__codelineno-2-284" href="#__codelineno-2-284"></a>
<a id="__codelineno-2-285" name="__codelineno-2-285" href="#__codelineno-2-285"></a><span class="c1"># Enable ftp helper via the iptables CT target on supporting kernels (v2.6.34+)</span>
<a id="__codelineno-2-286" name="__codelineno-2-286" href="#__codelineno-2-286"></a><span class="c1"># instead of the current method via /proc/sys/net/netfilter/nf_conntrack_helper</span>
<a id="__codelineno-2-287" name="__codelineno-2-287" href="#__codelineno-2-287"></a><span class="c1"># This will also remove the RELATED target from the global state iptables rule</span>
<a id="__codelineno-2-288" name="__codelineno-2-288" href="#__codelineno-2-288"></a><span class="c1">#</span>
<a id="__codelineno-2-289" name="__codelineno-2-289" href="#__codelineno-2-289"></a><span class="c1"># This is not needed (and will be ignored) if LF_SPI/IPV6_SPI is disabled or</span>
<a id="__codelineno-2-290" name="__codelineno-2-290" href="#__codelineno-2-290"></a><span class="c1"># the raw tables do not exist. The USE_CONNTRACK option should be enabled</span>
<a id="__codelineno-2-291" name="__codelineno-2-291" href="#__codelineno-2-291"></a><span class="c1">#</span>
<a id="__codelineno-2-292" name="__codelineno-2-292" href="#__codelineno-2-292"></a><span class="c1"># To enable this option, set it to your FTP server listening port number</span>
<a id="__codelineno-2-293" name="__codelineno-2-293" href="#__codelineno-2-293"></a><span class="c1"># (normally 21), do NOT set it to "1"</span>
<a id="__codelineno-2-294" name="__codelineno-2-294" href="#__codelineno-2-294"></a><span class="na">USE_FTPHELPER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-295" name="__codelineno-2-295" href="#__codelineno-2-295"></a>
<a id="__codelineno-2-296" name="__codelineno-2-296" href="#__codelineno-2-296"></a><span class="c1"># Check whether syslog is running. Many of the lfd checks require syslog to be</span>
<a id="__codelineno-2-297" name="__codelineno-2-297" href="#__codelineno-2-297"></a><span class="c1"># running correctly. This test will send a coded message to syslog every</span>
<a id="__codelineno-2-298" name="__codelineno-2-298" href="#__codelineno-2-298"></a><span class="c1"># SYSLOG_CHECK seconds. lfd will check SYSLOG_LOG log lines for the coded</span>
<a id="__codelineno-2-299" name="__codelineno-2-299" href="#__codelineno-2-299"></a><span class="c1"># message. If it fails to do so within SYSLOG_CHECK seconds an alert using</span>
<a id="__codelineno-2-300" name="__codelineno-2-300" href="#__codelineno-2-300"></a><span class="c1"># syslogalert.txt is sent</span>
<a id="__codelineno-2-301" name="__codelineno-2-301" href="#__codelineno-2-301"></a><span class="c1">#</span>
<a id="__codelineno-2-302" name="__codelineno-2-302" href="#__codelineno-2-302"></a><span class="c1"># A value of between 300 and 3600 seconds is suggested. Set to 0 to disable</span>
<a id="__codelineno-2-303" name="__codelineno-2-303" href="#__codelineno-2-303"></a><span class="na">SYSLOG_CHECK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-304" name="__codelineno-2-304" href="#__codelineno-2-304"></a>
<a id="__codelineno-2-305" name="__codelineno-2-305" href="#__codelineno-2-305"></a><span class="c1"># Enable this option if you want lfd to ignore (i.e. don't block) IP addresses</span>
<a id="__codelineno-2-306" name="__codelineno-2-306" href="#__codelineno-2-306"></a><span class="c1"># listed in csf.allow in addition to csf.ignore (the default). This option</span>
<a id="__codelineno-2-307" name="__codelineno-2-307" href="#__codelineno-2-307"></a><span class="c1"># should be used with caution as it would mean that IP's allowed through the</span>
<a id="__codelineno-2-308" name="__codelineno-2-308" href="#__codelineno-2-308"></a><span class="c1"># firewall from infected PC's could launch attacks on the server that lfd</span>
<a id="__codelineno-2-309" name="__codelineno-2-309" href="#__codelineno-2-309"></a><span class="c1"># would ignore</span>
<a id="__codelineno-2-310" name="__codelineno-2-310" href="#__codelineno-2-310"></a><span class="na">IGNORE_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-311" name="__codelineno-2-311" href="#__codelineno-2-311"></a>
<a id="__codelineno-2-312" name="__codelineno-2-312" href="#__codelineno-2-312"></a><span class="c1"># Enable the following option if you want to apply strict iptables rules to DNS</span>
<a id="__codelineno-2-313" name="__codelineno-2-313" href="#__codelineno-2-313"></a><span class="c1"># traffic (i.e. relying on iptables connection tracking). Enabling this option</span>
<a id="__codelineno-2-314" name="__codelineno-2-314" href="#__codelineno-2-314"></a><span class="c1"># could cause DNS resolution issues both to and from the server but could help</span>
<a id="__codelineno-2-315" name="__codelineno-2-315" href="#__codelineno-2-315"></a><span class="c1"># prevent abuse of the local DNS server</span>
<a id="__codelineno-2-316" name="__codelineno-2-316" href="#__codelineno-2-316"></a><span class="na">DNS_STRICT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-317" name="__codelineno-2-317" href="#__codelineno-2-317"></a>
<a id="__codelineno-2-318" name="__codelineno-2-318" href="#__codelineno-2-318"></a><span class="c1"># Enable the following option if you want to apply strict iptables rules to DNS</span>
<a id="__codelineno-2-319" name="__codelineno-2-319" href="#__codelineno-2-319"></a><span class="c1"># traffic between the server and the nameservers listed in /etc/resolv.conf</span>
<a id="__codelineno-2-320" name="__codelineno-2-320" href="#__codelineno-2-320"></a><span class="c1"># Enabling this option could cause DNS resolution issues both to and from the</span>
<a id="__codelineno-2-321" name="__codelineno-2-321" href="#__codelineno-2-321"></a><span class="c1"># server but could help prevent abuse of the local DNS server</span>
<a id="__codelineno-2-322" name="__codelineno-2-322" href="#__codelineno-2-322"></a><span class="na">DNS_STRICT_NS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-323" name="__codelineno-2-323" href="#__codelineno-2-323"></a>
<a id="__codelineno-2-324" name="__codelineno-2-324" href="#__codelineno-2-324"></a><span class="c1"># Limit the number of IP's kept in the /etc/csf/csf.deny file</span>
<a id="__codelineno-2-325" name="__codelineno-2-325" href="#__codelineno-2-325"></a><span class="c1">#</span>
<a id="__codelineno-2-326" name="__codelineno-2-326" href="#__codelineno-2-326"></a><span class="c1"># Care should be taken when increasing this value on servers with low memory</span>
<a id="__codelineno-2-327" name="__codelineno-2-327" href="#__codelineno-2-327"></a><span class="c1"># resources or hard limits (such as Virtuozzo/OpenVZ) as too many rules (in the</span>
<a id="__codelineno-2-328" name="__codelineno-2-328" href="#__codelineno-2-328"></a><span class="c1"># thousands) can sometimes cause network slowdown</span>
<a id="__codelineno-2-329" name="__codelineno-2-329" href="#__codelineno-2-329"></a><span class="c1">#</span>
<a id="__codelineno-2-330" name="__codelineno-2-330" href="#__codelineno-2-330"></a><span class="c1"># The value set here is the maximum number of IPs/CIDRs allowed</span>
<a id="__codelineno-2-331" name="__codelineno-2-331" href="#__codelineno-2-331"></a><span class="c1"># if the limit is reached, the entries will be rotated so that the oldest</span>
<a id="__codelineno-2-332" name="__codelineno-2-332" href="#__codelineno-2-332"></a><span class="c1"># entries (i.e. the ones at the top) will be removed and the latest is added.</span>
<a id="__codelineno-2-333" name="__codelineno-2-333" href="#__codelineno-2-333"></a><span class="c1"># The limit is only checked when using csf -d (which is what lfd also uses)</span>
<a id="__codelineno-2-334" name="__codelineno-2-334" href="#__codelineno-2-334"></a><span class="c1"># Set to 0 to disable limiting</span>
<a id="__codelineno-2-335" name="__codelineno-2-335" href="#__codelineno-2-335"></a><span class="c1">#</span>
<a id="__codelineno-2-336" name="__codelineno-2-336" href="#__codelineno-2-336"></a><span class="c1"># For implementations wishing to set this value significantly higher, we</span>
<a id="__codelineno-2-337" name="__codelineno-2-337" href="#__codelineno-2-337"></a><span class="c1"># recommend using the IPSET option</span>
<a id="__codelineno-2-338" name="__codelineno-2-338" href="#__codelineno-2-338"></a><span class="na">DENY_IP_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"200"</span>
<a id="__codelineno-2-339" name="__codelineno-2-339" href="#__codelineno-2-339"></a>
<a id="__codelineno-2-340" name="__codelineno-2-340" href="#__codelineno-2-340"></a><span class="c1"># Limit the number of IP's kept in the temprary IP ban list. If the limit is</span>
<a id="__codelineno-2-341" name="__codelineno-2-341" href="#__codelineno-2-341"></a><span class="c1"># reached the oldest IP's in the ban list will be removed and allowed</span>
<a id="__codelineno-2-342" name="__codelineno-2-342" href="#__codelineno-2-342"></a><span class="c1"># regardless of the amount of time remaining for the block</span>
<a id="__codelineno-2-343" name="__codelineno-2-343" href="#__codelineno-2-343"></a><span class="c1"># Set to 0 to disable limiting</span>
<a id="__codelineno-2-344" name="__codelineno-2-344" href="#__codelineno-2-344"></a><span class="na">DENY_TEMP_IP_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100"</span>
<a id="__codelineno-2-345" name="__codelineno-2-345" href="#__codelineno-2-345"></a>
<a id="__codelineno-2-346" name="__codelineno-2-346" href="#__codelineno-2-346"></a><span class="c1"># Enable login failure detection daemon (lfd). If set to 0 none of the</span>
<a id="__codelineno-2-347" name="__codelineno-2-347" href="#__codelineno-2-347"></a><span class="c1"># following settings will have any effect as the daemon won't start.</span>
<a id="__codelineno-2-348" name="__codelineno-2-348" href="#__codelineno-2-348"></a><span class="na">LF_DAEMON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-349" name="__codelineno-2-349" href="#__codelineno-2-349"></a>
<a id="__codelineno-2-350" name="__codelineno-2-350" href="#__codelineno-2-350"></a><span class="c1"># Check whether csf appears to have been stopped and restart if necessary,</span>
<a id="__codelineno-2-351" name="__codelineno-2-351" href="#__codelineno-2-351"></a><span class="c1"># unless TESTING is enabled above. The check is done every 300 seconds</span>
<a id="__codelineno-2-352" name="__codelineno-2-352" href="#__codelineno-2-352"></a><span class="na">LF_CSF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-353" name="__codelineno-2-353" href="#__codelineno-2-353"></a>
<a id="__codelineno-2-354" name="__codelineno-2-354" href="#__codelineno-2-354"></a><span class="c1"># This option uses IPTABLES_SAVE, IPTABLES_RESTORE and IP6TABLES_SAVE,</span>
<a id="__codelineno-2-355" name="__codelineno-2-355" href="#__codelineno-2-355"></a><span class="c1"># IP6TABLES_RESTORE in two ways:</span>
<a id="__codelineno-2-356" name="__codelineno-2-356" href="#__codelineno-2-356"></a><span class="c1">#</span>
<a id="__codelineno-2-357" name="__codelineno-2-357" href="#__codelineno-2-357"></a><span class="c1"># 1. On a clean server reboot the entire csf iptables configuration is saved</span>
<a id="__codelineno-2-358" name="__codelineno-2-358" href="#__codelineno-2-358"></a><span class="c1">#    and then restored where possible to provide a near instant firewall</span>
<a id="__codelineno-2-359" name="__codelineno-2-359" href="#__codelineno-2-359"></a><span class="c1">#    startup[*]</span>
<a id="__codelineno-2-360" name="__codelineno-2-360" href="#__codelineno-2-360"></a><span class="c1">#</span>
<a id="__codelineno-2-361" name="__codelineno-2-361" href="#__codelineno-2-361"></a><span class="c1"># 2. On csf restart or lfd reloading tables, CC_* as well as SPAMHAUS, DSHIELD,</span>
<a id="__codelineno-2-362" name="__codelineno-2-362" href="#__codelineno-2-362"></a><span class="c1">#    BOGON, TOR are loaded using this method in a fraction of the time than if</span>
<a id="__codelineno-2-363" name="__codelineno-2-363" href="#__codelineno-2-363"></a><span class="c1">#    this setting is disabled</span>
<a id="__codelineno-2-364" name="__codelineno-2-364" href="#__codelineno-2-364"></a><span class="c1">#</span>
<a id="__codelineno-2-365" name="__codelineno-2-365" href="#__codelineno-2-365"></a><span class="c1"># [*]Not supported on all OS platforms</span>
<a id="__codelineno-2-366" name="__codelineno-2-366" href="#__codelineno-2-366"></a><span class="c1">#</span>
<a id="__codelineno-2-367" name="__codelineno-2-367" href="#__codelineno-2-367"></a><span class="c1"># Set to "0" to disable this functionality</span>
<a id="__codelineno-2-368" name="__codelineno-2-368" href="#__codelineno-2-368"></a><span class="na">FASTSTART</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-369" name="__codelineno-2-369" href="#__codelineno-2-369"></a>
<a id="__codelineno-2-370" name="__codelineno-2-370" href="#__codelineno-2-370"></a><span class="c1"># This option allows you to use ipset v6+ for the following csf options:</span>
<a id="__codelineno-2-371" name="__codelineno-2-371" href="#__codelineno-2-371"></a><span class="c1"># CC_* and /etc/csf/csf.blocklist, /etc/csf/csf.allow, /etc/csf/csf.deny,</span>
<a id="__codelineno-2-372" name="__codelineno-2-372" href="#__codelineno-2-372"></a><span class="c1"># GLOBAL_DENY, GLOBAL_ALLOW, DYNDNS, GLOBAL_DYNDNS, MESSENGER</span>
<a id="__codelineno-2-373" name="__codelineno-2-373" href="#__codelineno-2-373"></a><span class="c1">#</span>
<a id="__codelineno-2-374" name="__codelineno-2-374" href="#__codelineno-2-374"></a><span class="c1"># ipset will only be used with the above options when listing IPs and CIDRs.</span>
<a id="__codelineno-2-375" name="__codelineno-2-375" href="#__codelineno-2-375"></a><span class="c1"># Advanced Allow Filters and temporary blocks use traditional iptables</span>
<a id="__codelineno-2-376" name="__codelineno-2-376" href="#__codelineno-2-376"></a><span class="c1">#</span>
<a id="__codelineno-2-377" name="__codelineno-2-377" href="#__codelineno-2-377"></a><span class="c1"># Using ipset moves the onus of ip matching against large lists away from</span>
<a id="__codelineno-2-378" name="__codelineno-2-378" href="#__codelineno-2-378"></a><span class="c1"># iptables rules and to a purpose built and optimised database matching</span>
<a id="__codelineno-2-379" name="__codelineno-2-379" href="#__codelineno-2-379"></a><span class="c1"># utility. It also simplifies the switching in of updated lists</span>
<a id="__codelineno-2-380" name="__codelineno-2-380" href="#__codelineno-2-380"></a><span class="c1">#</span>
<a id="__codelineno-2-381" name="__codelineno-2-381" href="#__codelineno-2-381"></a><span class="c1"># To use this option you must have a fully functioning installation of ipset</span>
<a id="__codelineno-2-382" name="__codelineno-2-382" href="#__codelineno-2-382"></a><span class="c1"># installed either via rpm or source from http://ipset.netfilter.org/</span>
<a id="__codelineno-2-383" name="__codelineno-2-383" href="#__codelineno-2-383"></a><span class="c1"># </span>
<a id="__codelineno-2-384" name="__codelineno-2-384" href="#__codelineno-2-384"></a><span class="c1"># Note: Using ipset has many advantages, some disadvantages are that you will</span>
<a id="__codelineno-2-385" name="__codelineno-2-385" href="#__codelineno-2-385"></a><span class="c1"># no longer see packet and byte counts against IPs and it makes identifying</span>
<a id="__codelineno-2-386" name="__codelineno-2-386" href="#__codelineno-2-386"></a><span class="c1"># blocked/allowed IPs that little bit harder</span>
<a id="__codelineno-2-387" name="__codelineno-2-387" href="#__codelineno-2-387"></a><span class="c1">#</span>
<a id="__codelineno-2-388" name="__codelineno-2-388" href="#__codelineno-2-388"></a><span class="c1"># Note: If you mainly use IP address only entries in csf.deny, you can increase</span>
<a id="__codelineno-2-389" name="__codelineno-2-389" href="#__codelineno-2-389"></a><span class="c1"># the value of DENY_IP_LIMIT significantly if you wish</span>
<a id="__codelineno-2-390" name="__codelineno-2-390" href="#__codelineno-2-390"></a><span class="c1"># </span>
<a id="__codelineno-2-391" name="__codelineno-2-391" href="#__codelineno-2-391"></a><span class="c1"># Note: It's highly unlikely that ipset will function on Virtuozzo/OpenVZ</span>
<a id="__codelineno-2-392" name="__codelineno-2-392" href="#__codelineno-2-392"></a><span class="c1"># containers even if it has been installed</span>
<a id="__codelineno-2-393" name="__codelineno-2-393" href="#__codelineno-2-393"></a><span class="c1">#</span>
<a id="__codelineno-2-394" name="__codelineno-2-394" href="#__codelineno-2-394"></a><span class="c1"># If you find any problems, please read docs.configserver.dev</span>
<a id="__codelineno-2-395" name="__codelineno-2-395" href="#__codelineno-2-395"></a><span class="na">LF_IPSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-396" name="__codelineno-2-396" href="#__codelineno-2-396"></a>
<a id="__codelineno-2-397" name="__codelineno-2-397" href="#__codelineno-2-397"></a><span class="c1"># Versions of iptables greater or equal to v1.4.20 should support the --wait</span>
<a id="__codelineno-2-398" name="__codelineno-2-398" href="#__codelineno-2-398"></a><span class="c1"># option. This forces iptables commands that use the option to wait until a</span>
<a id="__codelineno-2-399" name="__codelineno-2-399" href="#__codelineno-2-399"></a><span class="c1"># lock by any other process using iptables completes, rather than simply</span>
<a id="__codelineno-2-400" name="__codelineno-2-400" href="#__codelineno-2-400"></a><span class="c1"># failing</span>
<a id="__codelineno-2-401" name="__codelineno-2-401" href="#__codelineno-2-401"></a><span class="c1">#</span>
<a id="__codelineno-2-402" name="__codelineno-2-402" href="#__codelineno-2-402"></a><span class="c1"># Enabling this feature will add the --wait option to iptables commands</span>
<a id="__codelineno-2-403" name="__codelineno-2-403" href="#__codelineno-2-403"></a><span class="c1">#</span>
<a id="__codelineno-2-404" name="__codelineno-2-404" href="#__codelineno-2-404"></a><span class="c1"># NOTE: The disadvantage of using this option is that any iptables command that</span>
<a id="__codelineno-2-405" name="__codelineno-2-405" href="#__codelineno-2-405"></a><span class="c1"># uses it will hang until the lock is released. This could cause a cascade of</span>
<a id="__codelineno-2-406" name="__codelineno-2-406" href="#__codelineno-2-406"></a><span class="c1"># hung processes trying to issue iptables commands. To try and avoid this issue</span>
<a id="__codelineno-2-407" name="__codelineno-2-407" href="#__codelineno-2-407"></a><span class="c1"># csf uses a last ditch timeout, WAITLOCK_TIMEOUT in seconds, that will trigger</span>
<a id="__codelineno-2-408" name="__codelineno-2-408" href="#__codelineno-2-408"></a><span class="c1"># a failure if reached</span>
<a id="__codelineno-2-409" name="__codelineno-2-409" href="#__codelineno-2-409"></a><span class="na">WAITLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-410" name="__codelineno-2-410" href="#__codelineno-2-410"></a><span class="na">WAITLOCK_TIMEOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-2-411" name="__codelineno-2-411" href="#__codelineno-2-411"></a>
<a id="__codelineno-2-412" name="__codelineno-2-412" href="#__codelineno-2-412"></a><span class="c1"># The following sets the hashsize for ipset sets, which must be a power of 2.</span>
<a id="__codelineno-2-413" name="__codelineno-2-413" href="#__codelineno-2-413"></a><span class="c1">#</span>
<a id="__codelineno-2-414" name="__codelineno-2-414" href="#__codelineno-2-414"></a><span class="c1"># Note: Increasing this value will consume more memory for all sets</span>
<a id="__codelineno-2-415" name="__codelineno-2-415" href="#__codelineno-2-415"></a><span class="c1"># Default: "1024"</span>
<a id="__codelineno-2-416" name="__codelineno-2-416" href="#__codelineno-2-416"></a><span class="na">LF_IPSET_HASHSIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1024"</span>
<a id="__codelineno-2-417" name="__codelineno-2-417" href="#__codelineno-2-417"></a>
<a id="__codelineno-2-418" name="__codelineno-2-418" href="#__codelineno-2-418"></a><span class="c1"># The following sets the maxelem for ipset sets.</span>
<a id="__codelineno-2-419" name="__codelineno-2-419" href="#__codelineno-2-419"></a><span class="c1">#</span>
<a id="__codelineno-2-420" name="__codelineno-2-420" href="#__codelineno-2-420"></a><span class="c1"># Note: Increasing this value will consume more memory for all sets</span>
<a id="__codelineno-2-421" name="__codelineno-2-421" href="#__codelineno-2-421"></a><span class="c1"># Default: "65536"</span>
<a id="__codelineno-2-422" name="__codelineno-2-422" href="#__codelineno-2-422"></a><span class="na">LF_IPSET_MAXELEM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"65536"</span>
<a id="__codelineno-2-423" name="__codelineno-2-423" href="#__codelineno-2-423"></a>
<a id="__codelineno-2-424" name="__codelineno-2-424" href="#__codelineno-2-424"></a><span class="c1"># If you enable this option then whenever a CLI request to restart csf is used</span>
<a id="__codelineno-2-425" name="__codelineno-2-425" href="#__codelineno-2-425"></a><span class="c1"># lfd will restart csf instead within LF_PARSE seconds</span>
<a id="__codelineno-2-426" name="__codelineno-2-426" href="#__codelineno-2-426"></a><span class="c1">#</span>
<a id="__codelineno-2-427" name="__codelineno-2-427" href="#__codelineno-2-427"></a><span class="c1"># This feature can be helpful for restarting configurations that cannot use</span>
<a id="__codelineno-2-428" name="__codelineno-2-428" href="#__codelineno-2-428"></a><span class="c1"># FASTSTART</span>
<a id="__codelineno-2-429" name="__codelineno-2-429" href="#__codelineno-2-429"></a><span class="na">LFDSTART</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-430" name="__codelineno-2-430" href="#__codelineno-2-430"></a>
<a id="__codelineno-2-431" name="__codelineno-2-431" href="#__codelineno-2-431"></a><span class="c1"># Enable verbose output of iptables commands</span>
<a id="__codelineno-2-432" name="__codelineno-2-432" href="#__codelineno-2-432"></a><span class="na">VERBOSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-433" name="__codelineno-2-433" href="#__codelineno-2-433"></a>
<a id="__codelineno-2-434" name="__codelineno-2-434" href="#__codelineno-2-434"></a><span class="c1"># Drop out of order packets and packets in an INVALID state in iptables</span>
<a id="__codelineno-2-435" name="__codelineno-2-435" href="#__codelineno-2-435"></a><span class="c1"># connection tracking</span>
<a id="__codelineno-2-436" name="__codelineno-2-436" href="#__codelineno-2-436"></a><span class="na">PACKET_FILTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-437" name="__codelineno-2-437" href="#__codelineno-2-437"></a>
<a id="__codelineno-2-438" name="__codelineno-2-438" href="#__codelineno-2-438"></a><span class="c1"># Perform reverse DNS lookups on IP addresses. (See also CC_LOOKUPS)</span>
<a id="__codelineno-2-439" name="__codelineno-2-439" href="#__codelineno-2-439"></a><span class="na">LF_LOOKUPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-440" name="__codelineno-2-440" href="#__codelineno-2-440"></a>
<a id="__codelineno-2-441" name="__codelineno-2-441" href="#__codelineno-2-441"></a><span class="c1"># Custom styling is possible in the csf UI. See the readme.txt for more</span>
<a id="__codelineno-2-442" name="__codelineno-2-442" href="#__codelineno-2-442"></a><span class="c1"># information under "UI skinning and Mobile View"</span>
<a id="__codelineno-2-443" name="__codelineno-2-443" href="#__codelineno-2-443"></a><span class="c1">#</span>
<a id="__codelineno-2-444" name="__codelineno-2-444" href="#__codelineno-2-444"></a><span class="c1"># This option enables the use of custom styling. If the styling fails to work</span>
<a id="__codelineno-2-445" name="__codelineno-2-445" href="#__codelineno-2-445"></a><span class="c1"># correctly, e.g. custom styling does not take into account a change in the</span>
<a id="__codelineno-2-446" name="__codelineno-2-446" href="#__codelineno-2-446"></a><span class="c1"># standard csf UI, then disabling this option will return the standard UI</span>
<a id="__codelineno-2-447" name="__codelineno-2-447" href="#__codelineno-2-447"></a><span class="na">STYLE_CUSTOM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-448" name="__codelineno-2-448" href="#__codelineno-2-448"></a>
<a id="__codelineno-2-449" name="__codelineno-2-449" href="#__codelineno-2-449"></a><span class="c1"># This option disables the presence of the Mobile View in the csf UI</span>
<a id="__codelineno-2-450" name="__codelineno-2-450" href="#__codelineno-2-450"></a><span class="na">STYLE_MOBILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-451" name="__codelineno-2-451" href="#__codelineno-2-451"></a>
<a id="__codelineno-2-452" name="__codelineno-2-452" href="#__codelineno-2-452"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-453" name="__codelineno-2-453" href="#__codelineno-2-453"></a><span class="c1"># SECTION:SMTP Settings</span>
<a id="__codelineno-2-454" name="__codelineno-2-454" href="#__codelineno-2-454"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-455" name="__codelineno-2-455" href="#__codelineno-2-455"></a><span class="c1"># Block outgoing SMTP except for root, exim and mailman (forces scripts/users</span>
<a id="__codelineno-2-456" name="__codelineno-2-456" href="#__codelineno-2-456"></a><span class="c1"># to use the exim/sendmail binary instead of sockets access). This replaces the</span>
<a id="__codelineno-2-457" name="__codelineno-2-457" href="#__codelineno-2-457"></a><span class="c1"># protection as WHM &gt; Tweak Settings &gt; SMTP Tweaks</span>
<a id="__codelineno-2-458" name="__codelineno-2-458" href="#__codelineno-2-458"></a><span class="c1">#</span>
<a id="__codelineno-2-459" name="__codelineno-2-459" href="#__codelineno-2-459"></a><span class="c1"># This option uses the iptables ipt_owner/xt_owner module and must be loaded</span>
<a id="__codelineno-2-460" name="__codelineno-2-460" href="#__codelineno-2-460"></a><span class="c1"># for it to work. It may not be available on some VPS platforms</span>
<a id="__codelineno-2-461" name="__codelineno-2-461" href="#__codelineno-2-461"></a><span class="c1">#</span>
<a id="__codelineno-2-462" name="__codelineno-2-462" href="#__codelineno-2-462"></a><span class="c1"># Note: Run /etc/csf/csftest.pl to check whether this option will function on</span>
<a id="__codelineno-2-463" name="__codelineno-2-463" href="#__codelineno-2-463"></a><span class="c1"># this server</span>
<a id="__codelineno-2-464" name="__codelineno-2-464" href="#__codelineno-2-464"></a><span class="na">SMTP_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-465" name="__codelineno-2-465" href="#__codelineno-2-465"></a>
<a id="__codelineno-2-466" name="__codelineno-2-466" href="#__codelineno-2-466"></a><span class="c1"># If SMTP_BLOCK is enabled but you want to allow local connections to port 25</span>
<a id="__codelineno-2-467" name="__codelineno-2-467" href="#__codelineno-2-467"></a><span class="c1"># on the server (e.g. for webmail or web scripts) then enable this option to</span>
<a id="__codelineno-2-468" name="__codelineno-2-468" href="#__codelineno-2-468"></a><span class="c1"># allow outgoing SMTP connections to the loopback device</span>
<a id="__codelineno-2-469" name="__codelineno-2-469" href="#__codelineno-2-469"></a><span class="na">SMTP_ALLOWLOCAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-470" name="__codelineno-2-470" href="#__codelineno-2-470"></a>
<a id="__codelineno-2-471" name="__codelineno-2-471" href="#__codelineno-2-471"></a><span class="c1"># This option redirects outgoing SMTP connections destined for remote servers</span>
<a id="__codelineno-2-472" name="__codelineno-2-472" href="#__codelineno-2-472"></a><span class="c1"># for non-bypass users to the local SMTP server to force local relaying of</span>
<a id="__codelineno-2-473" name="__codelineno-2-473" href="#__codelineno-2-473"></a><span class="c1"># email. Such email may require authentication (SMTP AUTH)</span>
<a id="__codelineno-2-474" name="__codelineno-2-474" href="#__codelineno-2-474"></a><span class="na">SMTP_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-475" name="__codelineno-2-475" href="#__codelineno-2-475"></a>
<a id="__codelineno-2-476" name="__codelineno-2-476" href="#__codelineno-2-476"></a><span class="c1"># This is a comma separated list of the ports to block. You should list all</span>
<a id="__codelineno-2-477" name="__codelineno-2-477" href="#__codelineno-2-477"></a><span class="c1"># ports that exim is configured to listen on</span>
<a id="__codelineno-2-478" name="__codelineno-2-478" href="#__codelineno-2-478"></a><span class="na">SMTP_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"25,465,587"</span>
<a id="__codelineno-2-479" name="__codelineno-2-479" href="#__codelineno-2-479"></a>
<a id="__codelineno-2-480" name="__codelineno-2-480" href="#__codelineno-2-480"></a><span class="c1"># Always allow the following comma separated users and groups to bypass</span>
<a id="__codelineno-2-481" name="__codelineno-2-481" href="#__codelineno-2-481"></a><span class="c1"># SMTP_BLOCK</span>
<a id="__codelineno-2-482" name="__codelineno-2-482" href="#__codelineno-2-482"></a><span class="c1">#</span>
<a id="__codelineno-2-483" name="__codelineno-2-483" href="#__codelineno-2-483"></a><span class="c1"># Note: root (UID:0) is always allowed</span>
<a id="__codelineno-2-484" name="__codelineno-2-484" href="#__codelineno-2-484"></a><span class="na">SMTP_ALLOWUSER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-485" name="__codelineno-2-485" href="#__codelineno-2-485"></a><span class="na">SMTP_ALLOWGROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"mail,mailman"</span>
<a id="__codelineno-2-486" name="__codelineno-2-486" href="#__codelineno-2-486"></a>
<a id="__codelineno-2-487" name="__codelineno-2-487" href="#__codelineno-2-487"></a><span class="c1"># This option will only allow SMTP AUTH to be advertised to the IP addresses</span>
<a id="__codelineno-2-488" name="__codelineno-2-488" href="#__codelineno-2-488"></a><span class="c1"># listed in /etc/csf/csf.smtpauth on EXIM mail servers</span>
<a id="__codelineno-2-489" name="__codelineno-2-489" href="#__codelineno-2-489"></a><span class="c1">#</span>
<a id="__codelineno-2-490" name="__codelineno-2-490" href="#__codelineno-2-490"></a><span class="c1"># The additional option CC_ALLOW_SMTPAUTH can be used with this option to</span>
<a id="__codelineno-2-491" name="__codelineno-2-491" href="#__codelineno-2-491"></a><span class="c1"># additionally restrict access to specific countries</span>
<a id="__codelineno-2-492" name="__codelineno-2-492" href="#__codelineno-2-492"></a><span class="c1">#</span>
<a id="__codelineno-2-493" name="__codelineno-2-493" href="#__codelineno-2-493"></a><span class="c1"># This is to help limit attempts at distributed attacks against SMTP AUTH which</span>
<a id="__codelineno-2-494" name="__codelineno-2-494" href="#__codelineno-2-494"></a><span class="c1"># are difficult to achive since port 25 needs to be open to relay email</span>
<a id="__codelineno-2-495" name="__codelineno-2-495" href="#__codelineno-2-495"></a><span class="c1">#</span>
<a id="__codelineno-2-496" name="__codelineno-2-496" href="#__codelineno-2-496"></a><span class="c1"># The reason why this works is that if EXIM does not advertise SMTP AUTH on a</span>
<a id="__codelineno-2-497" name="__codelineno-2-497" href="#__codelineno-2-497"></a><span class="c1"># connection, then SMTP AUTH will not accept logins, defeating the attacks</span>
<a id="__codelineno-2-498" name="__codelineno-2-498" href="#__codelineno-2-498"></a><span class="c1"># without restricting mail relaying</span>
<a id="__codelineno-2-499" name="__codelineno-2-499" href="#__codelineno-2-499"></a><span class="c1">#</span>
<a id="__codelineno-2-500" name="__codelineno-2-500" href="#__codelineno-2-500"></a><span class="c1"># Note: csf and lfd must be restarted if /etc/csf/csf.smtpauth is modified so</span>
<a id="__codelineno-2-501" name="__codelineno-2-501" href="#__codelineno-2-501"></a><span class="c1"># that the lookup file in /etc/exim.smtpauth is regenerated from the</span>
<a id="__codelineno-2-502" name="__codelineno-2-502" href="#__codelineno-2-502"></a><span class="c1"># information from /etc/csf/csf.smtpauth plus any countries listed in</span>
<a id="__codelineno-2-503" name="__codelineno-2-503" href="#__codelineno-2-503"></a><span class="c1"># CC_ALLOW_SMTPAUTH</span>
<a id="__codelineno-2-504" name="__codelineno-2-504" href="#__codelineno-2-504"></a><span class="c1">#</span>
<a id="__codelineno-2-505" name="__codelineno-2-505" href="#__codelineno-2-505"></a><span class="c1"># NOTE: To make this option work you MUST make the modifications to exim.conf</span>
<a id="__codelineno-2-506" name="__codelineno-2-506" href="#__codelineno-2-506"></a><span class="c1"># as explained in "Exim SMTP AUTH Restriction" section in /etc/csf/readme.txt</span>
<a id="__codelineno-2-507" name="__codelineno-2-507" href="#__codelineno-2-507"></a><span class="c1"># after enabling the option here, otherwise this option will not work</span>
<a id="__codelineno-2-508" name="__codelineno-2-508" href="#__codelineno-2-508"></a><span class="c1">#</span>
<a id="__codelineno-2-509" name="__codelineno-2-509" href="#__codelineno-2-509"></a><span class="c1"># To enable this option, set to 1 and make the exim configuration changes</span>
<a id="__codelineno-2-510" name="__codelineno-2-510" href="#__codelineno-2-510"></a><span class="c1"># To disable this option, set to 0 and undo the exim configuration changes</span>
<a id="__codelineno-2-511" name="__codelineno-2-511" href="#__codelineno-2-511"></a><span class="na">SMTPAUTH_RESTRICT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-512" name="__codelineno-2-512" href="#__codelineno-2-512"></a>
<a id="__codelineno-2-513" name="__codelineno-2-513" href="#__codelineno-2-513"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-514" name="__codelineno-2-514" href="#__codelineno-2-514"></a><span class="c1"># SECTION:Port Flood Settings</span>
<a id="__codelineno-2-515" name="__codelineno-2-515" href="#__codelineno-2-515"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-516" name="__codelineno-2-516" href="#__codelineno-2-516"></a><span class="c1"># Enable SYN Flood Protection. This option configures iptables to offer some</span>
<a id="__codelineno-2-517" name="__codelineno-2-517" href="#__codelineno-2-517"></a><span class="c1"># protection from tcp SYN packet DOS attempts. You should set the RATE so that</span>
<a id="__codelineno-2-518" name="__codelineno-2-518" href="#__codelineno-2-518"></a><span class="c1"># false-positives are kept to a minimum otherwise visitors may see connection</span>
<a id="__codelineno-2-519" name="__codelineno-2-519" href="#__codelineno-2-519"></a><span class="c1"># issues (check /var/log/messages for *SYNFLOOD Blocked*). See the iptables</span>
<a id="__codelineno-2-520" name="__codelineno-2-520" href="#__codelineno-2-520"></a><span class="c1"># man page for the correct --limit rate syntax</span>
<a id="__codelineno-2-521" name="__codelineno-2-521" href="#__codelineno-2-521"></a><span class="c1">#</span>
<a id="__codelineno-2-522" name="__codelineno-2-522" href="#__codelineno-2-522"></a><span class="c1"># Note: This option should ONLY be enabled if you know you are under a SYN</span>
<a id="__codelineno-2-523" name="__codelineno-2-523" href="#__codelineno-2-523"></a><span class="c1"># flood attack as it will slow down all new connections from any IP address to</span>
<a id="__codelineno-2-524" name="__codelineno-2-524" href="#__codelineno-2-524"></a><span class="c1"># the server if triggered</span>
<a id="__codelineno-2-525" name="__codelineno-2-525" href="#__codelineno-2-525"></a><span class="na">SYNFLOOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-526" name="__codelineno-2-526" href="#__codelineno-2-526"></a><span class="na">SYNFLOOD_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100/s"</span>
<a id="__codelineno-2-527" name="__codelineno-2-527" href="#__codelineno-2-527"></a><span class="na">SYNFLOOD_BURST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"150"</span>
<a id="__codelineno-2-528" name="__codelineno-2-528" href="#__codelineno-2-528"></a>
<a id="__codelineno-2-529" name="__codelineno-2-529" href="#__codelineno-2-529"></a><span class="c1"># Connection Limit Protection. This option configures iptables to offer more</span>
<a id="__codelineno-2-530" name="__codelineno-2-530" href="#__codelineno-2-530"></a><span class="c1"># protection from DOS attacks against specific ports. It can also be used as a</span>
<a id="__codelineno-2-531" name="__codelineno-2-531" href="#__codelineno-2-531"></a><span class="c1"># way to simply limit resource usage by IP address to specific server services.</span>
<a id="__codelineno-2-532" name="__codelineno-2-532" href="#__codelineno-2-532"></a><span class="c1"># This option limits the number of concurrent new connections per IP address</span>
<a id="__codelineno-2-533" name="__codelineno-2-533" href="#__codelineno-2-533"></a><span class="c1"># that can be made to specific ports</span>
<a id="__codelineno-2-534" name="__codelineno-2-534" href="#__codelineno-2-534"></a><span class="c1">#</span>
<a id="__codelineno-2-535" name="__codelineno-2-535" href="#__codelineno-2-535"></a><span class="c1"># This feature does not work on servers that do not have the iptables module</span>
<a id="__codelineno-2-536" name="__codelineno-2-536" href="#__codelineno-2-536"></a><span class="c1"># xt_connlimit loaded. Typically, this will be with MONOLITHIC kernels. VPS</span>
<a id="__codelineno-2-537" name="__codelineno-2-537" href="#__codelineno-2-537"></a><span class="c1"># server admins should check with their VPS host provider that the iptables</span>
<a id="__codelineno-2-538" name="__codelineno-2-538" href="#__codelineno-2-538"></a><span class="c1"># module is included</span>
<a id="__codelineno-2-539" name="__codelineno-2-539" href="#__codelineno-2-539"></a><span class="c1">#</span>
<a id="__codelineno-2-540" name="__codelineno-2-540" href="#__codelineno-2-540"></a><span class="c1"># For further information and syntax refer to the Connection Limit Protection</span>
<a id="__codelineno-2-541" name="__codelineno-2-541" href="#__codelineno-2-541"></a><span class="c1"># section of the csf readme.txt</span>
<a id="__codelineno-2-542" name="__codelineno-2-542" href="#__codelineno-2-542"></a><span class="c1">#</span>
<a id="__codelineno-2-543" name="__codelineno-2-543" href="#__codelineno-2-543"></a><span class="c1"># Note: Run /etc/csf/csftest.pl to check whether this option will function on</span>
<a id="__codelineno-2-544" name="__codelineno-2-544" href="#__codelineno-2-544"></a><span class="c1"># this server</span>
<a id="__codelineno-2-545" name="__codelineno-2-545" href="#__codelineno-2-545"></a><span class="na">CONNLIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-546" name="__codelineno-2-546" href="#__codelineno-2-546"></a>
<a id="__codelineno-2-547" name="__codelineno-2-547" href="#__codelineno-2-547"></a><span class="c1"># Port Flood Protection. This option configures iptables to offer protection</span>
<a id="__codelineno-2-548" name="__codelineno-2-548" href="#__codelineno-2-548"></a><span class="c1"># from DOS attacks against specific ports. This option limits the number of</span>
<a id="__codelineno-2-549" name="__codelineno-2-549" href="#__codelineno-2-549"></a><span class="c1"># new connections per time interval that can be made to specific ports</span>
<a id="__codelineno-2-550" name="__codelineno-2-550" href="#__codelineno-2-550"></a><span class="c1">#</span>
<a id="__codelineno-2-551" name="__codelineno-2-551" href="#__codelineno-2-551"></a><span class="c1"># This feature does not work on servers that do not have the iptables module</span>
<a id="__codelineno-2-552" name="__codelineno-2-552" href="#__codelineno-2-552"></a><span class="c1"># ipt_recent loaded. Typically, this will be with MONOLITHIC kernels. VPS</span>
<a id="__codelineno-2-553" name="__codelineno-2-553" href="#__codelineno-2-553"></a><span class="c1"># server admins should check with their VPS host provider that the iptables</span>
<a id="__codelineno-2-554" name="__codelineno-2-554" href="#__codelineno-2-554"></a><span class="c1"># module is included</span>
<a id="__codelineno-2-555" name="__codelineno-2-555" href="#__codelineno-2-555"></a><span class="c1">#</span>
<a id="__codelineno-2-556" name="__codelineno-2-556" href="#__codelineno-2-556"></a><span class="c1"># For further information and syntax refer to the Port Flood Protection</span>
<a id="__codelineno-2-557" name="__codelineno-2-557" href="#__codelineno-2-557"></a><span class="c1"># section of the csf readme.txt</span>
<a id="__codelineno-2-558" name="__codelineno-2-558" href="#__codelineno-2-558"></a><span class="c1">#</span>
<a id="__codelineno-2-559" name="__codelineno-2-559" href="#__codelineno-2-559"></a><span class="c1"># Note: Run /etc/csf/csftest.pl to check whether this option will function on</span>
<a id="__codelineno-2-560" name="__codelineno-2-560" href="#__codelineno-2-560"></a><span class="c1"># this server</span>
<a id="__codelineno-2-561" name="__codelineno-2-561" href="#__codelineno-2-561"></a><span class="na">PORTFLOOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-562" name="__codelineno-2-562" href="#__codelineno-2-562"></a>
<a id="__codelineno-2-563" name="__codelineno-2-563" href="#__codelineno-2-563"></a><span class="c1"># Outgoing UDP Flood Protection. This option limits outbound UDP packet floods.</span>
<a id="__codelineno-2-564" name="__codelineno-2-564" href="#__codelineno-2-564"></a><span class="c1"># These typically originate from exploit scripts uploaded through vulnerable</span>
<a id="__codelineno-2-565" name="__codelineno-2-565" href="#__codelineno-2-565"></a><span class="c1"># web scripts. Care should be taken on servers that use services that utilise</span>
<a id="__codelineno-2-566" name="__codelineno-2-566" href="#__codelineno-2-566"></a><span class="c1"># high levels of UDP outbound traffic, such as SNMP, so you may need to alter</span>
<a id="__codelineno-2-567" name="__codelineno-2-567" href="#__codelineno-2-567"></a><span class="c1"># the UDPFLOOD_LIMIT and UDPFLOOD_BURST options to suit your environment</span>
<a id="__codelineno-2-568" name="__codelineno-2-568" href="#__codelineno-2-568"></a><span class="c1">#</span>
<a id="__codelineno-2-569" name="__codelineno-2-569" href="#__codelineno-2-569"></a><span class="c1"># We recommend enabling User ID Tracking (UID_INTERVAL) with this feature</span>
<a id="__codelineno-2-570" name="__codelineno-2-570" href="#__codelineno-2-570"></a><span class="na">UDPFLOOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-571" name="__codelineno-2-571" href="#__codelineno-2-571"></a><span class="na">UDPFLOOD_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100/s"</span>
<a id="__codelineno-2-572" name="__codelineno-2-572" href="#__codelineno-2-572"></a><span class="na">UDPFLOOD_BURST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"500"</span>
<a id="__codelineno-2-573" name="__codelineno-2-573" href="#__codelineno-2-573"></a>
<a id="__codelineno-2-574" name="__codelineno-2-574" href="#__codelineno-2-574"></a><span class="c1"># This is a list of usernames that should not be rate limited, such as "named"</span>
<a id="__codelineno-2-575" name="__codelineno-2-575" href="#__codelineno-2-575"></a><span class="c1"># to prevent bind traffic from being limited.</span>
<a id="__codelineno-2-576" name="__codelineno-2-576" href="#__codelineno-2-576"></a><span class="c1">#</span>
<a id="__codelineno-2-577" name="__codelineno-2-577" href="#__codelineno-2-577"></a><span class="c1"># Note: root (UID:0) is always allowed</span>
<a id="__codelineno-2-578" name="__codelineno-2-578" href="#__codelineno-2-578"></a><span class="na">UDPFLOOD_ALLOWUSER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"named"</span>
<a id="__codelineno-2-579" name="__codelineno-2-579" href="#__codelineno-2-579"></a>
<a id="__codelineno-2-580" name="__codelineno-2-580" href="#__codelineno-2-580"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-581" name="__codelineno-2-581" href="#__codelineno-2-581"></a><span class="c1"># SECTION:Logging Settings</span>
<a id="__codelineno-2-582" name="__codelineno-2-582" href="#__codelineno-2-582"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-583" name="__codelineno-2-583" href="#__codelineno-2-583"></a><span class="c1"># Log lfd messages to SYSLOG in addition to /var/log/lfd.log. You must have the</span>
<a id="__codelineno-2-584" name="__codelineno-2-584" href="#__codelineno-2-584"></a><span class="c1"># perl module Sys::Syslog installed to use this feature</span>
<a id="__codelineno-2-585" name="__codelineno-2-585" href="#__codelineno-2-585"></a><span class="na">SYSLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-586" name="__codelineno-2-586" href="#__codelineno-2-586"></a>
<a id="__codelineno-2-587" name="__codelineno-2-587" href="#__codelineno-2-587"></a><span class="c1"># Drop target for incoming iptables rules. This can be set to either DROP or</span>
<a id="__codelineno-2-588" name="__codelineno-2-588" href="#__codelineno-2-588"></a><span class="c1"># REJECT. REJECT will send back an error packet, DROP will not respond at all.</span>
<a id="__codelineno-2-589" name="__codelineno-2-589" href="#__codelineno-2-589"></a><span class="c1"># REJECT is more polite, however it does provide extra information to a hacker</span>
<a id="__codelineno-2-590" name="__codelineno-2-590" href="#__codelineno-2-590"></a><span class="c1"># and lets them know that a firewall is blocking their attempts. DROP hangs</span>
<a id="__codelineno-2-591" name="__codelineno-2-591" href="#__codelineno-2-591"></a><span class="c1"># their connection, thereby frustrating attempts to port scan the server</span>
<a id="__codelineno-2-592" name="__codelineno-2-592" href="#__codelineno-2-592"></a><span class="na">DROP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"DROP"</span>
<a id="__codelineno-2-593" name="__codelineno-2-593" href="#__codelineno-2-593"></a>
<a id="__codelineno-2-594" name="__codelineno-2-594" href="#__codelineno-2-594"></a><span class="c1"># Drop target for outgoing iptables rules. This can be set to either DROP or</span>
<a id="__codelineno-2-595" name="__codelineno-2-595" href="#__codelineno-2-595"></a><span class="c1"># REJECT as with DROP, however as such connections are from this server it is</span>
<a id="__codelineno-2-596" name="__codelineno-2-596" href="#__codelineno-2-596"></a><span class="c1"># better to REJECT connections to closed ports rather than to DROP them. This</span>
<a id="__codelineno-2-597" name="__codelineno-2-597" href="#__codelineno-2-597"></a><span class="c1"># helps to immediately free up server resources rather than tying them up until</span>
<a id="__codelineno-2-598" name="__codelineno-2-598" href="#__codelineno-2-598"></a><span class="c1"># a connection times out. It also tells the process making the connection that</span>
<a id="__codelineno-2-599" name="__codelineno-2-599" href="#__codelineno-2-599"></a><span class="c1"># it has immediately failed</span>
<a id="__codelineno-2-600" name="__codelineno-2-600" href="#__codelineno-2-600"></a><span class="c1">#</span>
<a id="__codelineno-2-601" name="__codelineno-2-601" href="#__codelineno-2-601"></a><span class="c1"># It is possible that some monolithic kernels may not support the REJECT</span>
<a id="__codelineno-2-602" name="__codelineno-2-602" href="#__codelineno-2-602"></a><span class="c1"># target. If this is the case, csf checks before using REJECT and falls back to</span>
<a id="__codelineno-2-603" name="__codelineno-2-603" href="#__codelineno-2-603"></a><span class="c1"># using DROP, issuing a warning to set this to DROP instead</span>
<a id="__codelineno-2-604" name="__codelineno-2-604" href="#__codelineno-2-604"></a><span class="na">DROP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"REJECT"</span>
<a id="__codelineno-2-605" name="__codelineno-2-605" href="#__codelineno-2-605"></a>
<a id="__codelineno-2-606" name="__codelineno-2-606" href="#__codelineno-2-606"></a><span class="c1"># Enable logging of dropped connections to blocked ports to syslog, usually</span>
<a id="__codelineno-2-607" name="__codelineno-2-607" href="#__codelineno-2-607"></a><span class="c1"># /var/log/messages. This option needs to be enabled to use Port Scan Tracking</span>
<a id="__codelineno-2-608" name="__codelineno-2-608" href="#__codelineno-2-608"></a><span class="na">DROP_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-609" name="__codelineno-2-609" href="#__codelineno-2-609"></a>
<a id="__codelineno-2-610" name="__codelineno-2-610" href="#__codelineno-2-610"></a><span class="c1"># Enable logging of dropped incoming connections from blocked IP addresses</span>
<a id="__codelineno-2-611" name="__codelineno-2-611" href="#__codelineno-2-611"></a><span class="c1">#</span>
<a id="__codelineno-2-612" name="__codelineno-2-612" href="#__codelineno-2-612"></a><span class="c1"># This option will be disabled if you enable Port Scan Tracking (PS_INTERVAL)</span>
<a id="__codelineno-2-613" name="__codelineno-2-613" href="#__codelineno-2-613"></a><span class="na">DROP_IP_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-614" name="__codelineno-2-614" href="#__codelineno-2-614"></a>
<a id="__codelineno-2-615" name="__codelineno-2-615" href="#__codelineno-2-615"></a><span class="c1"># Enable logging of dropped outgoing connections</span>
<a id="__codelineno-2-616" name="__codelineno-2-616" href="#__codelineno-2-616"></a><span class="c1">#</span>
<a id="__codelineno-2-617" name="__codelineno-2-617" href="#__codelineno-2-617"></a><span class="c1"># Note: Only outgoing SYN packets for TCP connections are logged, other</span>
<a id="__codelineno-2-618" name="__codelineno-2-618" href="#__codelineno-2-618"></a><span class="c1"># protocols log all packets</span>
<a id="__codelineno-2-619" name="__codelineno-2-619" href="#__codelineno-2-619"></a><span class="c1">#</span>
<a id="__codelineno-2-620" name="__codelineno-2-620" href="#__codelineno-2-620"></a><span class="c1"># We recommend that you enable this option</span>
<a id="__codelineno-2-621" name="__codelineno-2-621" href="#__codelineno-2-621"></a><span class="na">DROP_OUT_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-622" name="__codelineno-2-622" href="#__codelineno-2-622"></a>
<a id="__codelineno-2-623" name="__codelineno-2-623" href="#__codelineno-2-623"></a><span class="c1"># Together with DROP_OUT_LOGGING enabled, this option logs the UID connecting</span>
<a id="__codelineno-2-624" name="__codelineno-2-624" href="#__codelineno-2-624"></a><span class="c1"># out (where available) which can help track abuse</span>
<a id="__codelineno-2-625" name="__codelineno-2-625" href="#__codelineno-2-625"></a><span class="na">DROP_UID_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-626" name="__codelineno-2-626" href="#__codelineno-2-626"></a>
<a id="__codelineno-2-627" name="__codelineno-2-627" href="#__codelineno-2-627"></a><span class="c1"># Only log incoming reserved port dropped connections (0:1023). This can reduce</span>
<a id="__codelineno-2-628" name="__codelineno-2-628" href="#__codelineno-2-628"></a><span class="c1"># the amount of log noise from dropped connections, but will affect options</span>
<a id="__codelineno-2-629" name="__codelineno-2-629" href="#__codelineno-2-629"></a><span class="c1"># such as Port Scan Tracking (PS_INTERVAL)</span>
<a id="__codelineno-2-630" name="__codelineno-2-630" href="#__codelineno-2-630"></a><span class="na">DROP_ONLYRES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-631" name="__codelineno-2-631" href="#__codelineno-2-631"></a>
<a id="__codelineno-2-632" name="__codelineno-2-632" href="#__codelineno-2-632"></a><span class="c1"># Commonly blocked ports that you do not want logging as they tend to just fill</span>
<a id="__codelineno-2-633" name="__codelineno-2-633" href="#__codelineno-2-633"></a><span class="c1"># up the log file. These ports are specifically blocked (applied to TCP and UDP</span>
<a id="__codelineno-2-634" name="__codelineno-2-634" href="#__codelineno-2-634"></a><span class="c1"># protocols) for incoming connections</span>
<a id="__codelineno-2-635" name="__codelineno-2-635" href="#__codelineno-2-635"></a><span class="na">DROP_NOLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"23,67,68,111,113,135:139,445,500,513,520"</span>
<a id="__codelineno-2-636" name="__codelineno-2-636" href="#__codelineno-2-636"></a>
<a id="__codelineno-2-637" name="__codelineno-2-637" href="#__codelineno-2-637"></a><span class="c1"># Log packets dropped by the packet filtering option PACKET_FILTER</span>
<a id="__codelineno-2-638" name="__codelineno-2-638" href="#__codelineno-2-638"></a><span class="na">DROP_PF_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-639" name="__codelineno-2-639" href="#__codelineno-2-639"></a>
<a id="__codelineno-2-640" name="__codelineno-2-640" href="#__codelineno-2-640"></a><span class="c1"># Log packets dropped by the Connection Limit Protection option CONNLIMIT. If</span>
<a id="__codelineno-2-641" name="__codelineno-2-641" href="#__codelineno-2-641"></a><span class="c1"># this is enabled and Port Scan Tracking (PS_INTERVAL) is also enabled, IP</span>
<a id="__codelineno-2-642" name="__codelineno-2-642" href="#__codelineno-2-642"></a><span class="c1"># addresses breaking the Connection Limit Protection will be blocked</span>
<a id="__codelineno-2-643" name="__codelineno-2-643" href="#__codelineno-2-643"></a><span class="na">CONNLIMIT_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-644" name="__codelineno-2-644" href="#__codelineno-2-644"></a>
<a id="__codelineno-2-645" name="__codelineno-2-645" href="#__codelineno-2-645"></a><span class="c1"># Enable logging of UDP floods. This should be enabled, especially with User ID</span>
<a id="__codelineno-2-646" name="__codelineno-2-646" href="#__codelineno-2-646"></a><span class="c1"># Tracking enabled</span>
<a id="__codelineno-2-647" name="__codelineno-2-647" href="#__codelineno-2-647"></a><span class="na">UDPFLOOD_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-648" name="__codelineno-2-648" href="#__codelineno-2-648"></a>
<a id="__codelineno-2-649" name="__codelineno-2-649" href="#__codelineno-2-649"></a><span class="c1"># Send an alert if log file flooding is detected which causes lfd to skip log</span>
<a id="__codelineno-2-650" name="__codelineno-2-650" href="#__codelineno-2-650"></a><span class="c1"># lines to prevent lfd from looping. If this alert is sent you should check the</span>
<a id="__codelineno-2-651" name="__codelineno-2-651" href="#__codelineno-2-651"></a><span class="c1"># reported log file for the reason for the flooding</span>
<a id="__codelineno-2-652" name="__codelineno-2-652" href="#__codelineno-2-652"></a><span class="na">LOGFLOOD_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-653" name="__codelineno-2-653" href="#__codelineno-2-653"></a>
<a id="__codelineno-2-654" name="__codelineno-2-654" href="#__codelineno-2-654"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-655" name="__codelineno-2-655" href="#__codelineno-2-655"></a><span class="c1"># SECTION:Reporting Settings</span>
<a id="__codelineno-2-656" name="__codelineno-2-656" href="#__codelineno-2-656"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-657" name="__codelineno-2-657" href="#__codelineno-2-657"></a><span class="c1"># By default, lfd will send alert emails using the relevant alert template to</span>
<a id="__codelineno-2-658" name="__codelineno-2-658" href="#__codelineno-2-658"></a><span class="c1"># the To: address configured within that template. Setting the following</span>
<a id="__codelineno-2-659" name="__codelineno-2-659" href="#__codelineno-2-659"></a><span class="c1"># option will override the configured To: field in all lfd alert emails</span>
<a id="__codelineno-2-660" name="__codelineno-2-660" href="#__codelineno-2-660"></a><span class="c1">#</span>
<a id="__codelineno-2-661" name="__codelineno-2-661" href="#__codelineno-2-661"></a><span class="c1"># Leave this option empty to use the To: field setting in each alert template</span>
<a id="__codelineno-2-662" name="__codelineno-2-662" href="#__codelineno-2-662"></a><span class="na">LF_ALERT_TO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-663" name="__codelineno-2-663" href="#__codelineno-2-663"></a>
<a id="__codelineno-2-664" name="__codelineno-2-664" href="#__codelineno-2-664"></a><span class="c1"># By default, lfd will send alert emails using the relevant alert template from</span>
<a id="__codelineno-2-665" name="__codelineno-2-665" href="#__codelineno-2-665"></a><span class="c1"># the From: address configured within that template. Setting the following</span>
<a id="__codelineno-2-666" name="__codelineno-2-666" href="#__codelineno-2-666"></a><span class="c1"># option will override the configured From: field in all lfd alert emails</span>
<a id="__codelineno-2-667" name="__codelineno-2-667" href="#__codelineno-2-667"></a><span class="c1">#</span>
<a id="__codelineno-2-668" name="__codelineno-2-668" href="#__codelineno-2-668"></a><span class="c1"># Leave this option empty to use the From: field setting in each alert template</span>
<a id="__codelineno-2-669" name="__codelineno-2-669" href="#__codelineno-2-669"></a><span class="na">LF_ALERT_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-670" name="__codelineno-2-670" href="#__codelineno-2-670"></a>
<a id="__codelineno-2-671" name="__codelineno-2-671" href="#__codelineno-2-671"></a><span class="c1"># By default, lfd will send all alerts using the SENDMAIL binary. To send using</span>
<a id="__codelineno-2-672" name="__codelineno-2-672" href="#__codelineno-2-672"></a><span class="c1"># SMTP directly, you can set the following to a relaying SMTP server, e.g.</span>
<a id="__codelineno-2-673" name="__codelineno-2-673" href="#__codelineno-2-673"></a><span class="c1"># "127.0.0.1". Leave this setting blank to use SENDMAIL</span>
<a id="__codelineno-2-674" name="__codelineno-2-674" href="#__codelineno-2-674"></a><span class="na">LF_ALERT_SMTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-675" name="__codelineno-2-675" href="#__codelineno-2-675"></a>
<a id="__codelineno-2-676" name="__codelineno-2-676" href="#__codelineno-2-676"></a><span class="c1"># Block Reporting. lfd can run an external script when it performs and IP</span>
<a id="__codelineno-2-677" name="__codelineno-2-677" href="#__codelineno-2-677"></a><span class="c1"># address block following for example a login failure. The following setting</span>
<a id="__codelineno-2-678" name="__codelineno-2-678" href="#__codelineno-2-678"></a><span class="c1"># is to the full path of the external script which must be executable. See</span>
<a id="__codelineno-2-679" name="__codelineno-2-679" href="#__codelineno-2-679"></a><span class="c1"># readme.txt for format details</span>
<a id="__codelineno-2-680" name="__codelineno-2-680" href="#__codelineno-2-680"></a><span class="c1">#</span>
<a id="__codelineno-2-681" name="__codelineno-2-681" href="#__codelineno-2-681"></a><span class="c1"># Leave this setting blank to disable</span>
<a id="__codelineno-2-682" name="__codelineno-2-682" href="#__codelineno-2-682"></a><span class="na">BLOCK_REPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-683" name="__codelineno-2-683" href="#__codelineno-2-683"></a>
<a id="__codelineno-2-684" name="__codelineno-2-684" href="#__codelineno-2-684"></a><span class="c1"># To also run an external script when a temporary block is unblocked. The</span>
<a id="__codelineno-2-685" name="__codelineno-2-685" href="#__codelineno-2-685"></a><span class="c1"># following setting can be the full path of the external script which must be</span>
<a id="__codelineno-2-686" name="__codelineno-2-686" href="#__codelineno-2-686"></a><span class="c1"># executable. See readme.txt for format details</span>
<a id="__codelineno-2-687" name="__codelineno-2-687" href="#__codelineno-2-687"></a><span class="c1">#</span>
<a id="__codelineno-2-688" name="__codelineno-2-688" href="#__codelineno-2-688"></a><span class="c1"># Leave this setting blank to disable</span>
<a id="__codelineno-2-689" name="__codelineno-2-689" href="#__codelineno-2-689"></a><span class="na">UNBLOCK_REPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-690" name="__codelineno-2-690" href="#__codelineno-2-690"></a>
<a id="__codelineno-2-691" name="__codelineno-2-691" href="#__codelineno-2-691"></a><span class="c1"># In addition to the standard lfd email alerts, you can additionally enable the</span>
<a id="__codelineno-2-692" name="__codelineno-2-692" href="#__codelineno-2-692"></a><span class="c1"># sending of X-ARF reports (see http://www.xarf.org/specification.html). Only</span>
<a id="__codelineno-2-693" name="__codelineno-2-693" href="#__codelineno-2-693"></a><span class="c1"># block alert messages will be sent. The reports use our schema at:</span>
<a id="__codelineno-2-694" name="__codelineno-2-694" href="#__codelineno-2-694"></a><span class="c1"># https://download.configserver.dev/abuse_login-attack_0.2.json</span>
<a id="__codelineno-2-695" name="__codelineno-2-695" href="#__codelineno-2-695"></a><span class="c1">#</span>
<a id="__codelineno-2-696" name="__codelineno-2-696" href="#__codelineno-2-696"></a><span class="c1"># These reports are in a format accepted by many Netblock owners and should</span>
<a id="__codelineno-2-697" name="__codelineno-2-697" href="#__codelineno-2-697"></a><span class="c1"># help them investigate abuse. This option is not designed to automatically</span>
<a id="__codelineno-2-698" name="__codelineno-2-698" href="#__codelineno-2-698"></a><span class="c1"># forward these reports to the Netblock owners and should be checked for</span>
<a id="__codelineno-2-699" name="__codelineno-2-699" href="#__codelineno-2-699"></a><span class="c1"># false-positive blocks before reporting</span>
<a id="__codelineno-2-700" name="__codelineno-2-700" href="#__codelineno-2-700"></a><span class="c1">#</span>
<a id="__codelineno-2-701" name="__codelineno-2-701" href="#__codelineno-2-701"></a><span class="c1"># If available, the report will also include the abuse contact for the IP from</span>
<a id="__codelineno-2-702" name="__codelineno-2-702" href="#__codelineno-2-702"></a><span class="c1"># the Abusix Contact DB: https://abusix.com/contactdb.html</span>
<a id="__codelineno-2-703" name="__codelineno-2-703" href="#__codelineno-2-703"></a><span class="c1">#</span>
<a id="__codelineno-2-704" name="__codelineno-2-704" href="#__codelineno-2-704"></a><span class="c1"># Note: The following block types are not reported through this feature:</span>
<a id="__codelineno-2-705" name="__codelineno-2-705" href="#__codelineno-2-705"></a><span class="c1"># LF_PERMBLOCK, LF_NETBLOCK, LF_DISTATTACK, LF_DISTFTP, RT_*_ALERT</span>
<a id="__codelineno-2-706" name="__codelineno-2-706" href="#__codelineno-2-706"></a><span class="na">X_ARF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-707" name="__codelineno-2-707" href="#__codelineno-2-707"></a>
<a id="__codelineno-2-708" name="__codelineno-2-708" href="#__codelineno-2-708"></a><span class="c1"># By default, lfd will send emails from the root forwarder. Setting the</span>
<a id="__codelineno-2-709" name="__codelineno-2-709" href="#__codelineno-2-709"></a><span class="c1"># following option will override this</span>
<a id="__codelineno-2-710" name="__codelineno-2-710" href="#__codelineno-2-710"></a><span class="na">X_ARF_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-711" name="__codelineno-2-711" href="#__codelineno-2-711"></a>
<a id="__codelineno-2-712" name="__codelineno-2-712" href="#__codelineno-2-712"></a><span class="c1"># By default, lfd will send emails to the root forwarder. Setting the following</span>
<a id="__codelineno-2-713" name="__codelineno-2-713" href="#__codelineno-2-713"></a><span class="c1"># option will override this</span>
<a id="__codelineno-2-714" name="__codelineno-2-714" href="#__codelineno-2-714"></a><span class="na">X_ARF_TO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-715" name="__codelineno-2-715" href="#__codelineno-2-715"></a>
<a id="__codelineno-2-716" name="__codelineno-2-716" href="#__codelineno-2-716"></a><span class="c1"># If you want to automatically send reports to the abuse contact where found,</span>
<a id="__codelineno-2-717" name="__codelineno-2-717" href="#__codelineno-2-717"></a><span class="c1"># you can enable the following option</span>
<a id="__codelineno-2-718" name="__codelineno-2-718" href="#__codelineno-2-718"></a><span class="c1">#</span>
<a id="__codelineno-2-719" name="__codelineno-2-719" href="#__codelineno-2-719"></a><span class="c1"># Note: You MUST set X_ARF_FROM to a valid email address for this option to</span>
<a id="__codelineno-2-720" name="__codelineno-2-720" href="#__codelineno-2-720"></a><span class="c1"># work. This is so that the abuse contact can reply to the report</span>
<a id="__codelineno-2-721" name="__codelineno-2-721" href="#__codelineno-2-721"></a><span class="c1">#</span>
<a id="__codelineno-2-722" name="__codelineno-2-722" href="#__codelineno-2-722"></a><span class="c1"># However, you should be aware that without manual checking you could be</span>
<a id="__codelineno-2-723" name="__codelineno-2-723" href="#__codelineno-2-723"></a><span class="c1"># reporting innocent IP addresses, including your own clients, yourself and</span>
<a id="__codelineno-2-724" name="__codelineno-2-724" href="#__codelineno-2-724"></a><span class="c1"># your own servers</span>
<a id="__codelineno-2-725" name="__codelineno-2-725" href="#__codelineno-2-725"></a><span class="c1">#</span>
<a id="__codelineno-2-726" name="__codelineno-2-726" href="#__codelineno-2-726"></a><span class="c1"># Additionally, just because a contact address is found, does not mean that</span>
<a id="__codelineno-2-727" name="__codelineno-2-727" href="#__codelineno-2-727"></a><span class="c1"># there is anyone on the end of it reading, processing or acting on such</span>
<a id="__codelineno-2-728" name="__codelineno-2-728" href="#__codelineno-2-728"></a><span class="c1"># reports and you could conceivably reported for sending spam</span>
<a id="__codelineno-2-729" name="__codelineno-2-729" href="#__codelineno-2-729"></a><span class="c1">#</span>
<a id="__codelineno-2-730" name="__codelineno-2-730" href="#__codelineno-2-730"></a><span class="c1"># We do not recommend enabling this option. Abuse reports should be checked and</span>
<a id="__codelineno-2-731" name="__codelineno-2-731" href="#__codelineno-2-731"></a><span class="c1"># verified before being forwarded to the abuse contact</span>
<a id="__codelineno-2-732" name="__codelineno-2-732" href="#__codelineno-2-732"></a><span class="na">X_ARF_ABUSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-733" name="__codelineno-2-733" href="#__codelineno-2-733"></a>
<a id="__codelineno-2-734" name="__codelineno-2-734" href="#__codelineno-2-734"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-735" name="__codelineno-2-735" href="#__codelineno-2-735"></a><span class="c1"># SECTION:Temp to Perm/Netblock Settings</span>
<a id="__codelineno-2-736" name="__codelineno-2-736" href="#__codelineno-2-736"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-737" name="__codelineno-2-737" href="#__codelineno-2-737"></a><span class="c1"># Temporary to Permanent IP blocking. The following enables this feature to</span>
<a id="__codelineno-2-738" name="__codelineno-2-738" href="#__codelineno-2-738"></a><span class="c1"># permanently block IP addresses that have been temporarily blocked more than</span>
<a id="__codelineno-2-739" name="__codelineno-2-739" href="#__codelineno-2-739"></a><span class="c1"># LF_PERMBLOCK_COUNT times in the last LF_PERMBLOCK_INTERVAL seconds. Set</span>
<a id="__codelineno-2-740" name="__codelineno-2-740" href="#__codelineno-2-740"></a><span class="c1"># LF_PERMBLOCK  to "1" to enable this feature</span>
<a id="__codelineno-2-741" name="__codelineno-2-741" href="#__codelineno-2-741"></a><span class="c1">#</span>
<a id="__codelineno-2-742" name="__codelineno-2-742" href="#__codelineno-2-742"></a><span class="c1"># Care needs to be taken when setting LF_PERMBLOCK_INTERVAL as it needs to be</span>
<a id="__codelineno-2-743" name="__codelineno-2-743" href="#__codelineno-2-743"></a><span class="c1"># at least LF_PERMBLOCK_COUNT multiplied by the longest temporary time setting</span>
<a id="__codelineno-2-744" name="__codelineno-2-744" href="#__codelineno-2-744"></a><span class="c1"># (TTL) for blocked IPs, to be effective</span>
<a id="__codelineno-2-745" name="__codelineno-2-745" href="#__codelineno-2-745"></a><span class="c1">#</span>
<a id="__codelineno-2-746" name="__codelineno-2-746" href="#__codelineno-2-746"></a><span class="c1"># Set LF_PERMBLOCK to "0" to disable this feature</span>
<a id="__codelineno-2-747" name="__codelineno-2-747" href="#__codelineno-2-747"></a><span class="na">LF_PERMBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-748" name="__codelineno-2-748" href="#__codelineno-2-748"></a><span class="na">LF_PERMBLOCK_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"86400"</span>
<a id="__codelineno-2-749" name="__codelineno-2-749" href="#__codelineno-2-749"></a><span class="na">LF_PERMBLOCK_COUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"4"</span>
<a id="__codelineno-2-750" name="__codelineno-2-750" href="#__codelineno-2-750"></a><span class="na">LF_PERMBLOCK_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-751" name="__codelineno-2-751" href="#__codelineno-2-751"></a>
<a id="__codelineno-2-752" name="__codelineno-2-752" href="#__codelineno-2-752"></a><span class="c1"># Permanently block IPs by network class. The following enables this feature</span>
<a id="__codelineno-2-753" name="__codelineno-2-753" href="#__codelineno-2-753"></a><span class="c1"># to permanently block classes of IP address where individual IP addresses</span>
<a id="__codelineno-2-754" name="__codelineno-2-754" href="#__codelineno-2-754"></a><span class="c1"># within the same class LF_NETBLOCK_CLASS have already been blocked more than</span>
<a id="__codelineno-2-755" name="__codelineno-2-755" href="#__codelineno-2-755"></a><span class="c1"># LF_NETBLOCK_COUNT times in the last LF_NETBLOCK_INTERVAL seconds. Set</span>
<a id="__codelineno-2-756" name="__codelineno-2-756" href="#__codelineno-2-756"></a><span class="c1"># LF_NETBLOCK  to "1" to enable this feature</span>
<a id="__codelineno-2-757" name="__codelineno-2-757" href="#__codelineno-2-757"></a><span class="c1">#</span>
<a id="__codelineno-2-758" name="__codelineno-2-758" href="#__codelineno-2-758"></a><span class="c1"># This can be an affective way of blocking DDOS attacks launched from within</span>
<a id="__codelineno-2-759" name="__codelineno-2-759" href="#__codelineno-2-759"></a><span class="c1"># the same network class</span>
<a id="__codelineno-2-760" name="__codelineno-2-760" href="#__codelineno-2-760"></a><span class="c1">#</span>
<a id="__codelineno-2-761" name="__codelineno-2-761" href="#__codelineno-2-761"></a><span class="c1"># Valid settings for LF_NETBLOCK_CLASS are "A", "B" and "C", care and</span>
<a id="__codelineno-2-762" name="__codelineno-2-762" href="#__codelineno-2-762"></a><span class="c1"># consideration is required when blocking network classes A or B</span>
<a id="__codelineno-2-763" name="__codelineno-2-763" href="#__codelineno-2-763"></a><span class="c1">#</span>
<a id="__codelineno-2-764" name="__codelineno-2-764" href="#__codelineno-2-764"></a><span class="c1"># Set LF_NETBLOCK to "0" to disable this feature</span>
<a id="__codelineno-2-765" name="__codelineno-2-765" href="#__codelineno-2-765"></a><span class="na">LF_NETBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-766" name="__codelineno-2-766" href="#__codelineno-2-766"></a><span class="na">LF_NETBLOCK_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"86400"</span>
<a id="__codelineno-2-767" name="__codelineno-2-767" href="#__codelineno-2-767"></a><span class="na">LF_NETBLOCK_COUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"4"</span>
<a id="__codelineno-2-768" name="__codelineno-2-768" href="#__codelineno-2-768"></a><span class="na">LF_NETBLOCK_CLASS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"C"</span>
<a id="__codelineno-2-769" name="__codelineno-2-769" href="#__codelineno-2-769"></a><span class="na">LF_NETBLOCK_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-770" name="__codelineno-2-770" href="#__codelineno-2-770"></a>
<a id="__codelineno-2-771" name="__codelineno-2-771" href="#__codelineno-2-771"></a><span class="c1"># Valid settings for LF_NETBLOCK_IPV6 are "/64", "/56", "/48", "/32" and "/24"</span>
<a id="__codelineno-2-772" name="__codelineno-2-772" href="#__codelineno-2-772"></a><span class="c1"># Great care should be taken with IPV6 netblock ranges due to the large number</span>
<a id="__codelineno-2-773" name="__codelineno-2-773" href="#__codelineno-2-773"></a><span class="c1"># of addresses involved</span>
<a id="__codelineno-2-774" name="__codelineno-2-774" href="#__codelineno-2-774"></a><span class="c1">#</span>
<a id="__codelineno-2-775" name="__codelineno-2-775" href="#__codelineno-2-775"></a><span class="c1"># To disable IPv6 netblocks set to ""</span>
<a id="__codelineno-2-776" name="__codelineno-2-776" href="#__codelineno-2-776"></a><span class="na">LF_NETBLOCK_IPV6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-777" name="__codelineno-2-777" href="#__codelineno-2-777"></a>
<a id="__codelineno-2-778" name="__codelineno-2-778" href="#__codelineno-2-778"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-779" name="__codelineno-2-779" href="#__codelineno-2-779"></a><span class="c1"># SECTION:Global Lists/DYNDNS/Blocklists</span>
<a id="__codelineno-2-780" name="__codelineno-2-780" href="#__codelineno-2-780"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-781" name="__codelineno-2-781" href="#__codelineno-2-781"></a><span class="c1"># Safe Chain Update. If enabled, all dynamic update chains (GALLOW*, GDENY*,</span>
<a id="__codelineno-2-782" name="__codelineno-2-782" href="#__codelineno-2-782"></a><span class="c1"># SPAMHAUS, DSHIELD, BOGON, CC_ALLOW, CC_DENY, ALLOWDYN*) will create a new</span>
<a id="__codelineno-2-783" name="__codelineno-2-783" href="#__codelineno-2-783"></a><span class="c1"># chain when updating, and insert it into the relevant LOCALINPUT/LOCALOUTPUT</span>
<a id="__codelineno-2-784" name="__codelineno-2-784" href="#__codelineno-2-784"></a><span class="c1"># chain, then flush and delete the old dynamic chain and rename the new chain.</span>
<a id="__codelineno-2-785" name="__codelineno-2-785" href="#__codelineno-2-785"></a><span class="c1">#</span>
<a id="__codelineno-2-786" name="__codelineno-2-786" href="#__codelineno-2-786"></a><span class="c1"># This prevents a small window of opportunity opening when an update occurs and</span>
<a id="__codelineno-2-787" name="__codelineno-2-787" href="#__codelineno-2-787"></a><span class="c1"># the dynamic chain is flushed for the new rules.</span>
<a id="__codelineno-2-788" name="__codelineno-2-788" href="#__codelineno-2-788"></a><span class="c1">#</span>
<a id="__codelineno-2-789" name="__codelineno-2-789" href="#__codelineno-2-789"></a><span class="c1"># This option should not be enabled on servers with long dynamic chains (e.g.</span>
<a id="__codelineno-2-790" name="__codelineno-2-790" href="#__codelineno-2-790"></a><span class="c1"># CC_DENY/CC_ALLOW lists) and low memory. It should also not be enabled on</span>
<a id="__codelineno-2-791" name="__codelineno-2-791" href="#__codelineno-2-791"></a><span class="c1"># Virtuozzo VPS servers with a restricted numiptent value. This is because each</span>
<a id="__codelineno-2-792" name="__codelineno-2-792" href="#__codelineno-2-792"></a><span class="c1"># chain will effectively be duplicated while the update occurs, doubling the</span>
<a id="__codelineno-2-793" name="__codelineno-2-793" href="#__codelineno-2-793"></a><span class="c1"># number of iptables rules</span>
<a id="__codelineno-2-794" name="__codelineno-2-794" href="#__codelineno-2-794"></a><span class="na">SAFECHAINUPDATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-795" name="__codelineno-2-795" href="#__codelineno-2-795"></a>
<a id="__codelineno-2-796" name="__codelineno-2-796" href="#__codelineno-2-796"></a><span class="c1"># If you wish to allow access from dynamic DNS records (for example if your IP</span>
<a id="__codelineno-2-797" name="__codelineno-2-797" href="#__codelineno-2-797"></a><span class="c1"># address changes whenever you connect to the internet but you have a dedicated</span>
<a id="__codelineno-2-798" name="__codelineno-2-798" href="#__codelineno-2-798"></a><span class="c1"># dynamic DNS record from the likes of dyndns.org) then you can list the FQDN</span>
<a id="__codelineno-2-799" name="__codelineno-2-799" href="#__codelineno-2-799"></a><span class="c1"># records in csf.dyndns and then set the following to the number of seconds to</span>
<a id="__codelineno-2-800" name="__codelineno-2-800" href="#__codelineno-2-800"></a><span class="c1"># poll for a change in the IP address. If the IP address has changed iptables</span>
<a id="__codelineno-2-801" name="__codelineno-2-801" href="#__codelineno-2-801"></a><span class="c1"># will be updated.</span>
<a id="__codelineno-2-802" name="__codelineno-2-802" href="#__codelineno-2-802"></a><span class="c1">#</span>
<a id="__codelineno-2-803" name="__codelineno-2-803" href="#__codelineno-2-803"></a><span class="c1"># If the FQDN has multiple A records then all of the IP addresses will be</span>
<a id="__codelineno-2-804" name="__codelineno-2-804" href="#__codelineno-2-804"></a><span class="c1"># processed. If IPV6 is enabled, then all IPv6 AAAA IP address records will</span>
<a id="__codelineno-2-805" name="__codelineno-2-805" href="#__codelineno-2-805"></a><span class="c1"># also be allowed.</span>
<a id="__codelineno-2-806" name="__codelineno-2-806" href="#__codelineno-2-806"></a><span class="c1"># </span>
<a id="__codelineno-2-807" name="__codelineno-2-807" href="#__codelineno-2-807"></a><span class="c1"># A setting of 600 would check for IP updates every 10 minutes. Set the value</span>
<a id="__codelineno-2-808" name="__codelineno-2-808" href="#__codelineno-2-808"></a><span class="c1"># to 0 to disable the feature</span>
<a id="__codelineno-2-809" name="__codelineno-2-809" href="#__codelineno-2-809"></a><span class="na">DYNDNS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-810" name="__codelineno-2-810" href="#__codelineno-2-810"></a>
<a id="__codelineno-2-811" name="__codelineno-2-811" href="#__codelineno-2-811"></a><span class="c1"># To always ignore DYNDNS IP addresses in lfd blocking, set the following</span>
<a id="__codelineno-2-812" name="__codelineno-2-812" href="#__codelineno-2-812"></a><span class="c1"># option to 1</span>
<a id="__codelineno-2-813" name="__codelineno-2-813" href="#__codelineno-2-813"></a><span class="na">DYNDNS_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-814" name="__codelineno-2-814" href="#__codelineno-2-814"></a>
<a id="__codelineno-2-815" name="__codelineno-2-815" href="#__codelineno-2-815"></a><span class="c1"># The follow Global options allow you to specify a URL where csf can grab a</span>
<a id="__codelineno-2-816" name="__codelineno-2-816" href="#__codelineno-2-816"></a><span class="c1"># centralised copy of an IP allow or deny block list of your own. You need to</span>
<a id="__codelineno-2-817" name="__codelineno-2-817" href="#__codelineno-2-817"></a><span class="c1"># specify the full URL in the following options, i.e.:</span>
<a id="__codelineno-2-818" name="__codelineno-2-818" href="#__codelineno-2-818"></a><span class="c1"># http://www.somelocation.com/allow.txt</span>
<a id="__codelineno-2-819" name="__codelineno-2-819" href="#__codelineno-2-819"></a><span class="c1">#</span>
<a id="__codelineno-2-820" name="__codelineno-2-820" href="#__codelineno-2-820"></a><span class="c1"># The actual retrieval of these IP's is controlled by lfd, so you need to set</span>
<a id="__codelineno-2-821" name="__codelineno-2-821" href="#__codelineno-2-821"></a><span class="c1"># LF_GLOBAL to the interval (in seconds) when you want lfd to retrieve. lfd</span>
<a id="__codelineno-2-822" name="__codelineno-2-822" href="#__codelineno-2-822"></a><span class="c1"># will perform the retrieval when it runs and then again at the specified</span>
<a id="__codelineno-2-823" name="__codelineno-2-823" href="#__codelineno-2-823"></a><span class="c1"># interval. A sensible interval would probably be every 3600 seconds (1 hour).</span>
<a id="__codelineno-2-824" name="__codelineno-2-824" href="#__codelineno-2-824"></a><span class="c1"># A minimum value of 300 is enforced for LF_GLOBAL if enabled</span>
<a id="__codelineno-2-825" name="__codelineno-2-825" href="#__codelineno-2-825"></a><span class="c1">#</span>
<a id="__codelineno-2-826" name="__codelineno-2-826" href="#__codelineno-2-826"></a><span class="c1"># You do not have to specify both an allow and a deny file</span>
<a id="__codelineno-2-827" name="__codelineno-2-827" href="#__codelineno-2-827"></a><span class="c1">#</span>
<a id="__codelineno-2-828" name="__codelineno-2-828" href="#__codelineno-2-828"></a><span class="c1"># You can also configure a global ignore file for IP's that lfd should ignore</span>
<a id="__codelineno-2-829" name="__codelineno-2-829" href="#__codelineno-2-829"></a><span class="na">LF_GLOBAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-830" name="__codelineno-2-830" href="#__codelineno-2-830"></a>
<a id="__codelineno-2-831" name="__codelineno-2-831" href="#__codelineno-2-831"></a><span class="na">GLOBAL_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-832" name="__codelineno-2-832" href="#__codelineno-2-832"></a><span class="na">GLOBAL_DENY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-833" name="__codelineno-2-833" href="#__codelineno-2-833"></a><span class="na">GLOBAL_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-834" name="__codelineno-2-834" href="#__codelineno-2-834"></a>
<a id="__codelineno-2-835" name="__codelineno-2-835" href="#__codelineno-2-835"></a><span class="c1"># Provides the same functionality as DYNDNS but with a GLOBAL URL file. Set</span>
<a id="__codelineno-2-836" name="__codelineno-2-836" href="#__codelineno-2-836"></a><span class="c1"># this to the URL of the file containing DYNDNS entries</span>
<a id="__codelineno-2-837" name="__codelineno-2-837" href="#__codelineno-2-837"></a><span class="na">GLOBAL_DYNDNS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-838" name="__codelineno-2-838" href="#__codelineno-2-838"></a>
<a id="__codelineno-2-839" name="__codelineno-2-839" href="#__codelineno-2-839"></a><span class="c1"># Set the following to the number of seconds to poll for a change in the IP</span>
<a id="__codelineno-2-840" name="__codelineno-2-840" href="#__codelineno-2-840"></a><span class="c1"># address resoved from GLOBAL_DYNDNS</span>
<a id="__codelineno-2-841" name="__codelineno-2-841" href="#__codelineno-2-841"></a><span class="na">GLOBAL_DYNDNS_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"600"</span>
<a id="__codelineno-2-842" name="__codelineno-2-842" href="#__codelineno-2-842"></a>
<a id="__codelineno-2-843" name="__codelineno-2-843" href="#__codelineno-2-843"></a><span class="c1"># To always ignore GLOBAL_DYNDNS IP addresses in lfd blocking, set the following</span>
<a id="__codelineno-2-844" name="__codelineno-2-844" href="#__codelineno-2-844"></a><span class="c1"># option to 1</span>
<a id="__codelineno-2-845" name="__codelineno-2-845" href="#__codelineno-2-845"></a><span class="na">GLOBAL_DYNDNS_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-846" name="__codelineno-2-846" href="#__codelineno-2-846"></a>
<a id="__codelineno-2-847" name="__codelineno-2-847" href="#__codelineno-2-847"></a><span class="c1"># Blocklists are controlled by modifying /etc/csf/csf.blocklists</span>
<a id="__codelineno-2-848" name="__codelineno-2-848" href="#__codelineno-2-848"></a><span class="c1">#</span>
<a id="__codelineno-2-849" name="__codelineno-2-849" href="#__codelineno-2-849"></a><span class="c1"># If you don't want BOGON rules applied to specific NICs, then list them in</span>
<a id="__codelineno-2-850" name="__codelineno-2-850" href="#__codelineno-2-850"></a><span class="c1"># a comma separated list (e.g "eth1,eth2")</span>
<a id="__codelineno-2-851" name="__codelineno-2-851" href="#__codelineno-2-851"></a><span class="na">LF_BOGON_SKIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-852" name="__codelineno-2-852" href="#__codelineno-2-852"></a>
<a id="__codelineno-2-853" name="__codelineno-2-853" href="#__codelineno-2-853"></a><span class="c1"># The following option can be used to select the method csf will use to</span>
<a id="__codelineno-2-854" name="__codelineno-2-854" href="#__codelineno-2-854"></a><span class="c1"># retrieve URL data and files</span>
<a id="__codelineno-2-855" name="__codelineno-2-855" href="#__codelineno-2-855"></a><span class="c1">#</span>
<a id="__codelineno-2-856" name="__codelineno-2-856" href="#__codelineno-2-856"></a><span class="c1"># This can be set to use:</span>
<a id="__codelineno-2-857" name="__codelineno-2-857" href="#__codelineno-2-857"></a><span class="c1">#</span>
<a id="__codelineno-2-858" name="__codelineno-2-858" href="#__codelineno-2-858"></a><span class="c1"># 1. Perl module HTTP::Tiny</span>
<a id="__codelineno-2-859" name="__codelineno-2-859" href="#__codelineno-2-859"></a><span class="c1"># 2. Perl module LWP::UserAgent</span>
<a id="__codelineno-2-860" name="__codelineno-2-860" href="#__codelineno-2-860"></a><span class="c1"># 3. CURL/WGET (set location at the bottom of csf.conf if installed)</span>
<a id="__codelineno-2-861" name="__codelineno-2-861" href="#__codelineno-2-861"></a><span class="c1">#</span>
<a id="__codelineno-2-862" name="__codelineno-2-862" href="#__codelineno-2-862"></a><span class="c1"># HTTP::Tiny is much faster than LWP::UserAgent and is included in the csf</span>
<a id="__codelineno-2-863" name="__codelineno-2-863" href="#__codelineno-2-863"></a><span class="c1"># distribution. LWP::UserAgent may have to be installed manually, but it can</span>
<a id="__codelineno-2-864" name="__codelineno-2-864" href="#__codelineno-2-864"></a><span class="c1"># better support https:// URL's which also needs the LWP::Protocol::https perl</span>
<a id="__codelineno-2-865" name="__codelineno-2-865" href="#__codelineno-2-865"></a><span class="c1"># module</span>
<a id="__codelineno-2-866" name="__codelineno-2-866" href="#__codelineno-2-866"></a><span class="c1">#</span>
<a id="__codelineno-2-867" name="__codelineno-2-867" href="#__codelineno-2-867"></a><span class="c1"># CURL/WGET uses the system binaries if installed but does not always provide</span>
<a id="__codelineno-2-868" name="__codelineno-2-868" href="#__codelineno-2-868"></a><span class="c1"># good feedback when it fails. The script will first look for CURL, if that</span>
<a id="__codelineno-2-869" name="__codelineno-2-869" href="#__codelineno-2-869"></a><span class="c1"># does not exist at the configured location it will then look for WGET</span>
<a id="__codelineno-2-870" name="__codelineno-2-870" href="#__codelineno-2-870"></a><span class="c1">#</span>
<a id="__codelineno-2-871" name="__codelineno-2-871" href="#__codelineno-2-871"></a><span class="c1"># Additionally, 1 or 2 are used and the retrieval fails, then if either CURL or</span>
<a id="__codelineno-2-872" name="__codelineno-2-872" href="#__codelineno-2-872"></a><span class="c1"># WGET are available, an additional attempt will be using CURL/WGET. This is</span>
<a id="__codelineno-2-873" name="__codelineno-2-873" href="#__codelineno-2-873"></a><span class="c1"># useful if the perl distribution has outdated modules that do not support</span>
<a id="__codelineno-2-874" name="__codelineno-2-874" href="#__codelineno-2-874"></a><span class="c1"># modern SSL/TLS implementations</span>
<a id="__codelineno-2-875" name="__codelineno-2-875" href="#__codelineno-2-875"></a><span class="c1">#</span>
<a id="__codelineno-2-876" name="__codelineno-2-876" href="#__codelineno-2-876"></a><span class="c1"># To install the LWP perl modules required:</span>
<a id="__codelineno-2-877" name="__codelineno-2-877" href="#__codelineno-2-877"></a><span class="c1">#</span>
<a id="__codelineno-2-878" name="__codelineno-2-878" href="#__codelineno-2-878"></a><span class="c1"># On rpm based systems:</span>
<a id="__codelineno-2-879" name="__codelineno-2-879" href="#__codelineno-2-879"></a><span class="c1"># </span>
<a id="__codelineno-2-880" name="__codelineno-2-880" href="#__codelineno-2-880"></a><span class="c1">#   yum install perl-libwww-perl.noarch perl-LWP-Protocol-https.noarch</span>
<a id="__codelineno-2-881" name="__codelineno-2-881" href="#__codelineno-2-881"></a><span class="c1">#</span>
<a id="__codelineno-2-882" name="__codelineno-2-882" href="#__codelineno-2-882"></a><span class="c1"># On APT based systems:</span>
<a id="__codelineno-2-883" name="__codelineno-2-883" href="#__codelineno-2-883"></a><span class="c1">#</span>
<a id="__codelineno-2-884" name="__codelineno-2-884" href="#__codelineno-2-884"></a><span class="c1">#   apt-get install libwww-perl liblwp-protocol-https-perl</span>
<a id="__codelineno-2-885" name="__codelineno-2-885" href="#__codelineno-2-885"></a><span class="c1">#</span>
<a id="__codelineno-2-886" name="__codelineno-2-886" href="#__codelineno-2-886"></a><span class="c1"># Via cpan:</span>
<a id="__codelineno-2-887" name="__codelineno-2-887" href="#__codelineno-2-887"></a><span class="c1">#</span>
<a id="__codelineno-2-888" name="__codelineno-2-888" href="#__codelineno-2-888"></a><span class="c1">#   perl -MCPAN -eshell</span>
<a id="__codelineno-2-889" name="__codelineno-2-889" href="#__codelineno-2-889"></a><span class="c1">#   cpan&gt; install LWP LWP::Protocol::https</span>
<a id="__codelineno-2-890" name="__codelineno-2-890" href="#__codelineno-2-890"></a><span class="c1">#</span>
<a id="__codelineno-2-891" name="__codelineno-2-891" href="#__codelineno-2-891"></a><span class="c1"># We recommend setting this set to "2" or "3" as upgrades to csf will be</span>
<a id="__codelineno-2-892" name="__codelineno-2-892" href="#__codelineno-2-892"></a><span class="c1"># performed over SSL as well as other URLs used when retrieving external data</span>
<a id="__codelineno-2-893" name="__codelineno-2-893" href="#__codelineno-2-893"></a><span class="c1">#</span>
<a id="__codelineno-2-894" name="__codelineno-2-894" href="#__codelineno-2-894"></a><span class="c1"># "1" = HTTP::Tiny</span>
<a id="__codelineno-2-895" name="__codelineno-2-895" href="#__codelineno-2-895"></a><span class="c1"># "2" = LWP::UserAgent</span>
<a id="__codelineno-2-896" name="__codelineno-2-896" href="#__codelineno-2-896"></a><span class="c1"># "3" = CURL/WGET (set location at the bottom of csf.conf)</span>
<a id="__codelineno-2-897" name="__codelineno-2-897" href="#__codelineno-2-897"></a><span class="na">URLGET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-2-898" name="__codelineno-2-898" href="#__codelineno-2-898"></a>
<a id="__codelineno-2-899" name="__codelineno-2-899" href="#__codelineno-2-899"></a><span class="c1"># If you need csf/lfd to use a proxy, then you can set this option to the URL</span>
<a id="__codelineno-2-900" name="__codelineno-2-900" href="#__codelineno-2-900"></a><span class="c1"># of the proxy. The proxy provided will be used for both HTTP and HTTPS</span>
<a id="__codelineno-2-901" name="__codelineno-2-901" href="#__codelineno-2-901"></a><span class="c1"># connections</span>
<a id="__codelineno-2-902" name="__codelineno-2-902" href="#__codelineno-2-902"></a><span class="na">URLPROXY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-903" name="__codelineno-2-903" href="#__codelineno-2-903"></a>
<a id="__codelineno-2-904" name="__codelineno-2-904" href="#__codelineno-2-904"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-905" name="__codelineno-2-905" href="#__codelineno-2-905"></a><span class="c1"># SECTION:Country Code Lists and Settings</span>
<a id="__codelineno-2-906" name="__codelineno-2-906" href="#__codelineno-2-906"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-907" name="__codelineno-2-907" href="#__codelineno-2-907"></a><span class="c1"># Country Code to CIDR allow/deny. In the following options you can allow or</span>
<a id="__codelineno-2-908" name="__codelineno-2-908" href="#__codelineno-2-908"></a><span class="c1"># deny whole country CIDR ranges. The CIDR blocks are obtained from a selected</span>
<a id="__codelineno-2-909" name="__codelineno-2-909" href="#__codelineno-2-909"></a><span class="c1"># source below. They also display Country Code Country and City for reported IP</span>
<a id="__codelineno-2-910" name="__codelineno-2-910" href="#__codelineno-2-910"></a><span class="c1"># addresses and lookups</span>
<a id="__codelineno-2-911" name="__codelineno-2-911" href="#__codelineno-2-911"></a><span class="c1">#</span>
<a id="__codelineno-2-912" name="__codelineno-2-912" href="#__codelineno-2-912"></a><span class="c1"># There are a number of sources for these databases, before utilising them you</span>
<a id="__codelineno-2-913" name="__codelineno-2-913" href="#__codelineno-2-913"></a><span class="c1"># need to visit each site and ensure you abide by their license provisions</span>
<a id="__codelineno-2-914" name="__codelineno-2-914" href="#__codelineno-2-914"></a><span class="c1"># where stated:</span>
<a id="__codelineno-2-915" name="__codelineno-2-915" href="#__codelineno-2-915"></a>
<a id="__codelineno-2-916" name="__codelineno-2-916" href="#__codelineno-2-916"></a><span class="c1"># 1. MaxMind</span>
<a id="__codelineno-2-917" name="__codelineno-2-917" href="#__codelineno-2-917"></a><span class="c1">#</span>
<a id="__codelineno-2-918" name="__codelineno-2-918" href="#__codelineno-2-918"></a><span class="c1"># MaxMind GeoLite2 Country/City and ASN databases at:</span>
<a id="__codelineno-2-919" name="__codelineno-2-919" href="#__codelineno-2-919"></a><span class="c1"># https://dev.MaxMind.com/geoip/geoip2/geolite2/</span>
<a id="__codelineno-2-920" name="__codelineno-2-920" href="#__codelineno-2-920"></a><span class="c1"># This feature relies entirely on that service being available</span>
<a id="__codelineno-2-921" name="__codelineno-2-921" href="#__codelineno-2-921"></a><span class="c1">#</span>
<a id="__codelineno-2-922" name="__codelineno-2-922" href="#__codelineno-2-922"></a><span class="c1"># Advantages: This is a one stop shop for all of the databases required for</span>
<a id="__codelineno-2-923" name="__codelineno-2-923" href="#__codelineno-2-923"></a><span class="c1"># these features. They provide a consistent dataset for blocking and reporting</span>
<a id="__codelineno-2-924" name="__codelineno-2-924" href="#__codelineno-2-924"></a><span class="c1"># purposes</span>
<a id="__codelineno-2-925" name="__codelineno-2-925" href="#__codelineno-2-925"></a><span class="c1">#</span>
<a id="__codelineno-2-926" name="__codelineno-2-926" href="#__codelineno-2-926"></a><span class="c1"># Disadvantages: MaxMind require a license key to download their databases.</span>
<a id="__codelineno-2-927" name="__codelineno-2-927" href="#__codelineno-2-927"></a><span class="c1"># This is free of charge, but requires the user to create an account on their</span>
<a id="__codelineno-2-928" name="__codelineno-2-928" href="#__codelineno-2-928"></a><span class="c1"># website to generate the required key:</span>
<a id="__codelineno-2-929" name="__codelineno-2-929" href="#__codelineno-2-929"></a><span class="c1">#</span>
<a id="__codelineno-2-930" name="__codelineno-2-930" href="#__codelineno-2-930"></a><span class="c1"># WARNING: As of 2019-12-29, MaxMind REQUIRES you to create an account on their</span>
<a id="__codelineno-2-931" name="__codelineno-2-931" href="#__codelineno-2-931"></a><span class="c1"># site and to generate a license key to use their databases. See:</span>
<a id="__codelineno-2-932" name="__codelineno-2-932" href="#__codelineno-2-932"></a><span class="c1"># https://www.maxmind.com/en/geolite2/signup</span>
<a id="__codelineno-2-933" name="__codelineno-2-933" href="#__codelineno-2-933"></a><span class="c1"># https://blog.maxmind.com/2019/12/18/significant-changes-to-accessing-and-using-geolite2-databases/</span>
<a id="__codelineno-2-934" name="__codelineno-2-934" href="#__codelineno-2-934"></a><span class="c1"># </span>
<a id="__codelineno-2-935" name="__codelineno-2-935" href="#__codelineno-2-935"></a><span class="c1"># You MUST set the following to continue using the IP lookup features of csf,</span>
<a id="__codelineno-2-936" name="__codelineno-2-936" href="#__codelineno-2-936"></a><span class="c1"># otherwise an error will be generated and the features will not work.</span>
<a id="__codelineno-2-937" name="__codelineno-2-937" href="#__codelineno-2-937"></a><span class="c1"># Alternatively set CC_SRC below to a different provider</span>
<a id="__codelineno-2-938" name="__codelineno-2-938" href="#__codelineno-2-938"></a><span class="c1">#</span>
<a id="__codelineno-2-939" name="__codelineno-2-939" href="#__codelineno-2-939"></a><span class="c1"># MaxMind License Key:</span>
<a id="__codelineno-2-940" name="__codelineno-2-940" href="#__codelineno-2-940"></a><span class="na">MM_LICENSE_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-941" name="__codelineno-2-941" href="#__codelineno-2-941"></a>
<a id="__codelineno-2-942" name="__codelineno-2-942" href="#__codelineno-2-942"></a><span class="c1"># 2. DB-IP, ipdeny.com, iptoasn.com</span>
<a id="__codelineno-2-943" name="__codelineno-2-943" href="#__codelineno-2-943"></a><span class="c1">#</span>
<a id="__codelineno-2-944" name="__codelineno-2-944" href="#__codelineno-2-944"></a><span class="c1"># Advantages: The ipdeny.com databases form CC blocking are better optimised</span>
<a id="__codelineno-2-945" name="__codelineno-2-945" href="#__codelineno-2-945"></a><span class="c1"># and so are quicker to process and create fewer iptables entries. All of these</span>
<a id="__codelineno-2-946" name="__codelineno-2-946" href="#__codelineno-2-946"></a><span class="c1"># databases are free to download without requiring login or key</span>
<a id="__codelineno-2-947" name="__codelineno-2-947" href="#__codelineno-2-947"></a><span class="c1">#</span>
<a id="__codelineno-2-948" name="__codelineno-2-948" href="#__codelineno-2-948"></a><span class="c1"># Disadvantages: Multiple sources mean that any one of the three could</span>
<a id="__codelineno-2-949" name="__codelineno-2-949" href="#__codelineno-2-949"></a><span class="c1"># interrupt the provision of these features. It may also mean that there are</span>
<a id="__codelineno-2-950" name="__codelineno-2-950" href="#__codelineno-2-950"></a><span class="c1"># inconsistences between them</span>
<a id="__codelineno-2-951" name="__codelineno-2-951" href="#__codelineno-2-951"></a><span class="c1">#</span>
<a id="__codelineno-2-952" name="__codelineno-2-952" href="#__codelineno-2-952"></a><span class="c1"># https://db-ip.com/db/lite.php</span>
<a id="__codelineno-2-953" name="__codelineno-2-953" href="#__codelineno-2-953"></a><span class="c1"># http://ipdeny.com/</span>
<a id="__codelineno-2-954" name="__codelineno-2-954" href="#__codelineno-2-954"></a><span class="c1"># https://iptoasn.com/</span>
<a id="__codelineno-2-955" name="__codelineno-2-955" href="#__codelineno-2-955"></a><span class="c1"># http://download.geonames.org/export/dump/readme.txt</span>
<a id="__codelineno-2-956" name="__codelineno-2-956" href="#__codelineno-2-956"></a>
<a id="__codelineno-2-957" name="__codelineno-2-957" href="#__codelineno-2-957"></a><span class="c1"># Set the following to your preferred source:</span>
<a id="__codelineno-2-958" name="__codelineno-2-958" href="#__codelineno-2-958"></a><span class="c1">#</span>
<a id="__codelineno-2-959" name="__codelineno-2-959" href="#__codelineno-2-959"></a><span class="c1"># "1" - MaxMind</span>
<a id="__codelineno-2-960" name="__codelineno-2-960" href="#__codelineno-2-960"></a><span class="c1"># "2" - db-ip, ipdeny, iptoasn</span>
<a id="__codelineno-2-961" name="__codelineno-2-961" href="#__codelineno-2-961"></a><span class="c1">#</span>
<a id="__codelineno-2-962" name="__codelineno-2-962" href="#__codelineno-2-962"></a><span class="c1"># The default is "2" on new installations of csf, or set to "1" to use the</span>
<a id="__codelineno-2-963" name="__codelineno-2-963" href="#__codelineno-2-963"></a><span class="c1"># MaxMind databases after obtaining a license key</span>
<a id="__codelineno-2-964" name="__codelineno-2-964" href="#__codelineno-2-964"></a><span class="na">CC_SRC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-2-965" name="__codelineno-2-965" href="#__codelineno-2-965"></a>
<a id="__codelineno-2-966" name="__codelineno-2-966" href="#__codelineno-2-966"></a><span class="c1"># In the following options, specify the the two-letter ISO Country Code(s).</span>
<a id="__codelineno-2-967" name="__codelineno-2-967" href="#__codelineno-2-967"></a><span class="c1"># The iptables rules are for incoming connections only</span>
<a id="__codelineno-2-968" name="__codelineno-2-968" href="#__codelineno-2-968"></a><span class="c1">#</span>
<a id="__codelineno-2-969" name="__codelineno-2-969" href="#__codelineno-2-969"></a><span class="c1"># Additionally, ASN numbers can also be added to the comma separated lists</span>
<a id="__codelineno-2-970" name="__codelineno-2-970" href="#__codelineno-2-970"></a><span class="c1"># below that also list Country Codes. The same WARNINGS for Country Codes apply</span>
<a id="__codelineno-2-971" name="__codelineno-2-971" href="#__codelineno-2-971"></a><span class="c1"># to the use of ASNs. More about Autonomous System Numbers (ASN):</span>
<a id="__codelineno-2-972" name="__codelineno-2-972" href="#__codelineno-2-972"></a><span class="c1"># http://www.iana.org/assignments/as-numbers/as-numbers.xhtml</span>
<a id="__codelineno-2-973" name="__codelineno-2-973" href="#__codelineno-2-973"></a><span class="c1"># ASNs must be listed as ASnnnn (where nnnn is the ASN number)</span>
<a id="__codelineno-2-974" name="__codelineno-2-974" href="#__codelineno-2-974"></a><span class="c1">#</span>
<a id="__codelineno-2-975" name="__codelineno-2-975" href="#__codelineno-2-975"></a><span class="c1"># You should consider using LF_IPSET when using any of the following options</span>
<a id="__codelineno-2-976" name="__codelineno-2-976" href="#__codelineno-2-976"></a><span class="c1">#</span>
<a id="__codelineno-2-977" name="__codelineno-2-977" href="#__codelineno-2-977"></a><span class="c1"># WARNING: These lists are never 100% accurate and some ISP's (e.g. AOL) use</span>
<a id="__codelineno-2-978" name="__codelineno-2-978" href="#__codelineno-2-978"></a><span class="c1"># non-geographic IP address designations for their clients</span>
<a id="__codelineno-2-979" name="__codelineno-2-979" href="#__codelineno-2-979"></a><span class="c1">#</span>
<a id="__codelineno-2-980" name="__codelineno-2-980" href="#__codelineno-2-980"></a><span class="c1"># WARNING: Some of the CIDR lists are huge and each one requires a rule within</span>
<a id="__codelineno-2-981" name="__codelineno-2-981" href="#__codelineno-2-981"></a><span class="c1"># the incoming iptables chain. This can result in significant performance</span>
<a id="__codelineno-2-982" name="__codelineno-2-982" href="#__codelineno-2-982"></a><span class="c1"># overheads and could render the server inaccessible in some circumstances. For</span>
<a id="__codelineno-2-983" name="__codelineno-2-983" href="#__codelineno-2-983"></a><span class="c1"># this reason (amongst others) we do not recommend using these options</span>
<a id="__codelineno-2-984" name="__codelineno-2-984" href="#__codelineno-2-984"></a><span class="c1">#</span>
<a id="__codelineno-2-985" name="__codelineno-2-985" href="#__codelineno-2-985"></a><span class="c1"># WARNING: Due to the resource constraints on VPS servers this feature should</span>
<a id="__codelineno-2-986" name="__codelineno-2-986" href="#__codelineno-2-986"></a><span class="c1"># not be used on such systems unless you choose very small CC zones</span>
<a id="__codelineno-2-987" name="__codelineno-2-987" href="#__codelineno-2-987"></a><span class="c1">#</span>
<a id="__codelineno-2-988" name="__codelineno-2-988" href="#__codelineno-2-988"></a><span class="c1"># WARNING: CC_ALLOW allows access through all ports in the firewall. For this</span>
<a id="__codelineno-2-989" name="__codelineno-2-989" href="#__codelineno-2-989"></a><span class="c1"># reason CC_ALLOW probably has very limited use and CC_ALLOW_FILTER is</span>
<a id="__codelineno-2-990" name="__codelineno-2-990" href="#__codelineno-2-990"></a><span class="c1"># preferred</span>
<a id="__codelineno-2-991" name="__codelineno-2-991" href="#__codelineno-2-991"></a><span class="c1">#</span>
<a id="__codelineno-2-992" name="__codelineno-2-992" href="#__codelineno-2-992"></a><span class="c1"># Each option is a comma separated list of CC's, e.g. "US,GB,DE"</span>
<a id="__codelineno-2-993" name="__codelineno-2-993" href="#__codelineno-2-993"></a><span class="na">CC_DENY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-994" name="__codelineno-2-994" href="#__codelineno-2-994"></a><span class="na">CC_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-995" name="__codelineno-2-995" href="#__codelineno-2-995"></a>
<a id="__codelineno-2-996" name="__codelineno-2-996" href="#__codelineno-2-996"></a><span class="c1"># An alternative to CC_ALLOW is to only allow access from the following</span>
<a id="__codelineno-2-997" name="__codelineno-2-997" href="#__codelineno-2-997"></a><span class="c1"># countries but still filter based on the port and packets rules. All other</span>
<a id="__codelineno-2-998" name="__codelineno-2-998" href="#__codelineno-2-998"></a><span class="c1"># connections are dropped</span>
<a id="__codelineno-2-999" name="__codelineno-2-999" href="#__codelineno-2-999"></a><span class="na">CC_ALLOW_FILTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1000" name="__codelineno-2-1000" href="#__codelineno-2-1000"></a>
<a id="__codelineno-2-1001" name="__codelineno-2-1001" href="#__codelineno-2-1001"></a><span class="c1"># This option allows access from the following countries to specific ports</span>
<a id="__codelineno-2-1002" name="__codelineno-2-1002" href="#__codelineno-2-1002"></a><span class="c1"># listed in CC_ALLOW_PORTS_TCP and CC_ALLOW_PORTS_UDP</span>
<a id="__codelineno-2-1003" name="__codelineno-2-1003" href="#__codelineno-2-1003"></a><span class="c1">#</span>
<a id="__codelineno-2-1004" name="__codelineno-2-1004" href="#__codelineno-2-1004"></a><span class="c1"># Note: The rules for this feature are inserted after the allow and deny</span>
<a id="__codelineno-2-1005" name="__codelineno-2-1005" href="#__codelineno-2-1005"></a><span class="c1"># rules to still allow blocking of IP addresses</span>
<a id="__codelineno-2-1006" name="__codelineno-2-1006" href="#__codelineno-2-1006"></a><span class="c1">#</span>
<a id="__codelineno-2-1007" name="__codelineno-2-1007" href="#__codelineno-2-1007"></a><span class="c1"># Each option is a comma separated list of CC's, e.g. "US,GB,DE"</span>
<a id="__codelineno-2-1008" name="__codelineno-2-1008" href="#__codelineno-2-1008"></a><span class="na">CC_ALLOW_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1009" name="__codelineno-2-1009" href="#__codelineno-2-1009"></a>
<a id="__codelineno-2-1010" name="__codelineno-2-1010" href="#__codelineno-2-1010"></a><span class="c1"># All listed ports should be removed from TCP_IN/UDP_IN to block access from</span>
<a id="__codelineno-2-1011" name="__codelineno-2-1011" href="#__codelineno-2-1011"></a><span class="c1"># elsewhere. This option uses the same format as TCP_IN/UDP_IN</span>
<a id="__codelineno-2-1012" name="__codelineno-2-1012" href="#__codelineno-2-1012"></a><span class="c1">#</span>
<a id="__codelineno-2-1013" name="__codelineno-2-1013" href="#__codelineno-2-1013"></a><span class="c1"># An example would be to list port 21 here and remove it from TCP_IN/UDP_IN</span>
<a id="__codelineno-2-1014" name="__codelineno-2-1014" href="#__codelineno-2-1014"></a><span class="c1"># then only countries listed in CC_ALLOW_PORTS can access FTP</span>
<a id="__codelineno-2-1015" name="__codelineno-2-1015" href="#__codelineno-2-1015"></a><span class="na">CC_ALLOW_PORTS_TCP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1016" name="__codelineno-2-1016" href="#__codelineno-2-1016"></a><span class="na">CC_ALLOW_PORTS_UDP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1017" name="__codelineno-2-1017" href="#__codelineno-2-1017"></a>
<a id="__codelineno-2-1018" name="__codelineno-2-1018" href="#__codelineno-2-1018"></a><span class="c1"># This option denies access from the following countries to specific ports</span>
<a id="__codelineno-2-1019" name="__codelineno-2-1019" href="#__codelineno-2-1019"></a><span class="c1"># listed in CC_DENY_PORTS_TCP and CC_DENY_PORTS_UDP</span>
<a id="__codelineno-2-1020" name="__codelineno-2-1020" href="#__codelineno-2-1020"></a><span class="c1">#</span>
<a id="__codelineno-2-1021" name="__codelineno-2-1021" href="#__codelineno-2-1021"></a><span class="c1"># Note: The rules for this feature are inserted after the allow and deny</span>
<a id="__codelineno-2-1022" name="__codelineno-2-1022" href="#__codelineno-2-1022"></a><span class="c1"># rules to still allow allowing of IP addresses</span>
<a id="__codelineno-2-1023" name="__codelineno-2-1023" href="#__codelineno-2-1023"></a><span class="c1">#</span>
<a id="__codelineno-2-1024" name="__codelineno-2-1024" href="#__codelineno-2-1024"></a><span class="c1"># Each option is a comma separated list of CC's, e.g. "US,GB,DE"</span>
<a id="__codelineno-2-1025" name="__codelineno-2-1025" href="#__codelineno-2-1025"></a><span class="na">CC_DENY_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1026" name="__codelineno-2-1026" href="#__codelineno-2-1026"></a>
<a id="__codelineno-2-1027" name="__codelineno-2-1027" href="#__codelineno-2-1027"></a><span class="c1"># This option uses the same format as TCP_IN/UDP_IN. The ports listed should</span>
<a id="__codelineno-2-1028" name="__codelineno-2-1028" href="#__codelineno-2-1028"></a><span class="c1"># NOT be removed from TCP_IN/UDP_IN</span>
<a id="__codelineno-2-1029" name="__codelineno-2-1029" href="#__codelineno-2-1029"></a><span class="c1">#</span>
<a id="__codelineno-2-1030" name="__codelineno-2-1030" href="#__codelineno-2-1030"></a><span class="c1"># An example would be to list port 21 here then countries listed in</span>
<a id="__codelineno-2-1031" name="__codelineno-2-1031" href="#__codelineno-2-1031"></a><span class="c1"># CC_DENY_PORTS cannot access FTP</span>
<a id="__codelineno-2-1032" name="__codelineno-2-1032" href="#__codelineno-2-1032"></a><span class="na">CC_DENY_PORTS_TCP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1033" name="__codelineno-2-1033" href="#__codelineno-2-1033"></a><span class="na">CC_DENY_PORTS_UDP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1034" name="__codelineno-2-1034" href="#__codelineno-2-1034"></a>
<a id="__codelineno-2-1035" name="__codelineno-2-1035" href="#__codelineno-2-1035"></a><span class="c1"># This Country Code list will prevent lfd from blocking IP address hits for the</span>
<a id="__codelineno-2-1036" name="__codelineno-2-1036" href="#__codelineno-2-1036"></a><span class="c1"># listed CC's</span>
<a id="__codelineno-2-1037" name="__codelineno-2-1037" href="#__codelineno-2-1037"></a><span class="c1">#</span>
<a id="__codelineno-2-1038" name="__codelineno-2-1038" href="#__codelineno-2-1038"></a><span class="c1"># CC_LOOKUPS must be enabled to use this option</span>
<a id="__codelineno-2-1039" name="__codelineno-2-1039" href="#__codelineno-2-1039"></a><span class="na">CC_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1040" name="__codelineno-2-1040" href="#__codelineno-2-1040"></a>
<a id="__codelineno-2-1041" name="__codelineno-2-1041" href="#__codelineno-2-1041"></a><span class="c1"># This Country Code list will only allow SMTP AUTH to be advertised to the</span>
<a id="__codelineno-2-1042" name="__codelineno-2-1042" href="#__codelineno-2-1042"></a><span class="c1"># listed countries in EXIM. This is to help limit attempts at distributed</span>
<a id="__codelineno-2-1043" name="__codelineno-2-1043" href="#__codelineno-2-1043"></a><span class="c1"># attacks against SMTP AUTH which are difficult to achive since port 25 needs</span>
<a id="__codelineno-2-1044" name="__codelineno-2-1044" href="#__codelineno-2-1044"></a><span class="c1"># to be open to relay email</span>
<a id="__codelineno-2-1045" name="__codelineno-2-1045" href="#__codelineno-2-1045"></a><span class="c1">#</span>
<a id="__codelineno-2-1046" name="__codelineno-2-1046" href="#__codelineno-2-1046"></a><span class="c1"># The reason why this works is that if EXIM does not advertise SMTP AUTH on a</span>
<a id="__codelineno-2-1047" name="__codelineno-2-1047" href="#__codelineno-2-1047"></a><span class="c1"># connection, then SMTP AUTH will not accept logins, defeating the attacks</span>
<a id="__codelineno-2-1048" name="__codelineno-2-1048" href="#__codelineno-2-1048"></a><span class="c1"># without restricting mail relaying</span>
<a id="__codelineno-2-1049" name="__codelineno-2-1049" href="#__codelineno-2-1049"></a><span class="c1">#</span>
<a id="__codelineno-2-1050" name="__codelineno-2-1050" href="#__codelineno-2-1050"></a><span class="c1"># This option can generate a very large list of IP addresses that could easily</span>
<a id="__codelineno-2-1051" name="__codelineno-2-1051" href="#__codelineno-2-1051"></a><span class="c1"># severely impact on SMTP (mail) performance, so care must be taken when</span>
<a id="__codelineno-2-1052" name="__codelineno-2-1052" href="#__codelineno-2-1052"></a><span class="c1"># selecting countries and if performance issues ensue</span>
<a id="__codelineno-2-1053" name="__codelineno-2-1053" href="#__codelineno-2-1053"></a><span class="c1">#</span>
<a id="__codelineno-2-1054" name="__codelineno-2-1054" href="#__codelineno-2-1054"></a><span class="c1"># The option SMTPAUTH_RESTRICT must be enabled to use this option</span>
<a id="__codelineno-2-1055" name="__codelineno-2-1055" href="#__codelineno-2-1055"></a><span class="na">CC_ALLOW_SMTPAUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1056" name="__codelineno-2-1056" href="#__codelineno-2-1056"></a>
<a id="__codelineno-2-1057" name="__codelineno-2-1057" href="#__codelineno-2-1057"></a><span class="c1"># These options can control which IP blocks are redirected to the MESSENGER</span>
<a id="__codelineno-2-1058" name="__codelineno-2-1058" href="#__codelineno-2-1058"></a><span class="c1"># service, if it is enabled</span>
<a id="__codelineno-2-1059" name="__codelineno-2-1059" href="#__codelineno-2-1059"></a><span class="c1">#</span>
<a id="__codelineno-2-1060" name="__codelineno-2-1060" href="#__codelineno-2-1060"></a><span class="c1"># If Country Codes are listed in CC_MESSENGER_ALLOW, then only a blocked IP</span>
<a id="__codelineno-2-1061" name="__codelineno-2-1061" href="#__codelineno-2-1061"></a><span class="c1"># that resolves to one of those Country Codes will be redirected to the</span>
<a id="__codelineno-2-1062" name="__codelineno-2-1062" href="#__codelineno-2-1062"></a><span class="c1"># MESSENGER service</span>
<a id="__codelineno-2-1063" name="__codelineno-2-1063" href="#__codelineno-2-1063"></a><span class="c1">#</span>
<a id="__codelineno-2-1064" name="__codelineno-2-1064" href="#__codelineno-2-1064"></a><span class="c1"># If Country Codes are listed in CC_MESSENGER_DENY, then a blocked IP that</span>
<a id="__codelineno-2-1065" name="__codelineno-2-1065" href="#__codelineno-2-1065"></a><span class="c1"># resolves to one of those Country Codes will NOT be redirected to the</span>
<a id="__codelineno-2-1066" name="__codelineno-2-1066" href="#__codelineno-2-1066"></a><span class="c1"># MESSENGER service</span>
<a id="__codelineno-2-1067" name="__codelineno-2-1067" href="#__codelineno-2-1067"></a><span class="c1">#</span>
<a id="__codelineno-2-1068" name="__codelineno-2-1068" href="#__codelineno-2-1068"></a><span class="na">CC_MESSENGER_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1069" name="__codelineno-2-1069" href="#__codelineno-2-1069"></a><span class="na">CC_MESSENGER_DENY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1070" name="__codelineno-2-1070" href="#__codelineno-2-1070"></a>
<a id="__codelineno-2-1071" name="__codelineno-2-1071" href="#__codelineno-2-1071"></a><span class="c1"># Set this option to a valid CIDR (i.e. 1 to 32) to ignore CIDR blocks smaller</span>
<a id="__codelineno-2-1072" name="__codelineno-2-1072" href="#__codelineno-2-1072"></a><span class="c1"># than this value when implementing CC_DENY/CC_ALLOW/CC_ALLOW_FILTER. This can</span>
<a id="__codelineno-2-1073" name="__codelineno-2-1073" href="#__codelineno-2-1073"></a><span class="c1"># help reduce the number of CC entries and may improve iptables throughput.</span>
<a id="__codelineno-2-1074" name="__codelineno-2-1074" href="#__codelineno-2-1074"></a><span class="c1"># Obviously, this will deny/allow fewer IP addresses depending on how small you</span>
<a id="__codelineno-2-1075" name="__codelineno-2-1075" href="#__codelineno-2-1075"></a><span class="c1"># configure the option</span>
<a id="__codelineno-2-1076" name="__codelineno-2-1076" href="#__codelineno-2-1076"></a><span class="c1">#</span>
<a id="__codelineno-2-1077" name="__codelineno-2-1077" href="#__codelineno-2-1077"></a><span class="c1"># For example, to ignore all CIDR (and single IP) entries small than a /16, set</span>
<a id="__codelineno-2-1078" name="__codelineno-2-1078" href="#__codelineno-2-1078"></a><span class="c1"># this option to "16". Set to "" to block all CC IP addresses</span>
<a id="__codelineno-2-1079" name="__codelineno-2-1079" href="#__codelineno-2-1079"></a><span class="na">CC_DROP_CIDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1080" name="__codelineno-2-1080" href="#__codelineno-2-1080"></a>
<a id="__codelineno-2-1081" name="__codelineno-2-1081" href="#__codelineno-2-1081"></a><span class="c1"># Display Country Code and Country for reported IP addresses. This option can</span>
<a id="__codelineno-2-1082" name="__codelineno-2-1082" href="#__codelineno-2-1082"></a><span class="c1"># be configured to use the databases enabled at the top of this section. An</span>
<a id="__codelineno-2-1083" name="__codelineno-2-1083" href="#__codelineno-2-1083"></a><span class="c1"># additional option is also available if you cannot use those databases:</span>
<a id="__codelineno-2-1084" name="__codelineno-2-1084" href="#__codelineno-2-1084"></a><span class="c1">#</span>
<a id="__codelineno-2-1085" name="__codelineno-2-1085" href="#__codelineno-2-1085"></a><span class="c1"># "0" - disable</span>
<a id="__codelineno-2-1086" name="__codelineno-2-1086" href="#__codelineno-2-1086"></a><span class="c1"># "1" - Reports: Country Code and Country</span>
<a id="__codelineno-2-1087" name="__codelineno-2-1087" href="#__codelineno-2-1087"></a><span class="c1"># "2" - Reports: Country Code and Country and Region and City</span>
<a id="__codelineno-2-1088" name="__codelineno-2-1088" href="#__codelineno-2-1088"></a><span class="c1"># "3" - Reports: Country Code and Country and Region and City and ASN</span>
<a id="__codelineno-2-1089" name="__codelineno-2-1089" href="#__codelineno-2-1089"></a><span class="c1"># "4" - Reports: Country Code and Country and Region and City (db-ip.com)</span>
<a id="__codelineno-2-1090" name="__codelineno-2-1090" href="#__codelineno-2-1090"></a><span class="c1">#</span>
<a id="__codelineno-2-1091" name="__codelineno-2-1091" href="#__codelineno-2-1091"></a><span class="c1"># Note: "4" does not use the databases enabled at the top of this section</span>
<a id="__codelineno-2-1092" name="__codelineno-2-1092" href="#__codelineno-2-1092"></a><span class="c1"># directly for lookups. Instead it uses a URL-based lookup from</span>
<a id="__codelineno-2-1093" name="__codelineno-2-1093" href="#__codelineno-2-1093"></a><span class="c1"># https://db-ip.com and so avoids having to download and process the large</span>
<a id="__codelineno-2-1094" name="__codelineno-2-1094" href="#__codelineno-2-1094"></a><span class="c1"># databases. Please visit the https://db-ip.com and read their limitations and</span>
<a id="__codelineno-2-1095" name="__codelineno-2-1095" href="#__codelineno-2-1095"></a><span class="c1"># understand that this option will either cease to function or be removed by us</span>
<a id="__codelineno-2-1096" name="__codelineno-2-1096" href="#__codelineno-2-1096"></a><span class="c1"># if that site is abused or overloaded. ONLY use this option if you have</span>
<a id="__codelineno-2-1097" name="__codelineno-2-1097" href="#__codelineno-2-1097"></a><span class="c1"># difficulties using the databases enabled at the top of this section. This</span>
<a id="__codelineno-2-1098" name="__codelineno-2-1098" href="#__codelineno-2-1098"></a><span class="c1"># option is ONLY for IP lookups, NOT when using the CC_* options above, which</span>
<a id="__codelineno-2-1099" name="__codelineno-2-1099" href="#__codelineno-2-1099"></a><span class="c1"># will continue to use the databases enabled at the top of this section</span>
<a id="__codelineno-2-1100" name="__codelineno-2-1100" href="#__codelineno-2-1100"></a><span class="c1">#</span>
<a id="__codelineno-2-1101" name="__codelineno-2-1101" href="#__codelineno-2-1101"></a><span class="na">CC_LOOKUPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1102" name="__codelineno-2-1102" href="#__codelineno-2-1102"></a>
<a id="__codelineno-2-1103" name="__codelineno-2-1103" href="#__codelineno-2-1103"></a><span class="c1"># Display Country Code and Country for reported IPv6 addresses using the</span>
<a id="__codelineno-2-1104" name="__codelineno-2-1104" href="#__codelineno-2-1104"></a><span class="c1"># databases enabled at the top of this section</span>
<a id="__codelineno-2-1105" name="__codelineno-2-1105" href="#__codelineno-2-1105"></a><span class="c1">#</span>
<a id="__codelineno-2-1106" name="__codelineno-2-1106" href="#__codelineno-2-1106"></a><span class="c1"># "0" - disable</span>
<a id="__codelineno-2-1107" name="__codelineno-2-1107" href="#__codelineno-2-1107"></a><span class="c1"># "1" - enable and report the detail level as specified in CC_LOOKUPS</span>
<a id="__codelineno-2-1108" name="__codelineno-2-1108" href="#__codelineno-2-1108"></a><span class="c1">#</span>
<a id="__codelineno-2-1109" name="__codelineno-2-1109" href="#__codelineno-2-1109"></a><span class="c1"># This option must also be enabled to allow IPv6 support to CC_*, MESSENGER and</span>
<a id="__codelineno-2-1110" name="__codelineno-2-1110" href="#__codelineno-2-1110"></a><span class="c1"># PORTFLOOD</span>
<a id="__codelineno-2-1111" name="__codelineno-2-1111" href="#__codelineno-2-1111"></a><span class="na">CC6_LOOKUPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1112" name="__codelineno-2-1112" href="#__codelineno-2-1112"></a>
<a id="__codelineno-2-1113" name="__codelineno-2-1113" href="#__codelineno-2-1113"></a><span class="c1"># This option tells lfd how often to retrieve the databases for CC_ALLOW,</span>
<a id="__codelineno-2-1114" name="__codelineno-2-1114" href="#__codelineno-2-1114"></a><span class="c1"># CC_ALLOW_FILTER, CC_DENY, CC_IGNORE and CC_LOOKUPS (in days)</span>
<a id="__codelineno-2-1115" name="__codelineno-2-1115" href="#__codelineno-2-1115"></a><span class="na">CC_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"14"</span>
<a id="__codelineno-2-1116" name="__codelineno-2-1116" href="#__codelineno-2-1116"></a>
<a id="__codelineno-2-1117" name="__codelineno-2-1117" href="#__codelineno-2-1117"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1118" name="__codelineno-2-1118" href="#__codelineno-2-1118"></a><span class="c1"># SECTION:Login Failure Blocking and Alerts</span>
<a id="__codelineno-2-1119" name="__codelineno-2-1119" href="#__codelineno-2-1119"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1120" name="__codelineno-2-1120" href="#__codelineno-2-1120"></a><span class="c1"># The following[*] triggers are application specific. If you set LF_TRIGGER to</span>
<a id="__codelineno-2-1121" name="__codelineno-2-1121" href="#__codelineno-2-1121"></a><span class="c1"># "0" the value of each trigger is the number of failures against that</span>
<a id="__codelineno-2-1122" name="__codelineno-2-1122" href="#__codelineno-2-1122"></a><span class="c1"># application that will trigger lfd to block the IP address</span>
<a id="__codelineno-2-1123" name="__codelineno-2-1123" href="#__codelineno-2-1123"></a><span class="c1">#</span>
<a id="__codelineno-2-1124" name="__codelineno-2-1124" href="#__codelineno-2-1124"></a><span class="c1"># If you set LF_TRIGGER to a value greater than "0" then the following[*]</span>
<a id="__codelineno-2-1125" name="__codelineno-2-1125" href="#__codelineno-2-1125"></a><span class="c1"># application triggers are simply on or off ("0" or "1") and the value of</span>
<a id="__codelineno-2-1126" name="__codelineno-2-1126" href="#__codelineno-2-1126"></a><span class="c1"># LF_TRIGGER is the total cumulative number of failures that will trigger lfd</span>
<a id="__codelineno-2-1127" name="__codelineno-2-1127" href="#__codelineno-2-1127"></a><span class="c1"># to block the IP address</span>
<a id="__codelineno-2-1128" name="__codelineno-2-1128" href="#__codelineno-2-1128"></a><span class="c1">#</span>
<a id="__codelineno-2-1129" name="__codelineno-2-1129" href="#__codelineno-2-1129"></a><span class="c1"># Setting the application trigger to "0" disables it</span>
<a id="__codelineno-2-1130" name="__codelineno-2-1130" href="#__codelineno-2-1130"></a><span class="na">LF_TRIGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1131" name="__codelineno-2-1131" href="#__codelineno-2-1131"></a>
<a id="__codelineno-2-1132" name="__codelineno-2-1132" href="#__codelineno-2-1132"></a><span class="c1"># If LF_TRIGGER is &gt; "0" then LF_TRIGGER_PERM can be set to "1" to permanently</span>
<a id="__codelineno-2-1133" name="__codelineno-2-1133" href="#__codelineno-2-1133"></a><span class="c1"># block the IP address, or LF_TRIGGER_PERM can be set to a value greater than</span>
<a id="__codelineno-2-1134" name="__codelineno-2-1134" href="#__codelineno-2-1134"></a><span class="c1"># "1" and the IP address will be blocked temporarily for that value in seconds.</span>
<a id="__codelineno-2-1135" name="__codelineno-2-1135" href="#__codelineno-2-1135"></a><span class="c1"># For example:</span>
<a id="__codelineno-2-1136" name="__codelineno-2-1136" href="#__codelineno-2-1136"></a><span class="c1"># LF_TRIGGER_PERM = "1" =&gt; the IP is blocked permanently</span>
<a id="__codelineno-2-1137" name="__codelineno-2-1137" href="#__codelineno-2-1137"></a><span class="c1"># LF_TRIGGER_PERM = "3600" =&gt; the IP is blocked temporarily for 1 hour</span>
<a id="__codelineno-2-1138" name="__codelineno-2-1138" href="#__codelineno-2-1138"></a><span class="c1">#</span>
<a id="__codelineno-2-1139" name="__codelineno-2-1139" href="#__codelineno-2-1139"></a><span class="c1"># If LF_TRIGGER is "0", then the application LF_[application]_PERM value works</span>
<a id="__codelineno-2-1140" name="__codelineno-2-1140" href="#__codelineno-2-1140"></a><span class="c1"># in the same way as above and LF_TRIGGER_PERM serves no function</span>
<a id="__codelineno-2-1141" name="__codelineno-2-1141" href="#__codelineno-2-1141"></a><span class="na">LF_TRIGGER_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1142" name="__codelineno-2-1142" href="#__codelineno-2-1142"></a>
<a id="__codelineno-2-1143" name="__codelineno-2-1143" href="#__codelineno-2-1143"></a><span class="c1"># To only block access to the failed application instead of a complete block</span>
<a id="__codelineno-2-1144" name="__codelineno-2-1144" href="#__codelineno-2-1144"></a><span class="c1"># for an ip address, you can set the following to "1", but LF_TRIGGER must be</span>
<a id="__codelineno-2-1145" name="__codelineno-2-1145" href="#__codelineno-2-1145"></a><span class="c1"># set to "0" with specific application[*] trigger levels also set appropriately</span>
<a id="__codelineno-2-1146" name="__codelineno-2-1146" href="#__codelineno-2-1146"></a><span class="c1">#</span>
<a id="__codelineno-2-1147" name="__codelineno-2-1147" href="#__codelineno-2-1147"></a><span class="c1"># The ports that are blocked can be configured by changing the PORTS_* options</span>
<a id="__codelineno-2-1148" name="__codelineno-2-1148" href="#__codelineno-2-1148"></a><span class="na">LF_SELECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1149" name="__codelineno-2-1149" href="#__codelineno-2-1149"></a>
<a id="__codelineno-2-1150" name="__codelineno-2-1150" href="#__codelineno-2-1150"></a><span class="c1"># Send an email alert if an IP address is blocked by one of the [*] triggers</span>
<a id="__codelineno-2-1151" name="__codelineno-2-1151" href="#__codelineno-2-1151"></a><span class="na">LF_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1152" name="__codelineno-2-1152" href="#__codelineno-2-1152"></a>
<a id="__codelineno-2-1153" name="__codelineno-2-1153" href="#__codelineno-2-1153"></a><span class="c1"># Send an email alert if an IP address is only temporarily blocked by one of</span>
<a id="__codelineno-2-1154" name="__codelineno-2-1154" href="#__codelineno-2-1154"></a><span class="c1"># the [*] triggers</span>
<a id="__codelineno-2-1155" name="__codelineno-2-1155" href="#__codelineno-2-1155"></a><span class="c1">#</span>
<a id="__codelineno-2-1156" name="__codelineno-2-1156" href="#__codelineno-2-1156"></a><span class="c1"># Note: LF_EMAIL_ALERT must still be enabled to get permanent block emails</span>
<a id="__codelineno-2-1157" name="__codelineno-2-1157" href="#__codelineno-2-1157"></a><span class="na">LF_TEMP_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1158" name="__codelineno-2-1158" href="#__codelineno-2-1158"></a>
<a id="__codelineno-2-1159" name="__codelineno-2-1159" href="#__codelineno-2-1159"></a><span class="c1"># [*]Enable login failure detection of sshd connections</span>
<a id="__codelineno-2-1160" name="__codelineno-2-1160" href="#__codelineno-2-1160"></a><span class="c1">#</span>
<a id="__codelineno-2-1161" name="__codelineno-2-1161" href="#__codelineno-2-1161"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1162" name="__codelineno-2-1162" href="#__codelineno-2-1162"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1163" name="__codelineno-2-1163" href="#__codelineno-2-1163"></a><span class="na">LF_SSHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-1164" name="__codelineno-2-1164" href="#__codelineno-2-1164"></a><span class="na">LF_SSHD_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1165" name="__codelineno-2-1165" href="#__codelineno-2-1165"></a>
<a id="__codelineno-2-1166" name="__codelineno-2-1166" href="#__codelineno-2-1166"></a><span class="c1"># [*]Enable login failure detection of ftp connections</span>
<a id="__codelineno-2-1167" name="__codelineno-2-1167" href="#__codelineno-2-1167"></a><span class="c1">#</span>
<a id="__codelineno-2-1168" name="__codelineno-2-1168" href="#__codelineno-2-1168"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1169" name="__codelineno-2-1169" href="#__codelineno-2-1169"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1170" name="__codelineno-2-1170" href="#__codelineno-2-1170"></a><span class="na">LF_FTPD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-2-1171" name="__codelineno-2-1171" href="#__codelineno-2-1171"></a><span class="na">LF_FTPD_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1172" name="__codelineno-2-1172" href="#__codelineno-2-1172"></a>
<a id="__codelineno-2-1173" name="__codelineno-2-1173" href="#__codelineno-2-1173"></a><span class="c1"># [*]Enable login failure detection of SMTP AUTH connections</span>
<a id="__codelineno-2-1174" name="__codelineno-2-1174" href="#__codelineno-2-1174"></a><span class="na">LF_SMTPAUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-1175" name="__codelineno-2-1175" href="#__codelineno-2-1175"></a><span class="na">LF_SMTPAUTH_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1176" name="__codelineno-2-1176" href="#__codelineno-2-1176"></a>
<a id="__codelineno-2-1177" name="__codelineno-2-1177" href="#__codelineno-2-1177"></a><span class="c1"># [*]Enable syntax failure detection of Exim connections</span>
<a id="__codelineno-2-1178" name="__codelineno-2-1178" href="#__codelineno-2-1178"></a><span class="na">LF_EXIMSYNTAX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-2-1179" name="__codelineno-2-1179" href="#__codelineno-2-1179"></a><span class="na">LF_EXIMSYNTAX_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1180" name="__codelineno-2-1180" href="#__codelineno-2-1180"></a>
<a id="__codelineno-2-1181" name="__codelineno-2-1181" href="#__codelineno-2-1181"></a><span class="c1"># [*]Enable login failure detection of pop3 connections</span>
<a id="__codelineno-2-1182" name="__codelineno-2-1182" href="#__codelineno-2-1182"></a><span class="c1">#</span>
<a id="__codelineno-2-1183" name="__codelineno-2-1183" href="#__codelineno-2-1183"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1184" name="__codelineno-2-1184" href="#__codelineno-2-1184"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1185" name="__codelineno-2-1185" href="#__codelineno-2-1185"></a><span class="na">LF_POP3D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1186" name="__codelineno-2-1186" href="#__codelineno-2-1186"></a><span class="na">LF_POP3D_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1187" name="__codelineno-2-1187" href="#__codelineno-2-1187"></a>
<a id="__codelineno-2-1188" name="__codelineno-2-1188" href="#__codelineno-2-1188"></a><span class="c1"># [*]Enable login failure detection of imap connections</span>
<a id="__codelineno-2-1189" name="__codelineno-2-1189" href="#__codelineno-2-1189"></a><span class="c1">#</span>
<a id="__codelineno-2-1190" name="__codelineno-2-1190" href="#__codelineno-2-1190"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1191" name="__codelineno-2-1191" href="#__codelineno-2-1191"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1192" name="__codelineno-2-1192" href="#__codelineno-2-1192"></a><span class="na">LF_IMAPD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1193" name="__codelineno-2-1193" href="#__codelineno-2-1193"></a><span class="na">LF_IMAPD_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1194" name="__codelineno-2-1194" href="#__codelineno-2-1194"></a>
<a id="__codelineno-2-1195" name="__codelineno-2-1195" href="#__codelineno-2-1195"></a><span class="c1"># [*]Enable login failure detection of Apache .htpasswd connections</span>
<a id="__codelineno-2-1196" name="__codelineno-2-1196" href="#__codelineno-2-1196"></a><span class="c1"># Due to the often high logging rate in the Apache error log, you might want to</span>
<a id="__codelineno-2-1197" name="__codelineno-2-1197" href="#__codelineno-2-1197"></a><span class="c1"># enable this option only if you know you are suffering from attacks against</span>
<a id="__codelineno-2-1198" name="__codelineno-2-1198" href="#__codelineno-2-1198"></a><span class="c1"># password protected directories</span>
<a id="__codelineno-2-1199" name="__codelineno-2-1199" href="#__codelineno-2-1199"></a><span class="na">LF_HTACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-1200" name="__codelineno-2-1200" href="#__codelineno-2-1200"></a><span class="na">LF_HTACCESS_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1201" name="__codelineno-2-1201" href="#__codelineno-2-1201"></a>
<a id="__codelineno-2-1202" name="__codelineno-2-1202" href="#__codelineno-2-1202"></a><span class="c1"># [*]Enable failure detection of repeated Apache mod_security rule triggers</span>
<a id="__codelineno-2-1203" name="__codelineno-2-1203" href="#__codelineno-2-1203"></a><span class="na">LF_MODSEC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-1204" name="__codelineno-2-1204" href="#__codelineno-2-1204"></a><span class="na">LF_MODSEC_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1205" name="__codelineno-2-1205" href="#__codelineno-2-1205"></a>
<a id="__codelineno-2-1206" name="__codelineno-2-1206" href="#__codelineno-2-1206"></a><span class="c1"># [*]Enable detection of repeated BIND denied requests</span>
<a id="__codelineno-2-1207" name="__codelineno-2-1207" href="#__codelineno-2-1207"></a><span class="c1"># This option should be enabled with care as it will prevent blocked IPs from</span>
<a id="__codelineno-2-1208" name="__codelineno-2-1208" href="#__codelineno-2-1208"></a><span class="c1"># resolving any domains on the server. You might want to set the trigger value</span>
<a id="__codelineno-2-1209" name="__codelineno-2-1209" href="#__codelineno-2-1209"></a><span class="c1"># reasonably high to avoid this</span>
<a id="__codelineno-2-1210" name="__codelineno-2-1210" href="#__codelineno-2-1210"></a><span class="c1"># Example: LF_BIND = "100"</span>
<a id="__codelineno-2-1211" name="__codelineno-2-1211" href="#__codelineno-2-1211"></a><span class="na">LF_BIND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1212" name="__codelineno-2-1212" href="#__codelineno-2-1212"></a><span class="na">LF_BIND_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1213" name="__codelineno-2-1213" href="#__codelineno-2-1213"></a>
<a id="__codelineno-2-1214" name="__codelineno-2-1214" href="#__codelineno-2-1214"></a><span class="c1"># [*]Enable detection of repeated suhosin ALERTs</span>
<a id="__codelineno-2-1215" name="__codelineno-2-1215" href="#__codelineno-2-1215"></a><span class="c1"># Example: LF_SUHOSIN = "5"</span>
<a id="__codelineno-2-1216" name="__codelineno-2-1216" href="#__codelineno-2-1216"></a><span class="c1">#</span>
<a id="__codelineno-2-1217" name="__codelineno-2-1217" href="#__codelineno-2-1217"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1218" name="__codelineno-2-1218" href="#__codelineno-2-1218"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1219" name="__codelineno-2-1219" href="#__codelineno-2-1219"></a><span class="na">LF_SUHOSIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1220" name="__codelineno-2-1220" href="#__codelineno-2-1220"></a><span class="na">LF_SUHOSIN_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1221" name="__codelineno-2-1221" href="#__codelineno-2-1221"></a>
<a id="__codelineno-2-1222" name="__codelineno-2-1222" href="#__codelineno-2-1222"></a><span class="c1"># [*]Enable detection of repeated cxs ModSecurity mod_security rule triggers</span>
<a id="__codelineno-2-1223" name="__codelineno-2-1223" href="#__codelineno-2-1223"></a><span class="c1"># This option will block IP addresses if cxs detects a hits from the</span>
<a id="__codelineno-2-1224" name="__codelineno-2-1224" href="#__codelineno-2-1224"></a><span class="c1"># ModSecurity rule associated with it</span>
<a id="__codelineno-2-1225" name="__codelineno-2-1225" href="#__codelineno-2-1225"></a><span class="c1">#</span>
<a id="__codelineno-2-1226" name="__codelineno-2-1226" href="#__codelineno-2-1226"></a><span class="c1"># Note: This option takes precedence over LF_MODSEC and removes any hits</span>
<a id="__codelineno-2-1227" name="__codelineno-2-1227" href="#__codelineno-2-1227"></a><span class="c1"># counted towards LF_MODSEC for the cxs rule</span>
<a id="__codelineno-2-1228" name="__codelineno-2-1228" href="#__codelineno-2-1228"></a><span class="c1">#</span>
<a id="__codelineno-2-1229" name="__codelineno-2-1229" href="#__codelineno-2-1229"></a><span class="c1"># This setting should probably set very low, perhaps to 1, if you want to</span>
<a id="__codelineno-2-1230" name="__codelineno-2-1230" href="#__codelineno-2-1230"></a><span class="c1"># effectively block IP addresses for this trigger option</span>
<a id="__codelineno-2-1231" name="__codelineno-2-1231" href="#__codelineno-2-1231"></a><span class="na">LF_CXS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1232" name="__codelineno-2-1232" href="#__codelineno-2-1232"></a><span class="na">LF_CXS_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1233" name="__codelineno-2-1233" href="#__codelineno-2-1233"></a>
<a id="__codelineno-2-1234" name="__codelineno-2-1234" href="#__codelineno-2-1234"></a><span class="c1"># [*]Enable detection of repeated Apache mod_qos rule triggers</span>
<a id="__codelineno-2-1235" name="__codelineno-2-1235" href="#__codelineno-2-1235"></a><span class="na">LF_QOS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1236" name="__codelineno-2-1236" href="#__codelineno-2-1236"></a><span class="na">LF_QOS_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1237" name="__codelineno-2-1237" href="#__codelineno-2-1237"></a>
<a id="__codelineno-2-1238" name="__codelineno-2-1238" href="#__codelineno-2-1238"></a><span class="c1"># [*]Enable detection of repeated Apache symlink race condition triggers from</span>
<a id="__codelineno-2-1239" name="__codelineno-2-1239" href="#__codelineno-2-1239"></a><span class="c1"># the Apache patch provided by:</span>
<a id="__codelineno-2-1240" name="__codelineno-2-1240" href="#__codelineno-2-1240"></a><span class="c1"># http://www.mail-archive.com/dev@httpd.apache.org/msg55666.html</span>
<a id="__codelineno-2-1241" name="__codelineno-2-1241" href="#__codelineno-2-1241"></a><span class="c1"># This patch has also been included by cPanel via the easyapache option:</span>
<a id="__codelineno-2-1242" name="__codelineno-2-1242" href="#__codelineno-2-1242"></a><span class="c1"># "Symlink Race Condition Protection"</span>
<a id="__codelineno-2-1243" name="__codelineno-2-1243" href="#__codelineno-2-1243"></a><span class="na">LF_SYMLINK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1244" name="__codelineno-2-1244" href="#__codelineno-2-1244"></a><span class="na">LF_SYMLINK_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1245" name="__codelineno-2-1245" href="#__codelineno-2-1245"></a>
<a id="__codelineno-2-1246" name="__codelineno-2-1246" href="#__codelineno-2-1246"></a><span class="c1"># [*]Enable login failure detection of webmin connections</span>
<a id="__codelineno-2-1247" name="__codelineno-2-1247" href="#__codelineno-2-1247"></a><span class="c1">#</span>
<a id="__codelineno-2-1248" name="__codelineno-2-1248" href="#__codelineno-2-1248"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1249" name="__codelineno-2-1249" href="#__codelineno-2-1249"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1250" name="__codelineno-2-1250" href="#__codelineno-2-1250"></a><span class="na">LF_WEBMIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1251" name="__codelineno-2-1251" href="#__codelineno-2-1251"></a><span class="na">LF_WEBMIN_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1252" name="__codelineno-2-1252" href="#__codelineno-2-1252"></a>
<a id="__codelineno-2-1253" name="__codelineno-2-1253" href="#__codelineno-2-1253"></a><span class="c1"># Send an email alert if anyone logs in successfully using SSH</span>
<a id="__codelineno-2-1254" name="__codelineno-2-1254" href="#__codelineno-2-1254"></a><span class="c1">#</span>
<a id="__codelineno-2-1255" name="__codelineno-2-1255" href="#__codelineno-2-1255"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1256" name="__codelineno-2-1256" href="#__codelineno-2-1256"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1257" name="__codelineno-2-1257" href="#__codelineno-2-1257"></a><span class="na">LF_SSH_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1258" name="__codelineno-2-1258" href="#__codelineno-2-1258"></a>
<a id="__codelineno-2-1259" name="__codelineno-2-1259" href="#__codelineno-2-1259"></a><span class="c1"># Send an email alert if anyone uses su to access another account. This will</span>
<a id="__codelineno-2-1260" name="__codelineno-2-1260" href="#__codelineno-2-1260"></a><span class="c1"># send an email alert whether the attempt to use su was successful or not</span>
<a id="__codelineno-2-1261" name="__codelineno-2-1261" href="#__codelineno-2-1261"></a><span class="c1">#</span>
<a id="__codelineno-2-1262" name="__codelineno-2-1262" href="#__codelineno-2-1262"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1263" name="__codelineno-2-1263" href="#__codelineno-2-1263"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1264" name="__codelineno-2-1264" href="#__codelineno-2-1264"></a><span class="na">LF_SU_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1265" name="__codelineno-2-1265" href="#__codelineno-2-1265"></a>
<a id="__codelineno-2-1266" name="__codelineno-2-1266" href="#__codelineno-2-1266"></a><span class="c1"># Send an email alert if anyone uses sudo to access another account. This will</span>
<a id="__codelineno-2-1267" name="__codelineno-2-1267" href="#__codelineno-2-1267"></a><span class="c1"># send an email alert whether the attempt to use sudo was successful or not</span>
<a id="__codelineno-2-1268" name="__codelineno-2-1268" href="#__codelineno-2-1268"></a><span class="c1">#</span>
<a id="__codelineno-2-1269" name="__codelineno-2-1269" href="#__codelineno-2-1269"></a><span class="c1"># NOTE: This option could become onerous if sudo is used extensively for root</span>
<a id="__codelineno-2-1270" name="__codelineno-2-1270" href="#__codelineno-2-1270"></a><span class="c1"># access by administrators or control panels. It is provided for those where</span>
<a id="__codelineno-2-1271" name="__codelineno-2-1271" href="#__codelineno-2-1271"></a><span class="c1"># this is not the case</span>
<a id="__codelineno-2-1272" name="__codelineno-2-1272" href="#__codelineno-2-1272"></a><span class="c1">#</span>
<a id="__codelineno-2-1273" name="__codelineno-2-1273" href="#__codelineno-2-1273"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1274" name="__codelineno-2-1274" href="#__codelineno-2-1274"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1275" name="__codelineno-2-1275" href="#__codelineno-2-1275"></a><span class="na">LF_SUDO_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1276" name="__codelineno-2-1276" href="#__codelineno-2-1276"></a>
<a id="__codelineno-2-1277" name="__codelineno-2-1277" href="#__codelineno-2-1277"></a><span class="c1"># Send an email alert if anyone accesses webmin</span>
<a id="__codelineno-2-1278" name="__codelineno-2-1278" href="#__codelineno-2-1278"></a><span class="c1">#</span>
<a id="__codelineno-2-1279" name="__codelineno-2-1279" href="#__codelineno-2-1279"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1280" name="__codelineno-2-1280" href="#__codelineno-2-1280"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1281" name="__codelineno-2-1281" href="#__codelineno-2-1281"></a><span class="na">LF_WEBMIN_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1282" name="__codelineno-2-1282" href="#__codelineno-2-1282"></a>
<a id="__codelineno-2-1283" name="__codelineno-2-1283" href="#__codelineno-2-1283"></a><span class="c1"># Send an email alert if anyone logs in successfully to root on the console</span>
<a id="__codelineno-2-1284" name="__codelineno-2-1284" href="#__codelineno-2-1284"></a><span class="c1">#</span>
<a id="__codelineno-2-1285" name="__codelineno-2-1285" href="#__codelineno-2-1285"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1286" name="__codelineno-2-1286" href="#__codelineno-2-1286"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1287" name="__codelineno-2-1287" href="#__codelineno-2-1287"></a><span class="na">LF_CONSOLE_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1288" name="__codelineno-2-1288" href="#__codelineno-2-1288"></a>
<a id="__codelineno-2-1289" name="__codelineno-2-1289" href="#__codelineno-2-1289"></a><span class="c1"># This option will keep track of the number of "File does not exist" errors in</span>
<a id="__codelineno-2-1290" name="__codelineno-2-1290" href="#__codelineno-2-1290"></a><span class="c1"># HTACCESS_LOG. If the number of hits is more than LF_APACHE_404 in LF_INTERVAL</span>
<a id="__codelineno-2-1291" name="__codelineno-2-1291" href="#__codelineno-2-1291"></a><span class="c1"># seconds then the IP address will be blocked</span>
<a id="__codelineno-2-1292" name="__codelineno-2-1292" href="#__codelineno-2-1292"></a><span class="c1">#</span>
<a id="__codelineno-2-1293" name="__codelineno-2-1293" href="#__codelineno-2-1293"></a><span class="c1"># Care should be used with this option as it could generate many</span>
<a id="__codelineno-2-1294" name="__codelineno-2-1294" href="#__codelineno-2-1294"></a><span class="c1"># false-positives, especially Search Bots (use csf.rignore to ignore such bots)</span>
<a id="__codelineno-2-1295" name="__codelineno-2-1295" href="#__codelineno-2-1295"></a><span class="c1"># so only use this option if you know you are under this type of attack</span>
<a id="__codelineno-2-1296" name="__codelineno-2-1296" href="#__codelineno-2-1296"></a><span class="c1">#</span>
<a id="__codelineno-2-1297" name="__codelineno-2-1297" href="#__codelineno-2-1297"></a><span class="c1"># A sensible setting for this would be quite high, perhaps 200</span>
<a id="__codelineno-2-1298" name="__codelineno-2-1298" href="#__codelineno-2-1298"></a><span class="c1">#</span>
<a id="__codelineno-2-1299" name="__codelineno-2-1299" href="#__codelineno-2-1299"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1300" name="__codelineno-2-1300" href="#__codelineno-2-1300"></a><span class="na">LF_APACHE_404</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1301" name="__codelineno-2-1301" href="#__codelineno-2-1301"></a>
<a id="__codelineno-2-1302" name="__codelineno-2-1302" href="#__codelineno-2-1302"></a><span class="c1"># If this option is set to 1 the blocks will be permanent</span>
<a id="__codelineno-2-1303" name="__codelineno-2-1303" href="#__codelineno-2-1303"></a><span class="c1"># If this option is &gt; 1, the blocks will be temporary for the specified number</span>
<a id="__codelineno-2-1304" name="__codelineno-2-1304" href="#__codelineno-2-1304"></a><span class="c1"># of seconds</span>
<a id="__codelineno-2-1305" name="__codelineno-2-1305" href="#__codelineno-2-1305"></a><span class="na">LF_APACHE_404_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1306" name="__codelineno-2-1306" href="#__codelineno-2-1306"></a>
<a id="__codelineno-2-1307" name="__codelineno-2-1307" href="#__codelineno-2-1307"></a><span class="c1"># This option will keep track of the number of "client denied by server</span>
<a id="__codelineno-2-1308" name="__codelineno-2-1308" href="#__codelineno-2-1308"></a><span class="c1"># configuration" errors in HTACCESS_LOG. If the number of hits is more than</span>
<a id="__codelineno-2-1309" name="__codelineno-2-1309" href="#__codelineno-2-1309"></a><span class="c1"># LF_APACHE_403 in LF_INTERVAL seconds then the IP address will be blocked</span>
<a id="__codelineno-2-1310" name="__codelineno-2-1310" href="#__codelineno-2-1310"></a><span class="c1">#</span>
<a id="__codelineno-2-1311" name="__codelineno-2-1311" href="#__codelineno-2-1311"></a><span class="c1"># Care should be used with this option as it could generate many</span>
<a id="__codelineno-2-1312" name="__codelineno-2-1312" href="#__codelineno-2-1312"></a><span class="c1"># false-positives, especially Search Bots (use csf.rignore to ignore such bots)</span>
<a id="__codelineno-2-1313" name="__codelineno-2-1313" href="#__codelineno-2-1313"></a><span class="c1"># so only use this option if you know you are under this type of attack</span>
<a id="__codelineno-2-1314" name="__codelineno-2-1314" href="#__codelineno-2-1314"></a><span class="c1">#</span>
<a id="__codelineno-2-1315" name="__codelineno-2-1315" href="#__codelineno-2-1315"></a><span class="c1"># A sensible setting for this would be quite high, perhaps 200</span>
<a id="__codelineno-2-1316" name="__codelineno-2-1316" href="#__codelineno-2-1316"></a><span class="c1">#</span>
<a id="__codelineno-2-1317" name="__codelineno-2-1317" href="#__codelineno-2-1317"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1318" name="__codelineno-2-1318" href="#__codelineno-2-1318"></a><span class="na">LF_APACHE_403</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1319" name="__codelineno-2-1319" href="#__codelineno-2-1319"></a>
<a id="__codelineno-2-1320" name="__codelineno-2-1320" href="#__codelineno-2-1320"></a><span class="c1"># If this option is set to 1 the blocks will be permanent</span>
<a id="__codelineno-2-1321" name="__codelineno-2-1321" href="#__codelineno-2-1321"></a><span class="c1"># If this option is &gt; 1, the blocks will be temporary for the specified number</span>
<a id="__codelineno-2-1322" name="__codelineno-2-1322" href="#__codelineno-2-1322"></a><span class="c1"># of seconds</span>
<a id="__codelineno-2-1323" name="__codelineno-2-1323" href="#__codelineno-2-1323"></a><span class="na">LF_APACHE_403_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1324" name="__codelineno-2-1324" href="#__codelineno-2-1324"></a>
<a id="__codelineno-2-1325" name="__codelineno-2-1325" href="#__codelineno-2-1325"></a><span class="c1"># This option will keep track of the number of 401 failures in HTACCESS_LOG.</span>
<a id="__codelineno-2-1326" name="__codelineno-2-1326" href="#__codelineno-2-1326"></a><span class="c1"># If the number of hits is more than LF_APACHE_401 in LF_INTERVAL seconds then</span>
<a id="__codelineno-2-1327" name="__codelineno-2-1327" href="#__codelineno-2-1327"></a><span class="c1"># the IP address will be blocked</span>
<a id="__codelineno-2-1328" name="__codelineno-2-1328" href="#__codelineno-2-1328"></a><span class="c1">#</span>
<a id="__codelineno-2-1329" name="__codelineno-2-1329" href="#__codelineno-2-1329"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1330" name="__codelineno-2-1330" href="#__codelineno-2-1330"></a><span class="na">LF_APACHE_401</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1331" name="__codelineno-2-1331" href="#__codelineno-2-1331"></a>
<a id="__codelineno-2-1332" name="__codelineno-2-1332" href="#__codelineno-2-1332"></a><span class="c1"># This option is used to determine if the Apache error_log format contains the</span>
<a id="__codelineno-2-1333" name="__codelineno-2-1333" href="#__codelineno-2-1333"></a><span class="c1"># client port after the client IP. In Apache prior to v2.4, this was not the</span>
<a id="__codelineno-2-1334" name="__codelineno-2-1334" href="#__codelineno-2-1334"></a><span class="c1"># case. In Apache v2.4+ the error_log format can be configured using</span>
<a id="__codelineno-2-1335" name="__codelineno-2-1335" href="#__codelineno-2-1335"></a><span class="c1"># ErrorLogFormat, making the port directive optional</span>
<a id="__codelineno-2-1336" name="__codelineno-2-1336" href="#__codelineno-2-1336"></a><span class="c1">#</span>
<a id="__codelineno-2-1337" name="__codelineno-2-1337" href="#__codelineno-2-1337"></a><span class="c1"># Unfortunately v2.4 ErrorLogFormat places the port number after a colon next</span>
<a id="__codelineno-2-1338" name="__codelineno-2-1338" href="#__codelineno-2-1338"></a><span class="c1"># to the client IP by default. This makes determining client IPv6 addresses</span>
<a id="__codelineno-2-1339" name="__codelineno-2-1339" href="#__codelineno-2-1339"></a><span class="c1"># difficult unless we know whether the port is being appended or not</span>
<a id="__codelineno-2-1340" name="__codelineno-2-1340" href="#__codelineno-2-1340"></a><span class="c1">#</span>
<a id="__codelineno-2-1341" name="__codelineno-2-1341" href="#__codelineno-2-1341"></a><span class="c1"># lfd will attempt to autodetect the correct value if this option is set to "0"</span>
<a id="__codelineno-2-1342" name="__codelineno-2-1342" href="#__codelineno-2-1342"></a><span class="c1"># from the httpd binary found in common locations. If it fails to find a binary</span>
<a id="__codelineno-2-1343" name="__codelineno-2-1343" href="#__codelineno-2-1343"></a><span class="c1"># it will be set to "2", unless specified here</span>
<a id="__codelineno-2-1344" name="__codelineno-2-1344" href="#__codelineno-2-1344"></a><span class="c1">#</span>
<a id="__codelineno-2-1345" name="__codelineno-2-1345" href="#__codelineno-2-1345"></a><span class="c1"># The value can be set here explicitly if the autodetection does not work:</span>
<a id="__codelineno-2-1346" name="__codelineno-2-1346" href="#__codelineno-2-1346"></a><span class="c1"># 0 - autodetect</span>
<a id="__codelineno-2-1347" name="__codelineno-2-1347" href="#__codelineno-2-1347"></a><span class="c1"># 1 - no port directive after client IP</span>
<a id="__codelineno-2-1348" name="__codelineno-2-1348" href="#__codelineno-2-1348"></a><span class="c1"># 2 - port directive after client IP</span>
<a id="__codelineno-2-1349" name="__codelineno-2-1349" href="#__codelineno-2-1349"></a><span class="na">LF_APACHE_ERRPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1350" name="__codelineno-2-1350" href="#__codelineno-2-1350"></a>
<a id="__codelineno-2-1351" name="__codelineno-2-1351" href="#__codelineno-2-1351"></a><span class="c1"># If this option is set to 1 the blocks will be permanent</span>
<a id="__codelineno-2-1352" name="__codelineno-2-1352" href="#__codelineno-2-1352"></a><span class="c1"># If this option is &gt; 1, the blocks will be temporary for the specified number</span>
<a id="__codelineno-2-1353" name="__codelineno-2-1353" href="#__codelineno-2-1353"></a><span class="c1"># of seconds</span>
<a id="__codelineno-2-1354" name="__codelineno-2-1354" href="#__codelineno-2-1354"></a><span class="na">LF_APACHE_401_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1355" name="__codelineno-2-1355" href="#__codelineno-2-1355"></a>
<a id="__codelineno-2-1356" name="__codelineno-2-1356" href="#__codelineno-2-1356"></a><span class="c1"># This option will send an alert if the ModSecurity IP persistent storage grows</span>
<a id="__codelineno-2-1357" name="__codelineno-2-1357" href="#__codelineno-2-1357"></a><span class="c1"># excessively large: https://goo.gl/rGh5sF</span>
<a id="__codelineno-2-1358" name="__codelineno-2-1358" href="#__codelineno-2-1358"></a><span class="c1">#</span>
<a id="__codelineno-2-1359" name="__codelineno-2-1359" href="#__codelineno-2-1359"></a><span class="c1"># More information on cPanel servers here: https://goo.gl/vo6xTE</span>
<a id="__codelineno-2-1360" name="__codelineno-2-1360" href="#__codelineno-2-1360"></a><span class="c1">#</span>
<a id="__codelineno-2-1361" name="__codelineno-2-1361" href="#__codelineno-2-1361"></a><span class="c1"># LF_MODSECIPDB_FILE must be set to the correct location of the database file</span>
<a id="__codelineno-2-1362" name="__codelineno-2-1362" href="#__codelineno-2-1362"></a><span class="c1">#</span>
<a id="__codelineno-2-1363" name="__codelineno-2-1363" href="#__codelineno-2-1363"></a><span class="c1"># The check is performed at lfd startup and then once per hour, the template</span>
<a id="__codelineno-2-1364" name="__codelineno-2-1364" href="#__codelineno-2-1364"></a><span class="c1"># used is modsecipdbalert.txt</span>
<a id="__codelineno-2-1365" name="__codelineno-2-1365" href="#__codelineno-2-1365"></a><span class="c1">#</span>
<a id="__codelineno-2-1366" name="__codelineno-2-1366" href="#__codelineno-2-1366"></a><span class="c1"># Set to "0" to disable this option, otherwise it is the threshold size of the</span>
<a id="__codelineno-2-1367" name="__codelineno-2-1367" href="#__codelineno-2-1367"></a><span class="c1"># file to report in gigabytes, e.g. set to 5 for 5GB</span>
<a id="__codelineno-2-1368" name="__codelineno-2-1368" href="#__codelineno-2-1368"></a><span class="na">LF_MODSECIPDB_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1369" name="__codelineno-2-1369" href="#__codelineno-2-1369"></a>
<a id="__codelineno-2-1370" name="__codelineno-2-1370" href="#__codelineno-2-1370"></a><span class="c1"># This is the location of the persistent IP storage file on the server, e.g.:</span>
<a id="__codelineno-2-1371" name="__codelineno-2-1371" href="#__codelineno-2-1371"></a><span class="c1"># /var/run/modsecurity/data/ip.pag</span>
<a id="__codelineno-2-1372" name="__codelineno-2-1372" href="#__codelineno-2-1372"></a><span class="c1"># /var/cpanel/secdatadir/ip.pag</span>
<a id="__codelineno-2-1373" name="__codelineno-2-1373" href="#__codelineno-2-1373"></a><span class="c1"># /var/cache/modsecurity/ip.pag</span>
<a id="__codelineno-2-1374" name="__codelineno-2-1374" href="#__codelineno-2-1374"></a><span class="c1"># /usr/local/apache/conf/modsec/data/msa/ip.pag</span>
<a id="__codelineno-2-1375" name="__codelineno-2-1375" href="#__codelineno-2-1375"></a><span class="c1"># /var/tmp/ip.pag</span>
<a id="__codelineno-2-1376" name="__codelineno-2-1376" href="#__codelineno-2-1376"></a><span class="c1"># /tmp/ip.pag</span>
<a id="__codelineno-2-1377" name="__codelineno-2-1377" href="#__codelineno-2-1377"></a><span class="na">LF_MODSECIPDB_FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/run/modsecurity/data/ip.pag"</span>
<a id="__codelineno-2-1378" name="__codelineno-2-1378" href="#__codelineno-2-1378"></a>
<a id="__codelineno-2-1379" name="__codelineno-2-1379" href="#__codelineno-2-1379"></a><span class="c1"># System Exploit Checking. This option is designed to perform a series of tests</span>
<a id="__codelineno-2-1380" name="__codelineno-2-1380" href="#__codelineno-2-1380"></a><span class="c1"># to send an alert in case a possible server compromise is detected</span>
<a id="__codelineno-2-1381" name="__codelineno-2-1381" href="#__codelineno-2-1381"></a><span class="c1">#</span>
<a id="__codelineno-2-1382" name="__codelineno-2-1382" href="#__codelineno-2-1382"></a><span class="c1"># To enable this feature set the following to the checking interval in seconds</span>
<a id="__codelineno-2-1383" name="__codelineno-2-1383" href="#__codelineno-2-1383"></a><span class="c1"># (a value of 300 would seem sensible).</span>
<a id="__codelineno-2-1384" name="__codelineno-2-1384" href="#__codelineno-2-1384"></a><span class="c1">#</span>
<a id="__codelineno-2-1385" name="__codelineno-2-1385" href="#__codelineno-2-1385"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1386" name="__codelineno-2-1386" href="#__codelineno-2-1386"></a><span class="na">LF_EXPLOIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-2-1387" name="__codelineno-2-1387" href="#__codelineno-2-1387"></a>
<a id="__codelineno-2-1388" name="__codelineno-2-1388" href="#__codelineno-2-1388"></a><span class="c1"># This comma separated list allows you to ignore tests LF_EXPLOIT performs</span>
<a id="__codelineno-2-1389" name="__codelineno-2-1389" href="#__codelineno-2-1389"></a><span class="c1">#</span>
<a id="__codelineno-2-1390" name="__codelineno-2-1390" href="#__codelineno-2-1390"></a><span class="c1"># For the SUPERUSER check, you can list usernames in csf.suignore to have them</span>
<a id="__codelineno-2-1391" name="__codelineno-2-1391" href="#__codelineno-2-1391"></a><span class="c1"># ignored for that test</span>
<a id="__codelineno-2-1392" name="__codelineno-2-1392" href="#__codelineno-2-1392"></a><span class="c1">#</span>
<a id="__codelineno-2-1393" name="__codelineno-2-1393" href="#__codelineno-2-1393"></a><span class="c1"># Valid tests are:</span>
<a id="__codelineno-2-1394" name="__codelineno-2-1394" href="#__codelineno-2-1394"></a><span class="c1"># SUPERUSER</span>
<a id="__codelineno-2-1395" name="__codelineno-2-1395" href="#__codelineno-2-1395"></a><span class="c1">#</span>
<a id="__codelineno-2-1396" name="__codelineno-2-1396" href="#__codelineno-2-1396"></a><span class="c1"># If you want to ignore a test add it to this as a comma separated list, e.g.</span>
<a id="__codelineno-2-1397" name="__codelineno-2-1397" href="#__codelineno-2-1397"></a><span class="c1"># "SUPERUSER"</span>
<a id="__codelineno-2-1398" name="__codelineno-2-1398" href="#__codelineno-2-1398"></a><span class="na">LF_EXPLOIT_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1399" name="__codelineno-2-1399" href="#__codelineno-2-1399"></a>
<a id="__codelineno-2-1400" name="__codelineno-2-1400" href="#__codelineno-2-1400"></a><span class="c1"># Set the time interval to track login and other LF_ failures within (seconds),</span>
<a id="__codelineno-2-1401" name="__codelineno-2-1401" href="#__codelineno-2-1401"></a><span class="c1"># i.e. LF_TRIGGER failures within the last LF_INTERVAL seconds</span>
<a id="__codelineno-2-1402" name="__codelineno-2-1402" href="#__codelineno-2-1402"></a><span class="na">LF_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1403" name="__codelineno-2-1403" href="#__codelineno-2-1403"></a>
<a id="__codelineno-2-1404" name="__codelineno-2-1404" href="#__codelineno-2-1404"></a><span class="c1"># This is how long the lfd process sleeps (in seconds) before processing the</span>
<a id="__codelineno-2-1405" name="__codelineno-2-1405" href="#__codelineno-2-1405"></a><span class="c1"># log file entries and checking whether other events need to be triggered</span>
<a id="__codelineno-2-1406" name="__codelineno-2-1406" href="#__codelineno-2-1406"></a><span class="na">LF_PARSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-1407" name="__codelineno-2-1407" href="#__codelineno-2-1407"></a>
<a id="__codelineno-2-1408" name="__codelineno-2-1408" href="#__codelineno-2-1408"></a><span class="c1"># This is the interval that is used to flush reports of usernames, files and</span>
<a id="__codelineno-2-1409" name="__codelineno-2-1409" href="#__codelineno-2-1409"></a><span class="c1"># pids so that persistent problems continue to be reported, in seconds.</span>
<a id="__codelineno-2-1410" name="__codelineno-2-1410" href="#__codelineno-2-1410"></a><span class="c1"># A value of 3600 seems sensible</span>
<a id="__codelineno-2-1411" name="__codelineno-2-1411" href="#__codelineno-2-1411"></a><span class="na">LF_FLUSH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1412" name="__codelineno-2-1412" href="#__codelineno-2-1412"></a>
<a id="__codelineno-2-1413" name="__codelineno-2-1413" href="#__codelineno-2-1413"></a><span class="c1"># Under some circumstances iptables can fail to include a rule instruction,</span>
<a id="__codelineno-2-1414" name="__codelineno-2-1414" href="#__codelineno-2-1414"></a><span class="c1"># especially if more than one request is made concurrently. In this event, a</span>
<a id="__codelineno-2-1415" name="__codelineno-2-1415" href="#__codelineno-2-1415"></a><span class="c1"># permanent block entry may exist in csf.deny, but not in iptables.</span>
<a id="__codelineno-2-1416" name="__codelineno-2-1416" href="#__codelineno-2-1416"></a><span class="c1">#</span>
<a id="__codelineno-2-1417" name="__codelineno-2-1417" href="#__codelineno-2-1417"></a><span class="c1"># This option instructs csf to deny an already blocked IP address the number</span>
<a id="__codelineno-2-1418" name="__codelineno-2-1418" href="#__codelineno-2-1418"></a><span class="c1"># of times set. The downside, is that there will be multiple entries for an IP</span>
<a id="__codelineno-2-1419" name="__codelineno-2-1419" href="#__codelineno-2-1419"></a><span class="c1"># address in csf.deny and possibly multiple rules for the same IP address in</span>
<a id="__codelineno-2-1420" name="__codelineno-2-1420" href="#__codelineno-2-1420"></a><span class="c1"># iptables. This needs to be taken into consideration when unblocking such IP</span>
<a id="__codelineno-2-1421" name="__codelineno-2-1421" href="#__codelineno-2-1421"></a><span class="c1"># addresses.</span>
<a id="__codelineno-2-1422" name="__codelineno-2-1422" href="#__codelineno-2-1422"></a><span class="c1">#</span>
<a id="__codelineno-2-1423" name="__codelineno-2-1423" href="#__codelineno-2-1423"></a><span class="c1"># Set to "0" to disable this feature. Do not set this too high for the reasons</span>
<a id="__codelineno-2-1424" name="__codelineno-2-1424" href="#__codelineno-2-1424"></a><span class="c1"># detailed above (e.g. "5" should be more than enough)</span>
<a id="__codelineno-2-1425" name="__codelineno-2-1425" href="#__codelineno-2-1425"></a><span class="na">LF_REPEATBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1426" name="__codelineno-2-1426" href="#__codelineno-2-1426"></a>
<a id="__codelineno-2-1427" name="__codelineno-2-1427" href="#__codelineno-2-1427"></a><span class="c1"># By default csf will create both an inbound and outbound blocks from/to an IP</span>
<a id="__codelineno-2-1428" name="__codelineno-2-1428" href="#__codelineno-2-1428"></a><span class="c1"># unless otherwise specified in csf.deny and GLOBAL_DENY. This is the most</span>
<a id="__codelineno-2-1429" name="__codelineno-2-1429" href="#__codelineno-2-1429"></a><span class="c1"># effective way to block IP traffic. This option instructs csf to only block</span>
<a id="__codelineno-2-1430" name="__codelineno-2-1430" href="#__codelineno-2-1430"></a><span class="c1"># inbound traffic from those IP's and so reduces the number of iptables rules,</span>
<a id="__codelineno-2-1431" name="__codelineno-2-1431" href="#__codelineno-2-1431"></a><span class="c1"># but at the expense of less effectiveness. For this reason we recommend</span>
<a id="__codelineno-2-1432" name="__codelineno-2-1432" href="#__codelineno-2-1432"></a><span class="c1"># leaving this option disabled</span>
<a id="__codelineno-2-1433" name="__codelineno-2-1433" href="#__codelineno-2-1433"></a><span class="c1"># </span>
<a id="__codelineno-2-1434" name="__codelineno-2-1434" href="#__codelineno-2-1434"></a><span class="c1"># Set to "0" to disable this feature - the default</span>
<a id="__codelineno-2-1435" name="__codelineno-2-1435" href="#__codelineno-2-1435"></a><span class="na">LF_BLOCKINONLY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1436" name="__codelineno-2-1436" href="#__codelineno-2-1436"></a>
<a id="__codelineno-2-1437" name="__codelineno-2-1437" href="#__codelineno-2-1437"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1438" name="__codelineno-2-1438" href="#__codelineno-2-1438"></a><span class="c1"># SECTION:CloudFlare</span>
<a id="__codelineno-2-1439" name="__codelineno-2-1439" href="#__codelineno-2-1439"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1440" name="__codelineno-2-1440" href="#__codelineno-2-1440"></a><span class="c1"># This features provides interaction with the CloudFlare Firewall</span>
<a id="__codelineno-2-1441" name="__codelineno-2-1441" href="#__codelineno-2-1441"></a><span class="c1">#</span>
<a id="__codelineno-2-1442" name="__codelineno-2-1442" href="#__codelineno-2-1442"></a><span class="c1"># As CloudFlare is a reverse proxy, any attacking IP addresses (so far as </span>
<a id="__codelineno-2-1443" name="__codelineno-2-1443" href="#__codelineno-2-1443"></a><span class="c1"># iptables is concerned) come from the CloudFlare IP's. To counter this, an</span>
<a id="__codelineno-2-1444" name="__codelineno-2-1444" href="#__codelineno-2-1444"></a><span class="c1"># Apache module (mod_cloudflare) is available that obtains the true attackers</span>
<a id="__codelineno-2-1445" name="__codelineno-2-1445" href="#__codelineno-2-1445"></a><span class="c1"># IP from a custom HTTP header record (similar functionality is available</span>
<a id="__codelineno-2-1446" name="__codelineno-2-1446" href="#__codelineno-2-1446"></a><span class="c1"># for other HTTP daemons</span>
<a id="__codelineno-2-1447" name="__codelineno-2-1447" href="#__codelineno-2-1447"></a><span class="c1">#</span>
<a id="__codelineno-2-1448" name="__codelineno-2-1448" href="#__codelineno-2-1448"></a><span class="c1"># However, despite now knowing the true attacking IP address, iptables cannot</span>
<a id="__codelineno-2-1449" name="__codelineno-2-1449" href="#__codelineno-2-1449"></a><span class="c1"># be used to block that IP as the traffic is still coming from the CloudFlare</span>
<a id="__codelineno-2-1450" name="__codelineno-2-1450" href="#__codelineno-2-1450"></a><span class="c1"># servers</span>
<a id="__codelineno-2-1451" name="__codelineno-2-1451" href="#__codelineno-2-1451"></a><span class="c1">#</span>
<a id="__codelineno-2-1452" name="__codelineno-2-1452" href="#__codelineno-2-1452"></a><span class="c1"># CloudFlare have provided a Firewall feature within the user account where</span>
<a id="__codelineno-2-1453" name="__codelineno-2-1453" href="#__codelineno-2-1453"></a><span class="c1"># rules can be added to block, challenge or whitelist IP addresses</span>
<a id="__codelineno-2-1454" name="__codelineno-2-1454" href="#__codelineno-2-1454"></a><span class="c1">#</span>
<a id="__codelineno-2-1455" name="__codelineno-2-1455" href="#__codelineno-2-1455"></a><span class="c1"># Using the CloudFlare API, this feature adds and removes attacking IPs from</span>
<a id="__codelineno-2-1456" name="__codelineno-2-1456" href="#__codelineno-2-1456"></a><span class="c1"># that firewall and provides CLI (and via the UI) additional commands</span>
<a id="__codelineno-2-1457" name="__codelineno-2-1457" href="#__codelineno-2-1457"></a><span class="c1">#</span>
<a id="__codelineno-2-1458" name="__codelineno-2-1458" href="#__codelineno-2-1458"></a><span class="c1"># See /etc/csf/readme.txt for more information about this feature and the</span>
<a id="__codelineno-2-1459" name="__codelineno-2-1459" href="#__codelineno-2-1459"></a><span class="c1"># restrictions for its use BEFORE enabling this feature</span>
<a id="__codelineno-2-1460" name="__codelineno-2-1460" href="#__codelineno-2-1460"></a><span class="na">CF_ENABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1461" name="__codelineno-2-1461" href="#__codelineno-2-1461"></a>
<a id="__codelineno-2-1462" name="__codelineno-2-1462" href="#__codelineno-2-1462"></a><span class="c1"># This can be set to either "block" or "challenge" (see CloudFlare docs)</span>
<a id="__codelineno-2-1463" name="__codelineno-2-1463" href="#__codelineno-2-1463"></a><span class="na">CF_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"block"</span>
<a id="__codelineno-2-1464" name="__codelineno-2-1464" href="#__codelineno-2-1464"></a>
<a id="__codelineno-2-1465" name="__codelineno-2-1465" href="#__codelineno-2-1465"></a><span class="c1"># This setting determines how long the temporary block will apply within csf</span>
<a id="__codelineno-2-1466" name="__codelineno-2-1466" href="#__codelineno-2-1466"></a><span class="c1"># and CloudFlare, keeping them in sync</span>
<a id="__codelineno-2-1467" name="__codelineno-2-1467" href="#__codelineno-2-1467"></a><span class="c1">#</span>
<a id="__codelineno-2-1468" name="__codelineno-2-1468" href="#__codelineno-2-1468"></a><span class="c1"># Block duration in seconds - overrides perm block or time of individual blocks</span>
<a id="__codelineno-2-1469" name="__codelineno-2-1469" href="#__codelineno-2-1469"></a><span class="c1"># in lfd for block triggers</span>
<a id="__codelineno-2-1470" name="__codelineno-2-1470" href="#__codelineno-2-1470"></a><span class="na">CF_TEMP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1471" name="__codelineno-2-1471" href="#__codelineno-2-1471"></a>
<a id="__codelineno-2-1472" name="__codelineno-2-1472" href="#__codelineno-2-1472"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1473" name="__codelineno-2-1473" href="#__codelineno-2-1473"></a><span class="c1"># SECTION:Directory Watching &amp; Integrity </span>
<a id="__codelineno-2-1474" name="__codelineno-2-1474" href="#__codelineno-2-1474"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1475" name="__codelineno-2-1475" href="#__codelineno-2-1475"></a><span class="c1"># Enable Directory Watching. This enables lfd to check /tmp and /dev/shm</span>
<a id="__codelineno-2-1476" name="__codelineno-2-1476" href="#__codelineno-2-1476"></a><span class="c1"># directories for suspicious files, i.e. script exploits. If a suspicious</span>
<a id="__codelineno-2-1477" name="__codelineno-2-1477" href="#__codelineno-2-1477"></a><span class="c1"># file is found an email alert is sent. One alert per file per LF_FLUSH</span>
<a id="__codelineno-2-1478" name="__codelineno-2-1478" href="#__codelineno-2-1478"></a><span class="c1"># interval is sent</span>
<a id="__codelineno-2-1479" name="__codelineno-2-1479" href="#__codelineno-2-1479"></a><span class="c1">#</span>
<a id="__codelineno-2-1480" name="__codelineno-2-1480" href="#__codelineno-2-1480"></a><span class="c1"># To enable this feature set the following to the checking interval in seconds.</span>
<a id="__codelineno-2-1481" name="__codelineno-2-1481" href="#__codelineno-2-1481"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1482" name="__codelineno-2-1482" href="#__codelineno-2-1482"></a><span class="na">LF_DIRWATCH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-2-1483" name="__codelineno-2-1483" href="#__codelineno-2-1483"></a>
<a id="__codelineno-2-1484" name="__codelineno-2-1484" href="#__codelineno-2-1484"></a><span class="c1"># To remove any suspicious files found during directory watching, enable the</span>
<a id="__codelineno-2-1485" name="__codelineno-2-1485" href="#__codelineno-2-1485"></a><span class="c1"># following. These files will be appended to a tarball in</span>
<a id="__codelineno-2-1486" name="__codelineno-2-1486" href="#__codelineno-2-1486"></a><span class="c1"># /var/lib/csf/suspicious.tar</span>
<a id="__codelineno-2-1487" name="__codelineno-2-1487" href="#__codelineno-2-1487"></a><span class="na">LF_DIRWATCH_DISABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1488" name="__codelineno-2-1488" href="#__codelineno-2-1488"></a>
<a id="__codelineno-2-1489" name="__codelineno-2-1489" href="#__codelineno-2-1489"></a><span class="c1"># This option allows you to have lfd watch a particular file or directory for</span>
<a id="__codelineno-2-1490" name="__codelineno-2-1490" href="#__codelineno-2-1490"></a><span class="c1"># changes and should they change and email alert using watchalert.txt is sent</span>
<a id="__codelineno-2-1491" name="__codelineno-2-1491" href="#__codelineno-2-1491"></a><span class="c1">#</span>
<a id="__codelineno-2-1492" name="__codelineno-2-1492" href="#__codelineno-2-1492"></a><span class="c1"># To enable this feature set the following to the checking interval in seconds</span>
<a id="__codelineno-2-1493" name="__codelineno-2-1493" href="#__codelineno-2-1493"></a><span class="c1"># (a value of 60 would seem sensible) and add your entries to csf.dirwatch</span>
<a id="__codelineno-2-1494" name="__codelineno-2-1494" href="#__codelineno-2-1494"></a><span class="c1">#</span>
<a id="__codelineno-2-1495" name="__codelineno-2-1495" href="#__codelineno-2-1495"></a><span class="c1"># Set to disable set to "0"</span>
<a id="__codelineno-2-1496" name="__codelineno-2-1496" href="#__codelineno-2-1496"></a><span class="na">LF_DIRWATCH_FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1497" name="__codelineno-2-1497" href="#__codelineno-2-1497"></a>
<a id="__codelineno-2-1498" name="__codelineno-2-1498" href="#__codelineno-2-1498"></a><span class="c1"># System Integrity Checking. This enables lfd to compare md5sums of the</span>
<a id="__codelineno-2-1499" name="__codelineno-2-1499" href="#__codelineno-2-1499"></a><span class="c1"># servers OS binary application files from the time when lfd starts. If the</span>
<a id="__codelineno-2-1500" name="__codelineno-2-1500" href="#__codelineno-2-1500"></a><span class="c1"># md5sum of a monitored file changes an alert is sent. This option is intended</span>
<a id="__codelineno-2-1501" name="__codelineno-2-1501" href="#__codelineno-2-1501"></a><span class="c1"># as an IDS (Intrusion Detection System) and is the last line of detection for</span>
<a id="__codelineno-2-1502" name="__codelineno-2-1502" href="#__codelineno-2-1502"></a><span class="c1"># a possible root compromise.</span>
<a id="__codelineno-2-1503" name="__codelineno-2-1503" href="#__codelineno-2-1503"></a><span class="c1">#</span>
<a id="__codelineno-2-1504" name="__codelineno-2-1504" href="#__codelineno-2-1504"></a><span class="c1"># There will be constant false-positives as the servers OS is updated or</span>
<a id="__codelineno-2-1505" name="__codelineno-2-1505" href="#__codelineno-2-1505"></a><span class="c1"># monitored application binaries are updated. However, unexpected changes</span>
<a id="__codelineno-2-1506" name="__codelineno-2-1506" href="#__codelineno-2-1506"></a><span class="c1"># should be carefully inspected.</span>
<a id="__codelineno-2-1507" name="__codelineno-2-1507" href="#__codelineno-2-1507"></a><span class="c1">#</span>
<a id="__codelineno-2-1508" name="__codelineno-2-1508" href="#__codelineno-2-1508"></a><span class="c1"># Modified files will only be reported via email once.</span>
<a id="__codelineno-2-1509" name="__codelineno-2-1509" href="#__codelineno-2-1509"></a><span class="c1">#</span>
<a id="__codelineno-2-1510" name="__codelineno-2-1510" href="#__codelineno-2-1510"></a><span class="c1"># To enable this feature set the following to the checking interval in seconds</span>
<a id="__codelineno-2-1511" name="__codelineno-2-1511" href="#__codelineno-2-1511"></a><span class="c1"># (a value of 3600 would seem sensible). This option may increase server I/O</span>
<a id="__codelineno-2-1512" name="__codelineno-2-1512" href="#__codelineno-2-1512"></a><span class="c1"># load onto the server as it checks system binaries.</span>
<a id="__codelineno-2-1513" name="__codelineno-2-1513" href="#__codelineno-2-1513"></a><span class="c1">#</span>
<a id="__codelineno-2-1514" name="__codelineno-2-1514" href="#__codelineno-2-1514"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1515" name="__codelineno-2-1515" href="#__codelineno-2-1515"></a><span class="na">LF_INTEGRITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1516" name="__codelineno-2-1516" href="#__codelineno-2-1516"></a>
<a id="__codelineno-2-1517" name="__codelineno-2-1517" href="#__codelineno-2-1517"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1518" name="__codelineno-2-1518" href="#__codelineno-2-1518"></a><span class="c1"># SECTION:Distributed Attacks</span>
<a id="__codelineno-2-1519" name="__codelineno-2-1519" href="#__codelineno-2-1519"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1520" name="__codelineno-2-1520" href="#__codelineno-2-1520"></a><span class="c1"># Distributed Account Attack. This option will keep track of login failures</span>
<a id="__codelineno-2-1521" name="__codelineno-2-1521" href="#__codelineno-2-1521"></a><span class="c1"># from distributed IP addresses to a specific application account. If the</span>
<a id="__codelineno-2-1522" name="__codelineno-2-1522" href="#__codelineno-2-1522"></a><span class="c1"># number of failures matches the trigger value above, ALL of the IP addresses</span>
<a id="__codelineno-2-1523" name="__codelineno-2-1523" href="#__codelineno-2-1523"></a><span class="c1"># involved in the attack will be blocked according to the temp/perm rules above</span>
<a id="__codelineno-2-1524" name="__codelineno-2-1524" href="#__codelineno-2-1524"></a><span class="c1">#</span>
<a id="__codelineno-2-1525" name="__codelineno-2-1525" href="#__codelineno-2-1525"></a><span class="c1"># Tracking applies to LF_SSHD, LF_FTPD, LF_SMTPAUTH, LF_POP3D, LF_IMAPD, </span>
<a id="__codelineno-2-1526" name="__codelineno-2-1526" href="#__codelineno-2-1526"></a><span class="c1"># LF_HTACCESS</span>
<a id="__codelineno-2-1527" name="__codelineno-2-1527" href="#__codelineno-2-1527"></a><span class="c1">#</span>
<a id="__codelineno-2-1528" name="__codelineno-2-1528" href="#__codelineno-2-1528"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1529" name="__codelineno-2-1529" href="#__codelineno-2-1529"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1530" name="__codelineno-2-1530" href="#__codelineno-2-1530"></a><span class="na">LF_DISTATTACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1531" name="__codelineno-2-1531" href="#__codelineno-2-1531"></a>
<a id="__codelineno-2-1532" name="__codelineno-2-1532" href="#__codelineno-2-1532"></a><span class="c1"># Set the following to the minimum number of unique IP addresses that trigger</span>
<a id="__codelineno-2-1533" name="__codelineno-2-1533" href="#__codelineno-2-1533"></a><span class="c1"># LF_DISTATTACK</span>
<a id="__codelineno-2-1534" name="__codelineno-2-1534" href="#__codelineno-2-1534"></a><span class="na">LF_DISTATTACK_UNIQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-2-1535" name="__codelineno-2-1535" href="#__codelineno-2-1535"></a>
<a id="__codelineno-2-1536" name="__codelineno-2-1536" href="#__codelineno-2-1536"></a><span class="c1"># Distributed FTP Logins. This option will keep track of successful FTP logins.</span>
<a id="__codelineno-2-1537" name="__codelineno-2-1537" href="#__codelineno-2-1537"></a><span class="c1"># If the number of successful logins to an individual account is at least</span>
<a id="__codelineno-2-1538" name="__codelineno-2-1538" href="#__codelineno-2-1538"></a><span class="c1"># LF_DISTFTP in LF_DIST_INTERVAL from at least LF_DISTFTP_UNIQ IP addresses,</span>
<a id="__codelineno-2-1539" name="__codelineno-2-1539" href="#__codelineno-2-1539"></a><span class="c1"># then all of the IP addresses will be blocked</span>
<a id="__codelineno-2-1540" name="__codelineno-2-1540" href="#__codelineno-2-1540"></a><span class="c1">#</span>
<a id="__codelineno-2-1541" name="__codelineno-2-1541" href="#__codelineno-2-1541"></a><span class="c1"># This option can help mitigate the common FTP account compromise attacks that</span>
<a id="__codelineno-2-1542" name="__codelineno-2-1542" href="#__codelineno-2-1542"></a><span class="c1"># use a distributed network of zombies to deface websites</span>
<a id="__codelineno-2-1543" name="__codelineno-2-1543" href="#__codelineno-2-1543"></a><span class="c1">#</span>
<a id="__codelineno-2-1544" name="__codelineno-2-1544" href="#__codelineno-2-1544"></a><span class="c1"># A sensible setting for this might be 5, depending on how many different</span>
<a id="__codelineno-2-1545" name="__codelineno-2-1545" href="#__codelineno-2-1545"></a><span class="c1"># IP addresses you expect to an individual FTP account within LF_DIST_INTERVAL</span>
<a id="__codelineno-2-1546" name="__codelineno-2-1546" href="#__codelineno-2-1546"></a><span class="c1">#</span>
<a id="__codelineno-2-1547" name="__codelineno-2-1547" href="#__codelineno-2-1547"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1548" name="__codelineno-2-1548" href="#__codelineno-2-1548"></a><span class="c1">#</span>
<a id="__codelineno-2-1549" name="__codelineno-2-1549" href="#__codelineno-2-1549"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1550" name="__codelineno-2-1550" href="#__codelineno-2-1550"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1551" name="__codelineno-2-1551" href="#__codelineno-2-1551"></a><span class="na">LF_DISTFTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1552" name="__codelineno-2-1552" href="#__codelineno-2-1552"></a>
<a id="__codelineno-2-1553" name="__codelineno-2-1553" href="#__codelineno-2-1553"></a><span class="c1"># Set the following to the minimum number of unique IP addresses that trigger</span>
<a id="__codelineno-2-1554" name="__codelineno-2-1554" href="#__codelineno-2-1554"></a><span class="c1"># LF_DISTFTP. LF_DISTFTP_UNIQ must be &lt;= LF_DISTFTP for this to work</span>
<a id="__codelineno-2-1555" name="__codelineno-2-1555" href="#__codelineno-2-1555"></a><span class="na">LF_DISTFTP_UNIQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3"</span>
<a id="__codelineno-2-1556" name="__codelineno-2-1556" href="#__codelineno-2-1556"></a>
<a id="__codelineno-2-1557" name="__codelineno-2-1557" href="#__codelineno-2-1557"></a><span class="c1"># If this option is set to 1 the blocks will be permanent</span>
<a id="__codelineno-2-1558" name="__codelineno-2-1558" href="#__codelineno-2-1558"></a><span class="c1"># If this option is &gt; 1, the blocks will be temporary for the specified number</span>
<a id="__codelineno-2-1559" name="__codelineno-2-1559" href="#__codelineno-2-1559"></a><span class="c1"># of seconds</span>
<a id="__codelineno-2-1560" name="__codelineno-2-1560" href="#__codelineno-2-1560"></a><span class="na">LF_DISTFTP_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1561" name="__codelineno-2-1561" href="#__codelineno-2-1561"></a>
<a id="__codelineno-2-1562" name="__codelineno-2-1562" href="#__codelineno-2-1562"></a><span class="c1"># Send an email alert if LF_DISTFTP is triggered</span>
<a id="__codelineno-2-1563" name="__codelineno-2-1563" href="#__codelineno-2-1563"></a><span class="na">LF_DISTFTP_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1564" name="__codelineno-2-1564" href="#__codelineno-2-1564"></a>
<a id="__codelineno-2-1565" name="__codelineno-2-1565" href="#__codelineno-2-1565"></a><span class="c1"># Distributed SMTP Logins. This option will keep track of successful SMTP</span>
<a id="__codelineno-2-1566" name="__codelineno-2-1566" href="#__codelineno-2-1566"></a><span class="c1"># logins. If the number of successful logins to an individual account is at</span>
<a id="__codelineno-2-1567" name="__codelineno-2-1567" href="#__codelineno-2-1567"></a><span class="c1"># least LF_DISTSMTP in LF_DIST_INTERVAL from at least LF_DISTSMTP_UNIQ IP</span>
<a id="__codelineno-2-1568" name="__codelineno-2-1568" href="#__codelineno-2-1568"></a><span class="c1"># addresses, then all of the IP addresses will be blocked. These options only</span>
<a id="__codelineno-2-1569" name="__codelineno-2-1569" href="#__codelineno-2-1569"></a><span class="c1"># apply to the exim MTA</span>
<a id="__codelineno-2-1570" name="__codelineno-2-1570" href="#__codelineno-2-1570"></a><span class="c1">#</span>
<a id="__codelineno-2-1571" name="__codelineno-2-1571" href="#__codelineno-2-1571"></a><span class="c1"># This option can help mitigate the common SMTP account compromise attacks that</span>
<a id="__codelineno-2-1572" name="__codelineno-2-1572" href="#__codelineno-2-1572"></a><span class="c1"># use a distributed network of zombies to send spam</span>
<a id="__codelineno-2-1573" name="__codelineno-2-1573" href="#__codelineno-2-1573"></a><span class="c1">#</span>
<a id="__codelineno-2-1574" name="__codelineno-2-1574" href="#__codelineno-2-1574"></a><span class="c1"># A sensible setting for this might be 5, depending on how many different</span>
<a id="__codelineno-2-1575" name="__codelineno-2-1575" href="#__codelineno-2-1575"></a><span class="c1"># IP addresses you expect to an individual SMTP account within LF_DIST_INTERVAL</span>
<a id="__codelineno-2-1576" name="__codelineno-2-1576" href="#__codelineno-2-1576"></a><span class="c1">#</span>
<a id="__codelineno-2-1577" name="__codelineno-2-1577" href="#__codelineno-2-1577"></a><span class="c1"># To disable set to "0"</span>
<a id="__codelineno-2-1578" name="__codelineno-2-1578" href="#__codelineno-2-1578"></a><span class="na">LF_DISTSMTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1579" name="__codelineno-2-1579" href="#__codelineno-2-1579"></a>
<a id="__codelineno-2-1580" name="__codelineno-2-1580" href="#__codelineno-2-1580"></a><span class="c1"># Set the following to the minimum number of unique IP addresses that trigger</span>
<a id="__codelineno-2-1581" name="__codelineno-2-1581" href="#__codelineno-2-1581"></a><span class="c1"># LF_DISTSMTP. LF_DISTSMTP_UNIQ must be &lt;= LF_DISTSMTP for this to work</span>
<a id="__codelineno-2-1582" name="__codelineno-2-1582" href="#__codelineno-2-1582"></a><span class="na">LF_DISTSMTP_UNIQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3"</span>
<a id="__codelineno-2-1583" name="__codelineno-2-1583" href="#__codelineno-2-1583"></a>
<a id="__codelineno-2-1584" name="__codelineno-2-1584" href="#__codelineno-2-1584"></a><span class="c1"># If this option is set to 1 the blocks will be permanent</span>
<a id="__codelineno-2-1585" name="__codelineno-2-1585" href="#__codelineno-2-1585"></a><span class="c1"># If this option is &gt; 1, the blocks will be temporary for the specified number</span>
<a id="__codelineno-2-1586" name="__codelineno-2-1586" href="#__codelineno-2-1586"></a><span class="c1"># of seconds</span>
<a id="__codelineno-2-1587" name="__codelineno-2-1587" href="#__codelineno-2-1587"></a><span class="na">LF_DISTSMTP_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1588" name="__codelineno-2-1588" href="#__codelineno-2-1588"></a>
<a id="__codelineno-2-1589" name="__codelineno-2-1589" href="#__codelineno-2-1589"></a><span class="c1"># Send an email alert if LF_DISTSMTP is triggered</span>
<a id="__codelineno-2-1590" name="__codelineno-2-1590" href="#__codelineno-2-1590"></a><span class="na">LF_DISTSMTP_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1591" name="__codelineno-2-1591" href="#__codelineno-2-1591"></a>
<a id="__codelineno-2-1592" name="__codelineno-2-1592" href="#__codelineno-2-1592"></a><span class="c1"># This is the interval during which a distributed FTP or SMTP attack is</span>
<a id="__codelineno-2-1593" name="__codelineno-2-1593" href="#__codelineno-2-1593"></a><span class="c1"># measured</span>
<a id="__codelineno-2-1594" name="__codelineno-2-1594" href="#__codelineno-2-1594"></a><span class="na">LF_DIST_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-2-1595" name="__codelineno-2-1595" href="#__codelineno-2-1595"></a>
<a id="__codelineno-2-1596" name="__codelineno-2-1596" href="#__codelineno-2-1596"></a><span class="c1"># If LF_DISTFTP or LF_DISTSMTP is triggered, then if the following contains the</span>
<a id="__codelineno-2-1597" name="__codelineno-2-1597" href="#__codelineno-2-1597"></a><span class="c1"># path to a script, it will run the script and pass the following as arguments:</span>
<a id="__codelineno-2-1598" name="__codelineno-2-1598" href="#__codelineno-2-1598"></a><span class="c1">#</span>
<a id="__codelineno-2-1599" name="__codelineno-2-1599" href="#__codelineno-2-1599"></a><span class="c1"># LF_DISTFTP/LF_DISTSMTP</span>
<a id="__codelineno-2-1600" name="__codelineno-2-1600" href="#__codelineno-2-1600"></a><span class="c1"># account name</span>
<a id="__codelineno-2-1601" name="__codelineno-2-1601" href="#__codelineno-2-1601"></a><span class="c1"># log file text</span>
<a id="__codelineno-2-1602" name="__codelineno-2-1602" href="#__codelineno-2-1602"></a><span class="c1">#</span>
<a id="__codelineno-2-1603" name="__codelineno-2-1603" href="#__codelineno-2-1603"></a><span class="c1"># The action script must have the execute bit and interpreter (shebang) set</span>
<a id="__codelineno-2-1604" name="__codelineno-2-1604" href="#__codelineno-2-1604"></a><span class="na">LF_DIST_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1605" name="__codelineno-2-1605" href="#__codelineno-2-1605"></a>
<a id="__codelineno-2-1606" name="__codelineno-2-1606" href="#__codelineno-2-1606"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1607" name="__codelineno-2-1607" href="#__codelineno-2-1607"></a><span class="c1"># SECTION:Login Tracking</span>
<a id="__codelineno-2-1608" name="__codelineno-2-1608" href="#__codelineno-2-1608"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1609" name="__codelineno-2-1609" href="#__codelineno-2-1609"></a><span class="c1"># Block POP3 logins if greater than LT_POP3D times per hour per account per IP</span>
<a id="__codelineno-2-1610" name="__codelineno-2-1610" href="#__codelineno-2-1610"></a><span class="c1"># address (0=disabled)</span>
<a id="__codelineno-2-1611" name="__codelineno-2-1611" href="#__codelineno-2-1611"></a><span class="c1">#</span>
<a id="__codelineno-2-1612" name="__codelineno-2-1612" href="#__codelineno-2-1612"></a><span class="c1"># This is a temporary block for the rest of the hour, afterwhich the IP is</span>
<a id="__codelineno-2-1613" name="__codelineno-2-1613" href="#__codelineno-2-1613"></a><span class="c1"># unblocked</span>
<a id="__codelineno-2-1614" name="__codelineno-2-1614" href="#__codelineno-2-1614"></a><span class="c1">#</span>
<a id="__codelineno-2-1615" name="__codelineno-2-1615" href="#__codelineno-2-1615"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1616" name="__codelineno-2-1616" href="#__codelineno-2-1616"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1617" name="__codelineno-2-1617" href="#__codelineno-2-1617"></a><span class="na">LT_POP3D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1618" name="__codelineno-2-1618" href="#__codelineno-2-1618"></a>
<a id="__codelineno-2-1619" name="__codelineno-2-1619" href="#__codelineno-2-1619"></a><span class="c1"># Block IMAP logins if greater than LT_IMAPD times per hour per account per IP</span>
<a id="__codelineno-2-1620" name="__codelineno-2-1620" href="#__codelineno-2-1620"></a><span class="c1"># address (0=disabled) - not recommended for IMAP logins due to the ethos</span>
<a id="__codelineno-2-1621" name="__codelineno-2-1621" href="#__codelineno-2-1621"></a><span class="c1"># within which IMAP works. If you want to use this, setting it quite high is</span>
<a id="__codelineno-2-1622" name="__codelineno-2-1622" href="#__codelineno-2-1622"></a><span class="c1"># probably a good idea</span>
<a id="__codelineno-2-1623" name="__codelineno-2-1623" href="#__codelineno-2-1623"></a><span class="c1">#</span>
<a id="__codelineno-2-1624" name="__codelineno-2-1624" href="#__codelineno-2-1624"></a><span class="c1"># This is a temporary block for the rest of the hour, afterwhich the IP is</span>
<a id="__codelineno-2-1625" name="__codelineno-2-1625" href="#__codelineno-2-1625"></a><span class="c1"># unblocked</span>
<a id="__codelineno-2-1626" name="__codelineno-2-1626" href="#__codelineno-2-1626"></a><span class="c1">#</span>
<a id="__codelineno-2-1627" name="__codelineno-2-1627" href="#__codelineno-2-1627"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1628" name="__codelineno-2-1628" href="#__codelineno-2-1628"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1629" name="__codelineno-2-1629" href="#__codelineno-2-1629"></a><span class="na">LT_IMAPD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1630" name="__codelineno-2-1630" href="#__codelineno-2-1630"></a>
<a id="__codelineno-2-1631" name="__codelineno-2-1631" href="#__codelineno-2-1631"></a><span class="c1"># Send an email alert if an account exceeds LT_POP3D/LT_IMAPD logins per hour</span>
<a id="__codelineno-2-1632" name="__codelineno-2-1632" href="#__codelineno-2-1632"></a><span class="c1"># per IP</span>
<a id="__codelineno-2-1633" name="__codelineno-2-1633" href="#__codelineno-2-1633"></a><span class="na">LT_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1634" name="__codelineno-2-1634" href="#__codelineno-2-1634"></a>
<a id="__codelineno-2-1635" name="__codelineno-2-1635" href="#__codelineno-2-1635"></a><span class="c1"># If LF_PERMBLOCK is enabled but you do not want this to apply to</span>
<a id="__codelineno-2-1636" name="__codelineno-2-1636" href="#__codelineno-2-1636"></a><span class="c1"># LT_POP3D/LT_IMAPD, then enable this option</span>
<a id="__codelineno-2-1637" name="__codelineno-2-1637" href="#__codelineno-2-1637"></a><span class="na">LT_SKIPPERMBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1638" name="__codelineno-2-1638" href="#__codelineno-2-1638"></a>
<a id="__codelineno-2-1639" name="__codelineno-2-1639" href="#__codelineno-2-1639"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1640" name="__codelineno-2-1640" href="#__codelineno-2-1640"></a><span class="c1"># SECTION:Connection Tracking</span>
<a id="__codelineno-2-1641" name="__codelineno-2-1641" href="#__codelineno-2-1641"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1642" name="__codelineno-2-1642" href="#__codelineno-2-1642"></a><span class="c1"># Connection Tracking. This option enables tracking of all connections from IP</span>
<a id="__codelineno-2-1643" name="__codelineno-2-1643" href="#__codelineno-2-1643"></a><span class="c1"># addresses to the server. If the total number of connections is greater than</span>
<a id="__codelineno-2-1644" name="__codelineno-2-1644" href="#__codelineno-2-1644"></a><span class="c1"># this value then the offending IP address is blocked. This can be used to help</span>
<a id="__codelineno-2-1645" name="__codelineno-2-1645" href="#__codelineno-2-1645"></a><span class="c1"># prevent some types of DOS attack.</span>
<a id="__codelineno-2-1646" name="__codelineno-2-1646" href="#__codelineno-2-1646"></a><span class="c1">#</span>
<a id="__codelineno-2-1647" name="__codelineno-2-1647" href="#__codelineno-2-1647"></a><span class="c1"># Care should be taken with this option. It's entirely possible that you will</span>
<a id="__codelineno-2-1648" name="__codelineno-2-1648" href="#__codelineno-2-1648"></a><span class="c1"># see false-positives. Some protocols can be connection hungry, e.g. FTP, IMAPD</span>
<a id="__codelineno-2-1649" name="__codelineno-2-1649" href="#__codelineno-2-1649"></a><span class="c1"># and HTTP so it could be quite easy to trigger, especially with a lot of</span>
<a id="__codelineno-2-1650" name="__codelineno-2-1650" href="#__codelineno-2-1650"></a><span class="c1"># closed connections in TIME_WAIT. However, for a server that is prone to DOS</span>
<a id="__codelineno-2-1651" name="__codelineno-2-1651" href="#__codelineno-2-1651"></a><span class="c1"># attacks this may be very useful. A reasonable setting for this option might</span>
<a id="__codelineno-2-1652" name="__codelineno-2-1652" href="#__codelineno-2-1652"></a><span class="c1"># be around 300.</span>
<a id="__codelineno-2-1653" name="__codelineno-2-1653" href="#__codelineno-2-1653"></a><span class="c1">#</span>
<a id="__codelineno-2-1654" name="__codelineno-2-1654" href="#__codelineno-2-1654"></a><span class="c1"># To disable this feature, set this to 0</span>
<a id="__codelineno-2-1655" name="__codelineno-2-1655" href="#__codelineno-2-1655"></a><span class="na">CT_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1656" name="__codelineno-2-1656" href="#__codelineno-2-1656"></a>
<a id="__codelineno-2-1657" name="__codelineno-2-1657" href="#__codelineno-2-1657"></a><span class="c1"># Connection Tracking interval. Set this to the the number of seconds between</span>
<a id="__codelineno-2-1658" name="__codelineno-2-1658" href="#__codelineno-2-1658"></a><span class="c1"># connection tracking scans</span>
<a id="__codelineno-2-1659" name="__codelineno-2-1659" href="#__codelineno-2-1659"></a><span class="na">CT_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"30"</span>
<a id="__codelineno-2-1660" name="__codelineno-2-1660" href="#__codelineno-2-1660"></a>
<a id="__codelineno-2-1661" name="__codelineno-2-1661" href="#__codelineno-2-1661"></a><span class="c1"># Send an email alert if an IP address is blocked due to connection tracking</span>
<a id="__codelineno-2-1662" name="__codelineno-2-1662" href="#__codelineno-2-1662"></a><span class="na">CT_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1663" name="__codelineno-2-1663" href="#__codelineno-2-1663"></a>
<a id="__codelineno-2-1664" name="__codelineno-2-1664" href="#__codelineno-2-1664"></a><span class="c1"># If you want to make IP blocks permanent then set this to 1, otherwise blocks</span>
<a id="__codelineno-2-1665" name="__codelineno-2-1665" href="#__codelineno-2-1665"></a><span class="c1"># will be temporary and will be cleared after CT_BLOCK_TIME seconds</span>
<a id="__codelineno-2-1666" name="__codelineno-2-1666" href="#__codelineno-2-1666"></a><span class="na">CT_PERMANENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1667" name="__codelineno-2-1667" href="#__codelineno-2-1667"></a>
<a id="__codelineno-2-1668" name="__codelineno-2-1668" href="#__codelineno-2-1668"></a><span class="c1"># If you opt for temporary IP blocks for CT, then the following is the interval</span>
<a id="__codelineno-2-1669" name="__codelineno-2-1669" href="#__codelineno-2-1669"></a><span class="c1"># in seconds that the IP will remained blocked for (e.g. 1800 = 30 mins)</span>
<a id="__codelineno-2-1670" name="__codelineno-2-1670" href="#__codelineno-2-1670"></a><span class="na">CT_BLOCK_TIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1800"</span>
<a id="__codelineno-2-1671" name="__codelineno-2-1671" href="#__codelineno-2-1671"></a>
<a id="__codelineno-2-1672" name="__codelineno-2-1672" href="#__codelineno-2-1672"></a><span class="c1"># If you don't want to count the TIME_WAIT state against the connection count</span>
<a id="__codelineno-2-1673" name="__codelineno-2-1673" href="#__codelineno-2-1673"></a><span class="c1"># then set the following to "1"</span>
<a id="__codelineno-2-1674" name="__codelineno-2-1674" href="#__codelineno-2-1674"></a><span class="na">CT_SKIP_TIME_WAIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1675" name="__codelineno-2-1675" href="#__codelineno-2-1675"></a>
<a id="__codelineno-2-1676" name="__codelineno-2-1676" href="#__codelineno-2-1676"></a><span class="c1"># If you only want to count specific states (e.g. SYN_RECV) then add the states</span>
<a id="__codelineno-2-1677" name="__codelineno-2-1677" href="#__codelineno-2-1677"></a><span class="c1"># to the following as a comma separated list. E.g. "SYN_RECV,TIME_WAIT"</span>
<a id="__codelineno-2-1678" name="__codelineno-2-1678" href="#__codelineno-2-1678"></a><span class="c1">#</span>
<a id="__codelineno-2-1679" name="__codelineno-2-1679" href="#__codelineno-2-1679"></a><span class="c1"># Leave this option empty to count all states against CT_LIMIT</span>
<a id="__codelineno-2-1680" name="__codelineno-2-1680" href="#__codelineno-2-1680"></a><span class="na">CT_STATES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1681" name="__codelineno-2-1681" href="#__codelineno-2-1681"></a>
<a id="__codelineno-2-1682" name="__codelineno-2-1682" href="#__codelineno-2-1682"></a><span class="c1"># If you only want to count specific ports (e.g. 80,443) then add the ports</span>
<a id="__codelineno-2-1683" name="__codelineno-2-1683" href="#__codelineno-2-1683"></a><span class="c1"># to the following as a comma separated list. E.g. "80,443"</span>
<a id="__codelineno-2-1684" name="__codelineno-2-1684" href="#__codelineno-2-1684"></a><span class="c1">#</span>
<a id="__codelineno-2-1685" name="__codelineno-2-1685" href="#__codelineno-2-1685"></a><span class="c1"># Leave this option empty to count all ports against CT_LIMIT</span>
<a id="__codelineno-2-1686" name="__codelineno-2-1686" href="#__codelineno-2-1686"></a><span class="na">CT_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1687" name="__codelineno-2-1687" href="#__codelineno-2-1687"></a>
<a id="__codelineno-2-1688" name="__codelineno-2-1688" href="#__codelineno-2-1688"></a><span class="c1"># If the total number of connections from a class C subnet is greater than this</span>
<a id="__codelineno-2-1689" name="__codelineno-2-1689" href="#__codelineno-2-1689"></a><span class="c1"># value then the offending subnet is blocked according to the other CT_*</span>
<a id="__codelineno-2-1690" name="__codelineno-2-1690" href="#__codelineno-2-1690"></a><span class="c1"># settings</span>
<a id="__codelineno-2-1691" name="__codelineno-2-1691" href="#__codelineno-2-1691"></a><span class="c1">#</span>
<a id="__codelineno-2-1692" name="__codelineno-2-1692" href="#__codelineno-2-1692"></a><span class="c1"># This option can be used to help prevent some types of DOS attack where a</span>
<a id="__codelineno-2-1693" name="__codelineno-2-1693" href="#__codelineno-2-1693"></a><span class="c1"># range of IP's between x.y.z.1-255 has connected to the server</span>
<a id="__codelineno-2-1694" name="__codelineno-2-1694" href="#__codelineno-2-1694"></a><span class="c1">#</span>
<a id="__codelineno-2-1695" name="__codelineno-2-1695" href="#__codelineno-2-1695"></a><span class="c1"># If you use a reverse proxy service such as Cloudflare you should not enable</span>
<a id="__codelineno-2-1696" name="__codelineno-2-1696" href="#__codelineno-2-1696"></a><span class="c1"># this option, or should exclude the ports that you have proxied in CT_PORTS</span>
<a id="__codelineno-2-1697" name="__codelineno-2-1697" href="#__codelineno-2-1697"></a><span class="c1">#</span>
<a id="__codelineno-2-1698" name="__codelineno-2-1698" href="#__codelineno-2-1698"></a><span class="c1"># To disable this feature, set this to 0</span>
<a id="__codelineno-2-1699" name="__codelineno-2-1699" href="#__codelineno-2-1699"></a><span class="na">CT_SUBNET_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1700" name="__codelineno-2-1700" href="#__codelineno-2-1700"></a>
<a id="__codelineno-2-1701" name="__codelineno-2-1701" href="#__codelineno-2-1701"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1702" name="__codelineno-2-1702" href="#__codelineno-2-1702"></a><span class="c1"># SECTION:Process Tracking</span>
<a id="__codelineno-2-1703" name="__codelineno-2-1703" href="#__codelineno-2-1703"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1704" name="__codelineno-2-1704" href="#__codelineno-2-1704"></a><span class="c1"># Process Tracking. This option enables tracking of user and nobody processes</span>
<a id="__codelineno-2-1705" name="__codelineno-2-1705" href="#__codelineno-2-1705"></a><span class="c1"># and examines them for suspicious executables or open network ports. Its</span>
<a id="__codelineno-2-1706" name="__codelineno-2-1706" href="#__codelineno-2-1706"></a><span class="c1"># purpose is to identify potential exploit processes that are running on the</span>
<a id="__codelineno-2-1707" name="__codelineno-2-1707" href="#__codelineno-2-1707"></a><span class="c1"># server, even if they are obfuscated to appear as system services. If a</span>
<a id="__codelineno-2-1708" name="__codelineno-2-1708" href="#__codelineno-2-1708"></a><span class="c1"># suspicious process is found an alert email is sent with relevant information.</span>
<a id="__codelineno-2-1709" name="__codelineno-2-1709" href="#__codelineno-2-1709"></a><span class="c1"># It is then the responsibility of the recipient to investigate the process</span>
<a id="__codelineno-2-1710" name="__codelineno-2-1710" href="#__codelineno-2-1710"></a><span class="c1"># further as the script takes no further action</span>
<a id="__codelineno-2-1711" name="__codelineno-2-1711" href="#__codelineno-2-1711"></a><span class="c1">#</span>
<a id="__codelineno-2-1712" name="__codelineno-2-1712" href="#__codelineno-2-1712"></a><span class="c1"># The following is the number of seconds a process has to be active before it</span>
<a id="__codelineno-2-1713" name="__codelineno-2-1713" href="#__codelineno-2-1713"></a><span class="c1"># is inspected. If you set this time too low, then you will likely trigger</span>
<a id="__codelineno-2-1714" name="__codelineno-2-1714" href="#__codelineno-2-1714"></a><span class="c1"># false-positives with CGI or PHP scripts.</span>
<a id="__codelineno-2-1715" name="__codelineno-2-1715" href="#__codelineno-2-1715"></a><span class="c1"># Set the value to 0 to disable this feature</span>
<a id="__codelineno-2-1716" name="__codelineno-2-1716" href="#__codelineno-2-1716"></a><span class="na">PT_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"60"</span>
<a id="__codelineno-2-1717" name="__codelineno-2-1717" href="#__codelineno-2-1717"></a>
<a id="__codelineno-2-1718" name="__codelineno-2-1718" href="#__codelineno-2-1718"></a><span class="c1"># How frequently processes are checked in seconds</span>
<a id="__codelineno-2-1719" name="__codelineno-2-1719" href="#__codelineno-2-1719"></a><span class="na">PT_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"60"</span>
<a id="__codelineno-2-1720" name="__codelineno-2-1720" href="#__codelineno-2-1720"></a>
<a id="__codelineno-2-1721" name="__codelineno-2-1721" href="#__codelineno-2-1721"></a><span class="c1"># If you want process tracking to highlight php or perl scripts that are run</span>
<a id="__codelineno-2-1722" name="__codelineno-2-1722" href="#__codelineno-2-1722"></a><span class="c1"># through apache then disable the following,</span>
<a id="__codelineno-2-1723" name="__codelineno-2-1723" href="#__codelineno-2-1723"></a><span class="c1"># i.e. set it to 0</span>
<a id="__codelineno-2-1724" name="__codelineno-2-1724" href="#__codelineno-2-1724"></a><span class="c1">#</span>
<a id="__codelineno-2-1725" name="__codelineno-2-1725" href="#__codelineno-2-1725"></a><span class="c1"># While enabling this setting will reduce false-positives, having it set to 0</span>
<a id="__codelineno-2-1726" name="__codelineno-2-1726" href="#__codelineno-2-1726"></a><span class="c1"># does provide better checking for exploits running on the server</span>
<a id="__codelineno-2-1727" name="__codelineno-2-1727" href="#__codelineno-2-1727"></a><span class="na">PT_SKIP_HTTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1728" name="__codelineno-2-1728" href="#__codelineno-2-1728"></a>
<a id="__codelineno-2-1729" name="__codelineno-2-1729" href="#__codelineno-2-1729"></a><span class="c1"># lfd will report processes, even if they're listed in csf.pignore, if they're</span>
<a id="__codelineno-2-1730" name="__codelineno-2-1730" href="#__codelineno-2-1730"></a><span class="c1"># tagged as (deleted) by Linux. This information is provided in Linux under</span>
<a id="__codelineno-2-1731" name="__codelineno-2-1731" href="#__codelineno-2-1731"></a><span class="c1"># /proc/PID/exe. A (deleted) process is one that is running a binary that has</span>
<a id="__codelineno-2-1732" name="__codelineno-2-1732" href="#__codelineno-2-1732"></a><span class="c1"># the inode for the file removed from the file system directory. This usually</span>
<a id="__codelineno-2-1733" name="__codelineno-2-1733" href="#__codelineno-2-1733"></a><span class="c1"># happens when the binary has been replaced due to an upgrade for it by the OS</span>
<a id="__codelineno-2-1734" name="__codelineno-2-1734" href="#__codelineno-2-1734"></a><span class="c1"># vendor or another third party (e.g. cPanel). You need to investigate whether</span>
<a id="__codelineno-2-1735" name="__codelineno-2-1735" href="#__codelineno-2-1735"></a><span class="c1"># this is indeed the case to be sure that the original binary has not been</span>
<a id="__codelineno-2-1736" name="__codelineno-2-1736" href="#__codelineno-2-1736"></a><span class="c1"># replaced by a rootkit or is running an exploit.</span>
<a id="__codelineno-2-1737" name="__codelineno-2-1737" href="#__codelineno-2-1737"></a><span class="c1">#</span>
<a id="__codelineno-2-1738" name="__codelineno-2-1738" href="#__codelineno-2-1738"></a><span class="c1"># Note: If a deleted executable process is detected and reported then lfd will</span>
<a id="__codelineno-2-1739" name="__codelineno-2-1739" href="#__codelineno-2-1739"></a><span class="c1"># not report children of the parent (or the parent itself if a child triggered</span>
<a id="__codelineno-2-1740" name="__codelineno-2-1740" href="#__codelineno-2-1740"></a><span class="c1"># the report) if the parent is also a deleted executable process</span>
<a id="__codelineno-2-1741" name="__codelineno-2-1741" href="#__codelineno-2-1741"></a><span class="c1">#</span>
<a id="__codelineno-2-1742" name="__codelineno-2-1742" href="#__codelineno-2-1742"></a><span class="c1"># To stop lfd reporting such process you need to restart the daemon to which it</span>
<a id="__codelineno-2-1743" name="__codelineno-2-1743" href="#__codelineno-2-1743"></a><span class="c1"># belongs and therefore run the process using the replacement binary (presuming</span>
<a id="__codelineno-2-1744" name="__codelineno-2-1744" href="#__codelineno-2-1744"></a><span class="c1"># one exists). This will normally mean running the associated startup script in</span>
<a id="__codelineno-2-1745" name="__codelineno-2-1745" href="#__codelineno-2-1745"></a><span class="c1"># /etc/init.d/</span>
<a id="__codelineno-2-1746" name="__codelineno-2-1746" href="#__codelineno-2-1746"></a><span class="c1">#</span>
<a id="__codelineno-2-1747" name="__codelineno-2-1747" href="#__codelineno-2-1747"></a><span class="c1"># If you do want lfd to report deleted binary processes, set to 1</span>
<a id="__codelineno-2-1748" name="__codelineno-2-1748" href="#__codelineno-2-1748"></a><span class="na">PT_DELETED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1749" name="__codelineno-2-1749" href="#__codelineno-2-1749"></a>
<a id="__codelineno-2-1750" name="__codelineno-2-1750" href="#__codelineno-2-1750"></a><span class="c1"># If a PT_DELETED event is triggered, then if the following contains the path to</span>
<a id="__codelineno-2-1751" name="__codelineno-2-1751" href="#__codelineno-2-1751"></a><span class="c1"># a script, it will be run in a child process and passed the executable, pid,</span>
<a id="__codelineno-2-1752" name="__codelineno-2-1752" href="#__codelineno-2-1752"></a><span class="c1"># account for the process, and parent pid</span>
<a id="__codelineno-2-1753" name="__codelineno-2-1753" href="#__codelineno-2-1753"></a><span class="c1">#</span>
<a id="__codelineno-2-1754" name="__codelineno-2-1754" href="#__codelineno-2-1754"></a><span class="c1"># The action script must have the execute bit and interpreter (shebang) set. An</span>
<a id="__codelineno-2-1755" name="__codelineno-2-1755" href="#__codelineno-2-1755"></a><span class="c1"># example is provided in /usr/local/csf/bin/pt_deleted_action.pl</span>
<a id="__codelineno-2-1756" name="__codelineno-2-1756" href="#__codelineno-2-1756"></a><span class="c1">#</span>
<a id="__codelineno-2-1757" name="__codelineno-2-1757" href="#__codelineno-2-1757"></a><span class="c1"># WARNING: Make sure you read and understand the potential security</span>
<a id="__codelineno-2-1758" name="__codelineno-2-1758" href="#__codelineno-2-1758"></a><span class="c1"># implications of such processes in PT_DELETED above before simply restarting</span>
<a id="__codelineno-2-1759" name="__codelineno-2-1759" href="#__codelineno-2-1759"></a><span class="c1"># such processes with a script</span>
<a id="__codelineno-2-1760" name="__codelineno-2-1760" href="#__codelineno-2-1760"></a><span class="na">PT_DELETED_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1761" name="__codelineno-2-1761" href="#__codelineno-2-1761"></a>
<a id="__codelineno-2-1762" name="__codelineno-2-1762" href="#__codelineno-2-1762"></a><span class="c1"># User Process Tracking. This option enables the tracking of the number of</span>
<a id="__codelineno-2-1763" name="__codelineno-2-1763" href="#__codelineno-2-1763"></a><span class="c1"># process any given account is running at one time. If the number of processes</span>
<a id="__codelineno-2-1764" name="__codelineno-2-1764" href="#__codelineno-2-1764"></a><span class="c1"># exceeds the value of the following setting an email alert is sent with</span>
<a id="__codelineno-2-1765" name="__codelineno-2-1765" href="#__codelineno-2-1765"></a><span class="c1"># details of those processes. If you specify a user in csf.pignore it will be</span>
<a id="__codelineno-2-1766" name="__codelineno-2-1766" href="#__codelineno-2-1766"></a><span class="c1"># ignored</span>
<a id="__codelineno-2-1767" name="__codelineno-2-1767" href="#__codelineno-2-1767"></a><span class="c1">#</span>
<a id="__codelineno-2-1768" name="__codelineno-2-1768" href="#__codelineno-2-1768"></a><span class="c1"># Set to 0 to disable this feature</span>
<a id="__codelineno-2-1769" name="__codelineno-2-1769" href="#__codelineno-2-1769"></a><span class="na">PT_USERPROC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-2-1770" name="__codelineno-2-1770" href="#__codelineno-2-1770"></a>
<a id="__codelineno-2-1771" name="__codelineno-2-1771" href="#__codelineno-2-1771"></a><span class="c1"># This User Process Tracking option sends an alert if any user process exceeds</span>
<a id="__codelineno-2-1772" name="__codelineno-2-1772" href="#__codelineno-2-1772"></a><span class="c1"># the virtual memory usage set (MB). To ignore specific processes or users use</span>
<a id="__codelineno-2-1773" name="__codelineno-2-1773" href="#__codelineno-2-1773"></a><span class="c1"># csf.pignore</span>
<a id="__codelineno-2-1774" name="__codelineno-2-1774" href="#__codelineno-2-1774"></a><span class="c1">#</span>
<a id="__codelineno-2-1775" name="__codelineno-2-1775" href="#__codelineno-2-1775"></a><span class="c1"># Set to 0 to disable this feature</span>
<a id="__codelineno-2-1776" name="__codelineno-2-1776" href="#__codelineno-2-1776"></a><span class="na">PT_USERMEM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"512"</span>
<a id="__codelineno-2-1777" name="__codelineno-2-1777" href="#__codelineno-2-1777"></a>
<a id="__codelineno-2-1778" name="__codelineno-2-1778" href="#__codelineno-2-1778"></a><span class="c1"># This User Process Tracking option sends an alert if any user process exceeds</span>
<a id="__codelineno-2-1779" name="__codelineno-2-1779" href="#__codelineno-2-1779"></a><span class="c1"># the RSS memory usage set (MB) - RAM used, not virtual. To ignore specific</span>
<a id="__codelineno-2-1780" name="__codelineno-2-1780" href="#__codelineno-2-1780"></a><span class="c1"># processes or users use csf.pignore</span>
<a id="__codelineno-2-1781" name="__codelineno-2-1781" href="#__codelineno-2-1781"></a><span class="c1">#</span>
<a id="__codelineno-2-1782" name="__codelineno-2-1782" href="#__codelineno-2-1782"></a><span class="c1"># Set to 0 to disable this feature</span>
<a id="__codelineno-2-1783" name="__codelineno-2-1783" href="#__codelineno-2-1783"></a><span class="na">PT_USERRSS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"256"</span>
<a id="__codelineno-2-1784" name="__codelineno-2-1784" href="#__codelineno-2-1784"></a>
<a id="__codelineno-2-1785" name="__codelineno-2-1785" href="#__codelineno-2-1785"></a><span class="c1"># This User Process Tracking option sends an alert if any linux user process</span>
<a id="__codelineno-2-1786" name="__codelineno-2-1786" href="#__codelineno-2-1786"></a><span class="c1"># exceeds the time usage set (seconds). To ignore specific processes or users</span>
<a id="__codelineno-2-1787" name="__codelineno-2-1787" href="#__codelineno-2-1787"></a><span class="c1"># use csf.pignore</span>
<a id="__codelineno-2-1788" name="__codelineno-2-1788" href="#__codelineno-2-1788"></a><span class="c1">#</span>
<a id="__codelineno-2-1789" name="__codelineno-2-1789" href="#__codelineno-2-1789"></a><span class="c1"># Set to 0 to disable this feature</span>
<a id="__codelineno-2-1790" name="__codelineno-2-1790" href="#__codelineno-2-1790"></a><span class="na">PT_USERTIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1800"</span>
<a id="__codelineno-2-1791" name="__codelineno-2-1791" href="#__codelineno-2-1791"></a>
<a id="__codelineno-2-1792" name="__codelineno-2-1792" href="#__codelineno-2-1792"></a><span class="c1"># If this option is set then processes detected by PT_USERMEM, PT_USERTIME or</span>
<a id="__codelineno-2-1793" name="__codelineno-2-1793" href="#__codelineno-2-1793"></a><span class="c1"># PT_USERPROC are killed</span>
<a id="__codelineno-2-1794" name="__codelineno-2-1794" href="#__codelineno-2-1794"></a><span class="c1">#</span>
<a id="__codelineno-2-1795" name="__codelineno-2-1795" href="#__codelineno-2-1795"></a><span class="c1"># Warning: We don't recommend enabling this option unless absolutely necessary</span>
<a id="__codelineno-2-1796" name="__codelineno-2-1796" href="#__codelineno-2-1796"></a><span class="c1"># as it can cause unexpected problems when processes are suddenly terminated.</span>
<a id="__codelineno-2-1797" name="__codelineno-2-1797" href="#__codelineno-2-1797"></a><span class="c1"># It can also lead to system processes being terminated which could cause</span>
<a id="__codelineno-2-1798" name="__codelineno-2-1798" href="#__codelineno-2-1798"></a><span class="c1"># stability issues. It is much better to leave this option disabled and to</span>
<a id="__codelineno-2-1799" name="__codelineno-2-1799" href="#__codelineno-2-1799"></a><span class="c1"># investigate each case as it is reported when the triggers above are breached</span>
<a id="__codelineno-2-1800" name="__codelineno-2-1800" href="#__codelineno-2-1800"></a><span class="c1">#</span>
<a id="__codelineno-2-1801" name="__codelineno-2-1801" href="#__codelineno-2-1801"></a><span class="c1"># Note: Processes that are running deleted excecutables (see PT_DELETED) will</span>
<a id="__codelineno-2-1802" name="__codelineno-2-1802" href="#__codelineno-2-1802"></a><span class="c1"># not be killed by lfd</span>
<a id="__codelineno-2-1803" name="__codelineno-2-1803" href="#__codelineno-2-1803"></a><span class="na">PT_USERKILL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1804" name="__codelineno-2-1804" href="#__codelineno-2-1804"></a>
<a id="__codelineno-2-1805" name="__codelineno-2-1805" href="#__codelineno-2-1805"></a><span class="c1"># If you want to disable email alerts if PT_USERKILL is triggered, then set</span>
<a id="__codelineno-2-1806" name="__codelineno-2-1806" href="#__codelineno-2-1806"></a><span class="c1"># this option to 0</span>
<a id="__codelineno-2-1807" name="__codelineno-2-1807" href="#__codelineno-2-1807"></a><span class="na">PT_USERKILL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1808" name="__codelineno-2-1808" href="#__codelineno-2-1808"></a>
<a id="__codelineno-2-1809" name="__codelineno-2-1809" href="#__codelineno-2-1809"></a><span class="c1"># If a PT_* event is triggered, then if the following contains the path to</span>
<a id="__codelineno-2-1810" name="__codelineno-2-1810" href="#__codelineno-2-1810"></a><span class="c1"># a script, it will be run in a child process and passed the PID(s) of the</span>
<a id="__codelineno-2-1811" name="__codelineno-2-1811" href="#__codelineno-2-1811"></a><span class="c1"># process(es) in a comma separated list.</span>
<a id="__codelineno-2-1812" name="__codelineno-2-1812" href="#__codelineno-2-1812"></a><span class="c1">#</span>
<a id="__codelineno-2-1813" name="__codelineno-2-1813" href="#__codelineno-2-1813"></a><span class="c1"># The action script must have the execute bit and interpreter (shebang) set</span>
<a id="__codelineno-2-1814" name="__codelineno-2-1814" href="#__codelineno-2-1814"></a><span class="na">PT_USER_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1815" name="__codelineno-2-1815" href="#__codelineno-2-1815"></a>
<a id="__codelineno-2-1816" name="__codelineno-2-1816" href="#__codelineno-2-1816"></a><span class="c1"># Check the PT_LOAD_AVG minute Load Average (can be set to 1 5 or 15 and</span>
<a id="__codelineno-2-1817" name="__codelineno-2-1817" href="#__codelineno-2-1817"></a><span class="c1"># defaults to 5 if set otherwise) on the server every PT_LOAD seconds. If the</span>
<a id="__codelineno-2-1818" name="__codelineno-2-1818" href="#__codelineno-2-1818"></a><span class="c1"># load average is greater than or equal to PT_LOAD_LEVEL then an email alert is</span>
<a id="__codelineno-2-1819" name="__codelineno-2-1819" href="#__codelineno-2-1819"></a><span class="c1"># sent. lfd then does not report subsequent high load until PT_LOAD_SKIP</span>
<a id="__codelineno-2-1820" name="__codelineno-2-1820" href="#__codelineno-2-1820"></a><span class="c1"># seconds has passed to prevent email floods.</span>
<a id="__codelineno-2-1821" name="__codelineno-2-1821" href="#__codelineno-2-1821"></a><span class="c1">#</span>
<a id="__codelineno-2-1822" name="__codelineno-2-1822" href="#__codelineno-2-1822"></a><span class="c1"># Set PT_LOAD to "0" to disable this feature</span>
<a id="__codelineno-2-1823" name="__codelineno-2-1823" href="#__codelineno-2-1823"></a><span class="na">PT_LOAD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"30"</span>
<a id="__codelineno-2-1824" name="__codelineno-2-1824" href="#__codelineno-2-1824"></a><span class="na">PT_LOAD_AVG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-1825" name="__codelineno-2-1825" href="#__codelineno-2-1825"></a><span class="na">PT_LOAD_LEVEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"6"</span>
<a id="__codelineno-2-1826" name="__codelineno-2-1826" href="#__codelineno-2-1826"></a><span class="na">PT_LOAD_SKIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1827" name="__codelineno-2-1827" href="#__codelineno-2-1827"></a>
<a id="__codelineno-2-1828" name="__codelineno-2-1828" href="#__codelineno-2-1828"></a><span class="c1"># This is the Apache Server Status URL used in the email alert. Requires the</span>
<a id="__codelineno-2-1829" name="__codelineno-2-1829" href="#__codelineno-2-1829"></a><span class="c1"># Apache mod_status module to be installed and configured correctly</span>
<a id="__codelineno-2-1830" name="__codelineno-2-1830" href="#__codelineno-2-1830"></a><span class="na">PT_APACHESTATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://127.0.0.1/server-status"</span>
<a id="__codelineno-2-1831" name="__codelineno-2-1831" href="#__codelineno-2-1831"></a>
<a id="__codelineno-2-1832" name="__codelineno-2-1832" href="#__codelineno-2-1832"></a><span class="c1"># If a PT_LOAD event is triggered, then if the following contains the path to</span>
<a id="__codelineno-2-1833" name="__codelineno-2-1833" href="#__codelineno-2-1833"></a><span class="c1"># a script, it will be run in a child process. For example, the script could</span>
<a id="__codelineno-2-1834" name="__codelineno-2-1834" href="#__codelineno-2-1834"></a><span class="c1"># contain commands to terminate and restart httpd, php, exim, etc incase of</span>
<a id="__codelineno-2-1835" name="__codelineno-2-1835" href="#__codelineno-2-1835"></a><span class="c1"># looping processes. The action script must have the execute bit an </span>
<a id="__codelineno-2-1836" name="__codelineno-2-1836" href="#__codelineno-2-1836"></a><span class="c1"># interpreter (shebang) set</span>
<a id="__codelineno-2-1837" name="__codelineno-2-1837" href="#__codelineno-2-1837"></a><span class="na">PT_LOAD_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-1838" name="__codelineno-2-1838" href="#__codelineno-2-1838"></a>
<a id="__codelineno-2-1839" name="__codelineno-2-1839" href="#__codelineno-2-1839"></a><span class="c1"># Fork Bomb Protection. This option checks the number of processes with the</span>
<a id="__codelineno-2-1840" name="__codelineno-2-1840" href="#__codelineno-2-1840"></a><span class="c1"># same session id and if greater than the value set, the whole session tree is</span>
<a id="__codelineno-2-1841" name="__codelineno-2-1841" href="#__codelineno-2-1841"></a><span class="c1"># terminated and an alert sent</span>
<a id="__codelineno-2-1842" name="__codelineno-2-1842" href="#__codelineno-2-1842"></a><span class="c1">#</span>
<a id="__codelineno-2-1843" name="__codelineno-2-1843" href="#__codelineno-2-1843"></a><span class="c1"># You can see an example of common session id processes on most Linux systems</span>
<a id="__codelineno-2-1844" name="__codelineno-2-1844" href="#__codelineno-2-1844"></a><span class="c1"># using: "ps axf -O sid"</span>
<a id="__codelineno-2-1845" name="__codelineno-2-1845" href="#__codelineno-2-1845"></a><span class="c1">#</span>
<a id="__codelineno-2-1846" name="__codelineno-2-1846" href="#__codelineno-2-1846"></a><span class="c1"># On cPanel servers, PT_ALL_USERS should be enabled to use this option</span>
<a id="__codelineno-2-1847" name="__codelineno-2-1847" href="#__codelineno-2-1847"></a><span class="c1"># effectively</span>
<a id="__codelineno-2-1848" name="__codelineno-2-1848" href="#__codelineno-2-1848"></a><span class="c1">#</span>
<a id="__codelineno-2-1849" name="__codelineno-2-1849" href="#__codelineno-2-1849"></a><span class="c1"># This option will check root owned processes. Session id 0 and 1 will always</span>
<a id="__codelineno-2-1850" name="__codelineno-2-1850" href="#__codelineno-2-1850"></a><span class="c1"># be ignored as they represent kernel and init processes. csf.pignore will be</span>
<a id="__codelineno-2-1851" name="__codelineno-2-1851" href="#__codelineno-2-1851"></a><span class="c1"># honoured, but bear in mind that a session tree can contain a variety of users</span>
<a id="__codelineno-2-1852" name="__codelineno-2-1852" href="#__codelineno-2-1852"></a><span class="c1"># and executables</span>
<a id="__codelineno-2-1853" name="__codelineno-2-1853" href="#__codelineno-2-1853"></a><span class="c1">#</span>
<a id="__codelineno-2-1854" name="__codelineno-2-1854" href="#__codelineno-2-1854"></a><span class="c1"># Care needs to be taken to ensure that this option only detects runaway fork</span>
<a id="__codelineno-2-1855" name="__codelineno-2-1855" href="#__codelineno-2-1855"></a><span class="c1"># bombs, so should be set higher than any session tree is likely to get (e.g.</span>
<a id="__codelineno-2-1856" name="__codelineno-2-1856" href="#__codelineno-2-1856"></a><span class="c1"># httpd could have 100s of legitimate children on very busy systems). A</span>
<a id="__codelineno-2-1857" name="__codelineno-2-1857" href="#__codelineno-2-1857"></a><span class="c1"># sensible starting point on most servers might be 250</span>
<a id="__codelineno-2-1858" name="__codelineno-2-1858" href="#__codelineno-2-1858"></a><span class="na">PT_FORKBOMB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1859" name="__codelineno-2-1859" href="#__codelineno-2-1859"></a>
<a id="__codelineno-2-1860" name="__codelineno-2-1860" href="#__codelineno-2-1860"></a><span class="c1"># Terminate hung SSHD sessions. When under an SSHD login attack, SSHD processes</span>
<a id="__codelineno-2-1861" name="__codelineno-2-1861" href="#__codelineno-2-1861"></a><span class="c1"># are often left hanging after their connecting IP addresses have been blocked</span>
<a id="__codelineno-2-1862" name="__codelineno-2-1862" href="#__codelineno-2-1862"></a><span class="c1">#</span>
<a id="__codelineno-2-1863" name="__codelineno-2-1863" href="#__codelineno-2-1863"></a><span class="c1"># This option will terminate the SSH processes created by the blocked IP. This</span>
<a id="__codelineno-2-1864" name="__codelineno-2-1864" href="#__codelineno-2-1864"></a><span class="c1"># option is preferred over PT_SSHDHUNG</span>
<a id="__codelineno-2-1865" name="__codelineno-2-1865" href="#__codelineno-2-1865"></a><span class="na">PT_SSHDKILL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1866" name="__codelineno-2-1866" href="#__codelineno-2-1866"></a>
<a id="__codelineno-2-1867" name="__codelineno-2-1867" href="#__codelineno-2-1867"></a><span class="c1"># This option will terminate all processes with the cmdline of "sshd: unknown</span>
<a id="__codelineno-2-1868" name="__codelineno-2-1868" href="#__codelineno-2-1868"></a><span class="c1"># [net]" or "sshd: unknown [priv]" if they have been running for more than 60</span>
<a id="__codelineno-2-1869" name="__codelineno-2-1869" href="#__codelineno-2-1869"></a><span class="c1"># seconds</span>
<a id="__codelineno-2-1870" name="__codelineno-2-1870" href="#__codelineno-2-1870"></a><span class="na">PT_SSHDHUNG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1871" name="__codelineno-2-1871" href="#__codelineno-2-1871"></a>
<a id="__codelineno-2-1872" name="__codelineno-2-1872" href="#__codelineno-2-1872"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1873" name="__codelineno-2-1873" href="#__codelineno-2-1873"></a><span class="c1"># SECTION:Port Scan Tracking</span>
<a id="__codelineno-2-1874" name="__codelineno-2-1874" href="#__codelineno-2-1874"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1875" name="__codelineno-2-1875" href="#__codelineno-2-1875"></a><span class="c1"># Port Scan Tracking. This feature tracks port blocks logged by iptables to</span>
<a id="__codelineno-2-1876" name="__codelineno-2-1876" href="#__codelineno-2-1876"></a><span class="c1"># syslog. If an IP address generates a port block that is logged more than</span>
<a id="__codelineno-2-1877" name="__codelineno-2-1877" href="#__codelineno-2-1877"></a><span class="c1"># PS_LIMIT within PS_INTERVAL seconds, the IP address will be blocked.</span>
<a id="__codelineno-2-1878" name="__codelineno-2-1878" href="#__codelineno-2-1878"></a><span class="c1">#</span>
<a id="__codelineno-2-1879" name="__codelineno-2-1879" href="#__codelineno-2-1879"></a><span class="c1"># This feature could, for example, be useful for blocking hackers attempting</span>
<a id="__codelineno-2-1880" name="__codelineno-2-1880" href="#__codelineno-2-1880"></a><span class="c1"># to access the standard SSH port if you have moved it to a port other than 22</span>
<a id="__codelineno-2-1881" name="__codelineno-2-1881" href="#__codelineno-2-1881"></a><span class="c1"># and have removed 22 from the TCP_IN list so that connection attempts to the</span>
<a id="__codelineno-2-1882" name="__codelineno-2-1882" href="#__codelineno-2-1882"></a><span class="c1"># old port are being logged</span>
<a id="__codelineno-2-1883" name="__codelineno-2-1883" href="#__codelineno-2-1883"></a><span class="c1">#</span>
<a id="__codelineno-2-1884" name="__codelineno-2-1884" href="#__codelineno-2-1884"></a><span class="c1"># This feature blocks all iptables blocks from the iptables logs, including</span>
<a id="__codelineno-2-1885" name="__codelineno-2-1885" href="#__codelineno-2-1885"></a><span class="c1"># repeated attempts to one port or SYN flood blocks, etc</span>
<a id="__codelineno-2-1886" name="__codelineno-2-1886" href="#__codelineno-2-1886"></a><span class="c1">#</span>
<a id="__codelineno-2-1887" name="__codelineno-2-1887" href="#__codelineno-2-1887"></a><span class="c1"># Note: This feature will only track iptables blocks from the log file set in</span>
<a id="__codelineno-2-1888" name="__codelineno-2-1888" href="#__codelineno-2-1888"></a><span class="c1"># IPTABLES_LOG below and if you have DROP_LOGGING enabled. However, it will</span>
<a id="__codelineno-2-1889" name="__codelineno-2-1889" href="#__codelineno-2-1889"></a><span class="c1"># cause redundant blocking with DROP_IP_LOGGING enabled</span>
<a id="__codelineno-2-1890" name="__codelineno-2-1890" href="#__codelineno-2-1890"></a><span class="c1">#</span>
<a id="__codelineno-2-1891" name="__codelineno-2-1891" href="#__codelineno-2-1891"></a><span class="c1"># Warning: It's possible that an elaborate DDOS (i.e. from multiple IP's)</span>
<a id="__codelineno-2-1892" name="__codelineno-2-1892" href="#__codelineno-2-1892"></a><span class="c1"># could very quickly fill the iptables rule chains and cause a DOS in itself.</span>
<a id="__codelineno-2-1893" name="__codelineno-2-1893" href="#__codelineno-2-1893"></a><span class="c1"># The DENY_IP_LIMIT should help to mitigate such problems with permanent blocks</span>
<a id="__codelineno-2-1894" name="__codelineno-2-1894" href="#__codelineno-2-1894"></a><span class="c1"># and the DENY_TEMP_IP_LIMIT with temporary blocks</span>
<a id="__codelineno-2-1895" name="__codelineno-2-1895" href="#__codelineno-2-1895"></a><span class="c1">#</span>
<a id="__codelineno-2-1896" name="__codelineno-2-1896" href="#__codelineno-2-1896"></a><span class="c1"># Set PS_INTERVAL to "0" to disable this feature. A value of between 60 and 300</span>
<a id="__codelineno-2-1897" name="__codelineno-2-1897" href="#__codelineno-2-1897"></a><span class="c1"># would be sensible to enable this feature</span>
<a id="__codelineno-2-1898" name="__codelineno-2-1898" href="#__codelineno-2-1898"></a><span class="c1">#</span>
<a id="__codelineno-2-1899" name="__codelineno-2-1899" href="#__codelineno-2-1899"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1900" name="__codelineno-2-1900" href="#__codelineno-2-1900"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1901" name="__codelineno-2-1901" href="#__codelineno-2-1901"></a><span class="na">PS_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1902" name="__codelineno-2-1902" href="#__codelineno-2-1902"></a><span class="na">PS_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-2-1903" name="__codelineno-2-1903" href="#__codelineno-2-1903"></a>
<a id="__codelineno-2-1904" name="__codelineno-2-1904" href="#__codelineno-2-1904"></a><span class="c1"># You can specify the ports and/or port ranges that should be tracked by the</span>
<a id="__codelineno-2-1905" name="__codelineno-2-1905" href="#__codelineno-2-1905"></a><span class="c1"># Port Scan Tracking feature. The following setting is a comma separated list</span>
<a id="__codelineno-2-1906" name="__codelineno-2-1906" href="#__codelineno-2-1906"></a><span class="c1"># of those ports and uses the same format as TCP_IN. The setting of</span>
<a id="__codelineno-2-1907" name="__codelineno-2-1907" href="#__codelineno-2-1907"></a><span class="c1"># 0:65535,ICMP,INVALID,OPEN,BRD covers all ports</span>
<a id="__codelineno-2-1908" name="__codelineno-2-1908" href="#__codelineno-2-1908"></a><span class="c1">#</span>
<a id="__codelineno-2-1909" name="__codelineno-2-1909" href="#__codelineno-2-1909"></a><span class="c1"># Special values are:</span>
<a id="__codelineno-2-1910" name="__codelineno-2-1910" href="#__codelineno-2-1910"></a><span class="c1">#   ICMP    - include ICMP blocks (see ICMP_*)</span>
<a id="__codelineno-2-1911" name="__codelineno-2-1911" href="#__codelineno-2-1911"></a><span class="c1">#   INVALID - include INVALID blocks (see PACKET_FILTER)</span>
<a id="__codelineno-2-1912" name="__codelineno-2-1912" href="#__codelineno-2-1912"></a><span class="c1">#   OPEN    - include TCP_IN and UDP_IN open port blocks - *[proto]_IN Blocked*</span>
<a id="__codelineno-2-1913" name="__codelineno-2-1913" href="#__codelineno-2-1913"></a><span class="c1">#   BRD     - include UDP Broadcast IPs, otherwise they are ignored</span>
<a id="__codelineno-2-1914" name="__codelineno-2-1914" href="#__codelineno-2-1914"></a><span class="na">PS_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0:65535,ICMP"</span>
<a id="__codelineno-2-1915" name="__codelineno-2-1915" href="#__codelineno-2-1915"></a>
<a id="__codelineno-2-1916" name="__codelineno-2-1916" href="#__codelineno-2-1916"></a><span class="c1"># To specify how many different ports qualifies as a Port Scan you can increase</span>
<a id="__codelineno-2-1917" name="__codelineno-2-1917" href="#__codelineno-2-1917"></a><span class="c1"># the following from the default value of 1. The risk in doing so will mean</span>
<a id="__codelineno-2-1918" name="__codelineno-2-1918" href="#__codelineno-2-1918"></a><span class="c1"># that persistent attempts to attack a specific closed port will not be</span>
<a id="__codelineno-2-1919" name="__codelineno-2-1919" href="#__codelineno-2-1919"></a><span class="c1"># detected and blocked</span>
<a id="__codelineno-2-1920" name="__codelineno-2-1920" href="#__codelineno-2-1920"></a><span class="na">PS_DIVERSITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1921" name="__codelineno-2-1921" href="#__codelineno-2-1921"></a>
<a id="__codelineno-2-1922" name="__codelineno-2-1922" href="#__codelineno-2-1922"></a><span class="c1"># You can select whether IP blocks for Port Scan Tracking should be temporary</span>
<a id="__codelineno-2-1923" name="__codelineno-2-1923" href="#__codelineno-2-1923"></a><span class="c1"># or permanent. Set PS_PERMANENT to "0" for temporary and "1" for permanent</span>
<a id="__codelineno-2-1924" name="__codelineno-2-1924" href="#__codelineno-2-1924"></a><span class="c1"># blocking. If set to "0" PS_BLOCK_TIME is the amount of time in seconds to</span>
<a id="__codelineno-2-1925" name="__codelineno-2-1925" href="#__codelineno-2-1925"></a><span class="c1"># temporarily block the IP address for</span>
<a id="__codelineno-2-1926" name="__codelineno-2-1926" href="#__codelineno-2-1926"></a><span class="na">PS_PERMANENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1927" name="__codelineno-2-1927" href="#__codelineno-2-1927"></a><span class="na">PS_BLOCK_TIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-2-1928" name="__codelineno-2-1928" href="#__codelineno-2-1928"></a>
<a id="__codelineno-2-1929" name="__codelineno-2-1929" href="#__codelineno-2-1929"></a><span class="c1"># Set the following to "1" to enable Port Scan Tracking email alerts, set to</span>
<a id="__codelineno-2-1930" name="__codelineno-2-1930" href="#__codelineno-2-1930"></a><span class="c1"># "0" to disable them</span>
<a id="__codelineno-2-1931" name="__codelineno-2-1931" href="#__codelineno-2-1931"></a><span class="na">PS_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1932" name="__codelineno-2-1932" href="#__codelineno-2-1932"></a>
<a id="__codelineno-2-1933" name="__codelineno-2-1933" href="#__codelineno-2-1933"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1934" name="__codelineno-2-1934" href="#__codelineno-2-1934"></a><span class="c1"># SECTION:User ID Tracking</span>
<a id="__codelineno-2-1935" name="__codelineno-2-1935" href="#__codelineno-2-1935"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1936" name="__codelineno-2-1936" href="#__codelineno-2-1936"></a><span class="c1"># User ID Tracking. This feature tracks UID blocks logged by iptables to</span>
<a id="__codelineno-2-1937" name="__codelineno-2-1937" href="#__codelineno-2-1937"></a><span class="c1"># syslog. If a UID generates a port block that is logged more than UID_LIMIT</span>
<a id="__codelineno-2-1938" name="__codelineno-2-1938" href="#__codelineno-2-1938"></a><span class="c1"># times within UID_INTERVAL seconds, an alert will be sent</span>
<a id="__codelineno-2-1939" name="__codelineno-2-1939" href="#__codelineno-2-1939"></a><span class="c1">#</span>
<a id="__codelineno-2-1940" name="__codelineno-2-1940" href="#__codelineno-2-1940"></a><span class="c1"># Note: This feature will only track iptables blocks from the log file set in</span>
<a id="__codelineno-2-1941" name="__codelineno-2-1941" href="#__codelineno-2-1941"></a><span class="c1"># IPTABLES_LOG and if DROP_OUT_LOGGING and DROP_UID_LOGGING are enabled.</span>
<a id="__codelineno-2-1942" name="__codelineno-2-1942" href="#__codelineno-2-1942"></a><span class="c1">#</span>
<a id="__codelineno-2-1943" name="__codelineno-2-1943" href="#__codelineno-2-1943"></a><span class="c1"># To ignore specific UIDs list them in csf.uidignore and then restart lfd</span>
<a id="__codelineno-2-1944" name="__codelineno-2-1944" href="#__codelineno-2-1944"></a><span class="c1">#</span>
<a id="__codelineno-2-1945" name="__codelineno-2-1945" href="#__codelineno-2-1945"></a><span class="c1"># Set UID_INTERVAL to "0" to disable this feature. A value of between 60 and 300</span>
<a id="__codelineno-2-1946" name="__codelineno-2-1946" href="#__codelineno-2-1946"></a><span class="c1"># would be sensible to enable this feature</span>
<a id="__codelineno-2-1947" name="__codelineno-2-1947" href="#__codelineno-2-1947"></a><span class="c1">#</span>
<a id="__codelineno-2-1948" name="__codelineno-2-1948" href="#__codelineno-2-1948"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-1949" name="__codelineno-2-1949" href="#__codelineno-2-1949"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-1950" name="__codelineno-2-1950" href="#__codelineno-2-1950"></a><span class="na">UID_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-1951" name="__codelineno-2-1951" href="#__codelineno-2-1951"></a><span class="na">UID_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-2-1952" name="__codelineno-2-1952" href="#__codelineno-2-1952"></a>
<a id="__codelineno-2-1953" name="__codelineno-2-1953" href="#__codelineno-2-1953"></a><span class="c1"># You can specify the ports and/or port ranges that should be tracked by the</span>
<a id="__codelineno-2-1954" name="__codelineno-2-1954" href="#__codelineno-2-1954"></a><span class="c1"># User ID Tracking feature. The following setting is a comma separated list</span>
<a id="__codelineno-2-1955" name="__codelineno-2-1955" href="#__codelineno-2-1955"></a><span class="c1"># of those ports and uses the same format as TCP_OUT. The default setting of</span>
<a id="__codelineno-2-1956" name="__codelineno-2-1956" href="#__codelineno-2-1956"></a><span class="c1"># 0:65535,ICMP covers all ports</span>
<a id="__codelineno-2-1957" name="__codelineno-2-1957" href="#__codelineno-2-1957"></a><span class="na">UID_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0:65535,ICMP"</span>
<a id="__codelineno-2-1958" name="__codelineno-2-1958" href="#__codelineno-2-1958"></a>
<a id="__codelineno-2-1959" name="__codelineno-2-1959" href="#__codelineno-2-1959"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1960" name="__codelineno-2-1960" href="#__codelineno-2-1960"></a><span class="c1"># SECTION:Account Tracking</span>
<a id="__codelineno-2-1961" name="__codelineno-2-1961" href="#__codelineno-2-1961"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-1962" name="__codelineno-2-1962" href="#__codelineno-2-1962"></a><span class="c1"># Account Tracking. The following options enable the tracking of modifications</span>
<a id="__codelineno-2-1963" name="__codelineno-2-1963" href="#__codelineno-2-1963"></a><span class="c1"># to the accounts on a server. If any of the enabled options are triggered by</span>
<a id="__codelineno-2-1964" name="__codelineno-2-1964" href="#__codelineno-2-1964"></a><span class="c1"># a modifications to an account, an alert email is sent. Only the modification</span>
<a id="__codelineno-2-1965" name="__codelineno-2-1965" href="#__codelineno-2-1965"></a><span class="c1"># is reported. The cause of the modification will have to be investigated</span>
<a id="__codelineno-2-1966" name="__codelineno-2-1966" href="#__codelineno-2-1966"></a><span class="c1"># manually</span>
<a id="__codelineno-2-1967" name="__codelineno-2-1967" href="#__codelineno-2-1967"></a><span class="c1">#</span>
<a id="__codelineno-2-1968" name="__codelineno-2-1968" href="#__codelineno-2-1968"></a><span class="c1"># You can set AT_ALERT to the following:</span>
<a id="__codelineno-2-1969" name="__codelineno-2-1969" href="#__codelineno-2-1969"></a><span class="c1"># 0 = disable this feature</span>
<a id="__codelineno-2-1970" name="__codelineno-2-1970" href="#__codelineno-2-1970"></a><span class="c1"># 1 = enable this feature for all accounts</span>
<a id="__codelineno-2-1971" name="__codelineno-2-1971" href="#__codelineno-2-1971"></a><span class="c1"># 2 = enable this feature only for superuser accounts (UID = 0, e.g. root, etc)</span>
<a id="__codelineno-2-1972" name="__codelineno-2-1972" href="#__codelineno-2-1972"></a><span class="c1"># 3 = enable this feature only for the root account</span>
<a id="__codelineno-2-1973" name="__codelineno-2-1973" href="#__codelineno-2-1973"></a><span class="na">AT_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-2-1974" name="__codelineno-2-1974" href="#__codelineno-2-1974"></a>
<a id="__codelineno-2-1975" name="__codelineno-2-1975" href="#__codelineno-2-1975"></a><span class="c1"># This options is the interval between checks in seconds</span>
<a id="__codelineno-2-1976" name="__codelineno-2-1976" href="#__codelineno-2-1976"></a><span class="na">AT_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"60"</span>
<a id="__codelineno-2-1977" name="__codelineno-2-1977" href="#__codelineno-2-1977"></a>
<a id="__codelineno-2-1978" name="__codelineno-2-1978" href="#__codelineno-2-1978"></a><span class="c1"># Send alert if a new account is created</span>
<a id="__codelineno-2-1979" name="__codelineno-2-1979" href="#__codelineno-2-1979"></a><span class="na">AT_NEW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1980" name="__codelineno-2-1980" href="#__codelineno-2-1980"></a>
<a id="__codelineno-2-1981" name="__codelineno-2-1981" href="#__codelineno-2-1981"></a><span class="c1"># Send alert if an existing account is deleted</span>
<a id="__codelineno-2-1982" name="__codelineno-2-1982" href="#__codelineno-2-1982"></a><span class="na">AT_OLD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1983" name="__codelineno-2-1983" href="#__codelineno-2-1983"></a>
<a id="__codelineno-2-1984" name="__codelineno-2-1984" href="#__codelineno-2-1984"></a><span class="c1"># Send alert if an account password has changed</span>
<a id="__codelineno-2-1985" name="__codelineno-2-1985" href="#__codelineno-2-1985"></a><span class="na">AT_PASSWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1986" name="__codelineno-2-1986" href="#__codelineno-2-1986"></a>
<a id="__codelineno-2-1987" name="__codelineno-2-1987" href="#__codelineno-2-1987"></a><span class="c1"># Send alert if an account uid has changed</span>
<a id="__codelineno-2-1988" name="__codelineno-2-1988" href="#__codelineno-2-1988"></a><span class="na">AT_UID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1989" name="__codelineno-2-1989" href="#__codelineno-2-1989"></a>
<a id="__codelineno-2-1990" name="__codelineno-2-1990" href="#__codelineno-2-1990"></a><span class="c1"># Send alert if an account gid has changed</span>
<a id="__codelineno-2-1991" name="__codelineno-2-1991" href="#__codelineno-2-1991"></a><span class="na">AT_GID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1992" name="__codelineno-2-1992" href="#__codelineno-2-1992"></a>
<a id="__codelineno-2-1993" name="__codelineno-2-1993" href="#__codelineno-2-1993"></a><span class="c1"># Send alert if an account login directory has changed</span>
<a id="__codelineno-2-1994" name="__codelineno-2-1994" href="#__codelineno-2-1994"></a><span class="na">AT_DIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1995" name="__codelineno-2-1995" href="#__codelineno-2-1995"></a>
<a id="__codelineno-2-1996" name="__codelineno-2-1996" href="#__codelineno-2-1996"></a><span class="c1"># Send alert if an account login shell has changed</span>
<a id="__codelineno-2-1997" name="__codelineno-2-1997" href="#__codelineno-2-1997"></a><span class="na">AT_SHELL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-1998" name="__codelineno-2-1998" href="#__codelineno-2-1998"></a>
<a id="__codelineno-2-1999" name="__codelineno-2-1999" href="#__codelineno-2-1999"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2000" name="__codelineno-2-2000" href="#__codelineno-2-2000"></a><span class="c1"># SECTION:Integrated User Interface</span>
<a id="__codelineno-2-2001" name="__codelineno-2-2001" href="#__codelineno-2-2001"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2002" name="__codelineno-2-2002" href="#__codelineno-2-2002"></a><span class="c1"># Integrated User Interface. This feature provides a HTML UI to csf and lfd,</span>
<a id="__codelineno-2-2003" name="__codelineno-2-2003" href="#__codelineno-2-2003"></a><span class="c1"># without requiring a control panel or web server. The UI runs as a sub process</span>
<a id="__codelineno-2-2004" name="__codelineno-2-2004" href="#__codelineno-2-2004"></a><span class="c1"># to the lfd daemon</span>
<a id="__codelineno-2-2005" name="__codelineno-2-2005" href="#__codelineno-2-2005"></a><span class="c1">#</span>
<a id="__codelineno-2-2006" name="__codelineno-2-2006" href="#__codelineno-2-2006"></a><span class="c1"># As it runs under the root account and successful login provides root access</span>
<a id="__codelineno-2-2007" name="__codelineno-2-2007" href="#__codelineno-2-2007"></a><span class="c1"># to the server, great care should be taken when configuring and using this</span>
<a id="__codelineno-2-2008" name="__codelineno-2-2008" href="#__codelineno-2-2008"></a><span class="c1"># feature. There are additional restrictions to enhance secure access to the UI</span>
<a id="__codelineno-2-2009" name="__codelineno-2-2009" href="#__codelineno-2-2009"></a><span class="c1">#</span>
<a id="__codelineno-2-2010" name="__codelineno-2-2010" href="#__codelineno-2-2010"></a><span class="c1"># See readme.txt for more information about using this feature BEFORE enabling</span>
<a id="__codelineno-2-2011" name="__codelineno-2-2011" href="#__codelineno-2-2011"></a><span class="c1"># it for security and access reasons</span>
<a id="__codelineno-2-2012" name="__codelineno-2-2012" href="#__codelineno-2-2012"></a><span class="c1"># </span>
<a id="__codelineno-2-2013" name="__codelineno-2-2013" href="#__codelineno-2-2013"></a><span class="c1"># 1 to enable, 0 to disable</span>
<a id="__codelineno-2-2014" name="__codelineno-2-2014" href="#__codelineno-2-2014"></a><span class="na">UI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2015" name="__codelineno-2-2015" href="#__codelineno-2-2015"></a>
<a id="__codelineno-2-2016" name="__codelineno-2-2016" href="#__codelineno-2-2016"></a><span class="c1"># Set this to the port that want to bind this service to. You should configure</span>
<a id="__codelineno-2-2017" name="__codelineno-2-2017" href="#__codelineno-2-2017"></a><span class="c1"># this port to be &gt;1023 and different from any other port already being used</span>
<a id="__codelineno-2-2018" name="__codelineno-2-2018" href="#__codelineno-2-2018"></a><span class="c1">#</span>
<a id="__codelineno-2-2019" name="__codelineno-2-2019" href="#__codelineno-2-2019"></a><span class="c1"># Do NOT enable access to this port in TCP_IN, instead only allow trusted IP's</span>
<a id="__codelineno-2-2020" name="__codelineno-2-2020" href="#__codelineno-2-2020"></a><span class="c1"># to the port using Advanced Allow Filters (see readme.txt)</span>
<a id="__codelineno-2-2021" name="__codelineno-2-2021" href="#__codelineno-2-2021"></a><span class="na">UI_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8546"</span>
<a id="__codelineno-2-2022" name="__codelineno-2-2022" href="#__codelineno-2-2022"></a>
<a id="__codelineno-2-2023" name="__codelineno-2-2023" href="#__codelineno-2-2023"></a><span class="c1"># Optionally set the IP address to bind to. Normally this should be left blank</span>
<a id="__codelineno-2-2024" name="__codelineno-2-2024" href="#__codelineno-2-2024"></a><span class="c1"># to bind to all IP addresses on the server.</span>
<a id="__codelineno-2-2025" name="__codelineno-2-2025" href="#__codelineno-2-2025"></a><span class="c1">#</span>
<a id="__codelineno-2-2026" name="__codelineno-2-2026" href="#__codelineno-2-2026"></a><span class="c1"># If the server is configured for IPv6 but the IP to bind to is IPv4, then the</span>
<a id="__codelineno-2-2027" name="__codelineno-2-2027" href="#__codelineno-2-2027"></a><span class="c1"># IP address MUST use the IPv6 representation. For example 1.2.3.4 must use</span>
<a id="__codelineno-2-2028" name="__codelineno-2-2028" href="#__codelineno-2-2028"></a><span class="c1"># ::ffff:1.2.3.4</span>
<a id="__codelineno-2-2029" name="__codelineno-2-2029" href="#__codelineno-2-2029"></a><span class="c1">#</span>
<a id="__codelineno-2-2030" name="__codelineno-2-2030" href="#__codelineno-2-2030"></a><span class="c1"># Leave blank to bind to all IP addresses on the server</span>
<a id="__codelineno-2-2031" name="__codelineno-2-2031" href="#__codelineno-2-2031"></a><span class="na">UI_IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2032" name="__codelineno-2-2032" href="#__codelineno-2-2032"></a>
<a id="__codelineno-2-2033" name="__codelineno-2-2033" href="#__codelineno-2-2033"></a><span class="c1"># This should be a secure, hard to guess username</span>
<a id="__codelineno-2-2034" name="__codelineno-2-2034" href="#__codelineno-2-2034"></a><span class="c1"># </span>
<a id="__codelineno-2-2035" name="__codelineno-2-2035" href="#__codelineno-2-2035"></a><span class="c1"># This must be changed from the default</span>
<a id="__codelineno-2-2036" name="__codelineno-2-2036" href="#__codelineno-2-2036"></a><span class="na">UI_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"admin"</span>
<a id="__codelineno-2-2037" name="__codelineno-2-2037" href="#__codelineno-2-2037"></a>
<a id="__codelineno-2-2038" name="__codelineno-2-2038" href="#__codelineno-2-2038"></a><span class="c1"># This should be a secure, hard to guess password. That is, at least 8</span>
<a id="__codelineno-2-2039" name="__codelineno-2-2039" href="#__codelineno-2-2039"></a><span class="c1"># characters long with a mixture of upper and lowercase characters plus </span>
<a id="__codelineno-2-2040" name="__codelineno-2-2040" href="#__codelineno-2-2040"></a><span class="c1"># numbers and non-alphanumeric characters</span>
<a id="__codelineno-2-2041" name="__codelineno-2-2041" href="#__codelineno-2-2041"></a><span class="c1">#</span>
<a id="__codelineno-2-2042" name="__codelineno-2-2042" href="#__codelineno-2-2042"></a><span class="c1"># This must be changed from the default</span>
<a id="__codelineno-2-2043" name="__codelineno-2-2043" href="#__codelineno-2-2043"></a><span class="na">UI_PASS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"password"</span>
<a id="__codelineno-2-2044" name="__codelineno-2-2044" href="#__codelineno-2-2044"></a>
<a id="__codelineno-2-2045" name="__codelineno-2-2045" href="#__codelineno-2-2045"></a><span class="c1"># This option controls whether login attempts to the CSF/LFD UI from the</span>
<a id="__codelineno-2-2046" name="__codelineno-2-2046" href="#__codelineno-2-2046"></a><span class="c1"># server's own local IP addresses are blocked. These are the IPs bound to</span>
<a id="__codelineno-2-2047" name="__codelineno-2-2047" href="#__codelineno-2-2047"></a><span class="c1"># the server’s interfaces (as discovered by getethdev), including those on</span>
<a id="__codelineno-2-2048" name="__codelineno-2-2048" href="#__codelineno-2-2048"></a><span class="c1"># private ranges (e.g. 192.168.x.x, 172.16–31.x.x, 10.x.x.x) and any local</span>
<a id="__codelineno-2-2049" name="__codelineno-2-2049" href="#__codelineno-2-2049"></a><span class="c1"># Docker or virtual bridge networks.</span>
<a id="__codelineno-2-2050" name="__codelineno-2-2050" href="#__codelineno-2-2050"></a><span class="c1">#</span>
<a id="__codelineno-2-2051" name="__codelineno-2-2051" href="#__codelineno-2-2051"></a><span class="c1"># Setting this to "1" prevents access attempts that originate from a local</span>
<a id="__codelineno-2-2052" name="__codelineno-2-2052" href="#__codelineno-2-2052"></a><span class="c1"># interface address, which can help block unauthorized or loopback-style</span>
<a id="__codelineno-2-2053" name="__codelineno-2-2053" href="#__codelineno-2-2053"></a><span class="c1"># access through containers, proxies, or internal networks.</span>
<a id="__codelineno-2-2054" name="__codelineno-2-2054" href="#__codelineno-2-2054"></a><span class="c1">#</span>
<a id="__codelineno-2-2055" name="__codelineno-2-2055" href="#__codelineno-2-2055"></a><span class="c1"># If you legitimately access the UI via a local bridge (e.g. Docker proxy</span>
<a id="__codelineno-2-2056" name="__codelineno-2-2056" href="#__codelineno-2-2056"></a><span class="c1"># IP such as 172.18.0.2), you may need to set this to "0" or explicitly</span>
<a id="__codelineno-2-2057" name="__codelineno-2-2057" href="#__codelineno-2-2057"></a><span class="c1"># allow the IP in csf.allow.ui.</span>
<a id="__codelineno-2-2058" name="__codelineno-2-2058" href="#__codelineno-2-2058"></a><span class="c1">#</span>
<a id="__codelineno-2-2059" name="__codelineno-2-2059" href="#__codelineno-2-2059"></a><span class="c1"># Keeping this set to "1" means that attempts to access the CSF web</span>
<a id="__codelineno-2-2060" name="__codelineno-2-2060" href="#__codelineno-2-2060"></a><span class="c1"># interface from a local network IP will be blocked. In a browser, this</span>
<a id="__codelineno-2-2061" name="__codelineno-2-2061" href="#__codelineno-2-2061"></a><span class="c1"># typically results in the error:</span>
<a id="__codelineno-2-2062" name="__codelineno-2-2062" href="#__codelineno-2-2062"></a><span class="c1"># PR_CONNECT_RESET_ERROR</span>
<a id="__codelineno-2-2063" name="__codelineno-2-2063" href="#__codelineno-2-2063"></a><span class="c1">#</span>
<a id="__codelineno-2-2064" name="__codelineno-2-2064" href="#__codelineno-2-2064"></a><span class="c1"># Default: 1 (block local interface IPs)</span>
<a id="__codelineno-2-2065" name="__codelineno-2-2065" href="#__codelineno-2-2065"></a><span class="na">UI_BLOCK_PRIVATE_NET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2066" name="__codelineno-2-2066" href="#__codelineno-2-2066"></a>
<a id="__codelineno-2-2067" name="__codelineno-2-2067" href="#__codelineno-2-2067"></a><span class="c1"># This is the login session timeout. If there is no activity for a logged in</span>
<a id="__codelineno-2-2068" name="__codelineno-2-2068" href="#__codelineno-2-2068"></a><span class="c1"># session within this number of seconds, the session will timeout and a new</span>
<a id="__codelineno-2-2069" name="__codelineno-2-2069" href="#__codelineno-2-2069"></a><span class="c1"># login will be required</span>
<a id="__codelineno-2-2070" name="__codelineno-2-2070" href="#__codelineno-2-2070"></a><span class="c1">#</span>
<a id="__codelineno-2-2071" name="__codelineno-2-2071" href="#__codelineno-2-2071"></a><span class="c1"># For security reasons, you should always keep this option low (i.e 60-300)</span>
<a id="__codelineno-2-2072" name="__codelineno-2-2072" href="#__codelineno-2-2072"></a><span class="na">UI_TIMEOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-2-2073" name="__codelineno-2-2073" href="#__codelineno-2-2073"></a>
<a id="__codelineno-2-2074" name="__codelineno-2-2074" href="#__codelineno-2-2074"></a><span class="c1"># This is the maximum concurrent connections allowed to the server. The default</span>
<a id="__codelineno-2-2075" name="__codelineno-2-2075" href="#__codelineno-2-2075"></a><span class="c1"># value should be sufficient</span>
<a id="__codelineno-2-2076" name="__codelineno-2-2076" href="#__codelineno-2-2076"></a><span class="na">UI_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-2077" name="__codelineno-2-2077" href="#__codelineno-2-2077"></a>
<a id="__codelineno-2-2078" name="__codelineno-2-2078" href="#__codelineno-2-2078"></a><span class="c1"># The number of login retries allowed within a 24 hour period. A successful</span>
<a id="__codelineno-2-2079" name="__codelineno-2-2079" href="#__codelineno-2-2079"></a><span class="c1"># login from the IP address will clear the failures</span>
<a id="__codelineno-2-2080" name="__codelineno-2-2080" href="#__codelineno-2-2080"></a><span class="c1">#</span>
<a id="__codelineno-2-2081" name="__codelineno-2-2081" href="#__codelineno-2-2081"></a><span class="c1"># For security reasons, you should always keep this option low (i.e 0-10)</span>
<a id="__codelineno-2-2082" name="__codelineno-2-2082" href="#__codelineno-2-2082"></a><span class="na">UI_RETRY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-2083" name="__codelineno-2-2083" href="#__codelineno-2-2083"></a>
<a id="__codelineno-2-2084" name="__codelineno-2-2084" href="#__codelineno-2-2084"></a><span class="c1"># If enabled, this option will add the connecting IP address to the file </span>
<a id="__codelineno-2-2085" name="__codelineno-2-2085" href="#__codelineno-2-2085"></a><span class="c1"># /etc/csf/ui/ui.ban after UI_RETRY login failures. The IP address will not be</span>
<a id="__codelineno-2-2086" name="__codelineno-2-2086" href="#__codelineno-2-2086"></a><span class="c1"># able to login to the UI while it is listed in this file. The UI_BAN setting</span>
<a id="__codelineno-2-2087" name="__codelineno-2-2087" href="#__codelineno-2-2087"></a><span class="c1"># does not refer to any of the csf/lfd allow or ignore files, e.g. csf.allow,</span>
<a id="__codelineno-2-2088" name="__codelineno-2-2088" href="#__codelineno-2-2088"></a><span class="c1"># csf.ignore, etc.</span>
<a id="__codelineno-2-2089" name="__codelineno-2-2089" href="#__codelineno-2-2089"></a><span class="c1">#</span>
<a id="__codelineno-2-2090" name="__codelineno-2-2090" href="#__codelineno-2-2090"></a><span class="c1"># For security reasons, you should always enable this option</span>
<a id="__codelineno-2-2091" name="__codelineno-2-2091" href="#__codelineno-2-2091"></a><span class="na">UI_BAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2092" name="__codelineno-2-2092" href="#__codelineno-2-2092"></a>
<a id="__codelineno-2-2093" name="__codelineno-2-2093" href="#__codelineno-2-2093"></a><span class="c1"># If enabled, only IPs (or CIDR's) listed in the file /etc/csf/ui/ui.allow will</span>
<a id="__codelineno-2-2094" name="__codelineno-2-2094" href="#__codelineno-2-2094"></a><span class="c1"># be allowed to login to the UI. The UI_ALLOW setting does not refer to any of</span>
<a id="__codelineno-2-2095" name="__codelineno-2-2095" href="#__codelineno-2-2095"></a><span class="c1"># the csf/lfd allow or ignore files, e.g. csf.allow, csf.ignore, etc.</span>
<a id="__codelineno-2-2096" name="__codelineno-2-2096" href="#__codelineno-2-2096"></a><span class="c1">#</span>
<a id="__codelineno-2-2097" name="__codelineno-2-2097" href="#__codelineno-2-2097"></a><span class="c1"># For security reasons, you should always enable this option and use ui.allow</span>
<a id="__codelineno-2-2098" name="__codelineno-2-2098" href="#__codelineno-2-2098"></a><span class="na">UI_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2099" name="__codelineno-2-2099" href="#__codelineno-2-2099"></a>
<a id="__codelineno-2-2100" name="__codelineno-2-2100" href="#__codelineno-2-2100"></a><span class="c1"># If enabled, this option will trigger an iptables block through csf after</span>
<a id="__codelineno-2-2101" name="__codelineno-2-2101" href="#__codelineno-2-2101"></a><span class="c1"># UI_RETRY login failures</span>
<a id="__codelineno-2-2102" name="__codelineno-2-2102" href="#__codelineno-2-2102"></a><span class="c1">#</span>
<a id="__codelineno-2-2103" name="__codelineno-2-2103" href="#__codelineno-2-2103"></a><span class="c1"># 0 = no block;1 = perm block;nn=temp block for nn secs</span>
<a id="__codelineno-2-2104" name="__codelineno-2-2104" href="#__codelineno-2-2104"></a><span class="na">UI_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2105" name="__codelineno-2-2105" href="#__codelineno-2-2105"></a>
<a id="__codelineno-2-2106" name="__codelineno-2-2106" href="#__codelineno-2-2106"></a><span class="c1"># This controls what email alerts are sent with regards to logins to the UI. It</span>
<a id="__codelineno-2-2107" name="__codelineno-2-2107" href="#__codelineno-2-2107"></a><span class="c1"># uses the uialert.txt template</span>
<a id="__codelineno-2-2108" name="__codelineno-2-2108" href="#__codelineno-2-2108"></a><span class="c1">#</span>
<a id="__codelineno-2-2109" name="__codelineno-2-2109" href="#__codelineno-2-2109"></a><span class="c1"># 4 = login success + login failure/ban/block + login attempts</span>
<a id="__codelineno-2-2110" name="__codelineno-2-2110" href="#__codelineno-2-2110"></a><span class="c1"># 3 = login success + login failure/ban/block</span>
<a id="__codelineno-2-2111" name="__codelineno-2-2111" href="#__codelineno-2-2111"></a><span class="c1"># 2 = login failure/ban/block</span>
<a id="__codelineno-2-2112" name="__codelineno-2-2112" href="#__codelineno-2-2112"></a><span class="c1"># 1 = login ban/block</span>
<a id="__codelineno-2-2113" name="__codelineno-2-2113" href="#__codelineno-2-2113"></a><span class="c1"># 0 = disabled</span>
<a id="__codelineno-2-2114" name="__codelineno-2-2114" href="#__codelineno-2-2114"></a><span class="na">UI_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"4"</span>
<a id="__codelineno-2-2115" name="__codelineno-2-2115" href="#__codelineno-2-2115"></a>
<a id="__codelineno-2-2116" name="__codelineno-2-2116" href="#__codelineno-2-2116"></a><span class="c1"># This is the SSL cipher list that the Integrated UI will negotiate from</span>
<a id="__codelineno-2-2117" name="__codelineno-2-2117" href="#__codelineno-2-2117"></a><span class="na">UI_CIPHER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:-LOW:-SSLv2:-EXP:!kEDH"</span>
<a id="__codelineno-2-2118" name="__codelineno-2-2118" href="#__codelineno-2-2118"></a>
<a id="__codelineno-2-2119" name="__codelineno-2-2119" href="#__codelineno-2-2119"></a><span class="c1"># This is the SSL protocol version used. See IO::Socket::SSL if you wish to</span>
<a id="__codelineno-2-2120" name="__codelineno-2-2120" href="#__codelineno-2-2120"></a><span class="c1"># change this and to understand the implications of changing it</span>
<a id="__codelineno-2-2121" name="__codelineno-2-2121" href="#__codelineno-2-2121"></a><span class="na">UI_SSL_VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"SSLv23:!SSLv3:!SSLv2"</span>
<a id="__codelineno-2-2122" name="__codelineno-2-2122" href="#__codelineno-2-2122"></a>
<a id="__codelineno-2-2123" name="__codelineno-2-2123" href="#__codelineno-2-2123"></a><span class="c1"># If cxs is installed then enabling this option will provide a dropdown box to</span>
<a id="__codelineno-2-2124" name="__codelineno-2-2124" href="#__codelineno-2-2124"></a><span class="c1"># switch between applications</span>
<a id="__codelineno-2-2125" name="__codelineno-2-2125" href="#__codelineno-2-2125"></a><span class="na">UI_CXS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2126" name="__codelineno-2-2126" href="#__codelineno-2-2126"></a>
<a id="__codelineno-2-2127" name="__codelineno-2-2127" href="#__codelineno-2-2127"></a><span class="c1"># There is a modified installation of ConfigServer Explorer (cse) provided with</span>
<a id="__codelineno-2-2128" name="__codelineno-2-2128" href="#__codelineno-2-2128"></a><span class="c1"># the csf distribution. If this option is enabled it will provide a dropdown</span>
<a id="__codelineno-2-2129" name="__codelineno-2-2129" href="#__codelineno-2-2129"></a><span class="c1"># box to switch between applications</span>
<a id="__codelineno-2-2130" name="__codelineno-2-2130" href="#__codelineno-2-2130"></a><span class="na">UI_CSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2131" name="__codelineno-2-2131" href="#__codelineno-2-2131"></a>
<a id="__codelineno-2-2132" name="__codelineno-2-2132" href="#__codelineno-2-2132"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2133" name="__codelineno-2-2133" href="#__codelineno-2-2133"></a><span class="c1"># SECTION:Messenger service</span>
<a id="__codelineno-2-2134" name="__codelineno-2-2134" href="#__codelineno-2-2134"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2135" name="__codelineno-2-2135" href="#__codelineno-2-2135"></a><span class="c1"># Messenger service. This feature allows the display of a message to a blocked</span>
<a id="__codelineno-2-2136" name="__codelineno-2-2136" href="#__codelineno-2-2136"></a><span class="c1"># connecting IP address to inform the user that they are blocked in the</span>
<a id="__codelineno-2-2137" name="__codelineno-2-2137" href="#__codelineno-2-2137"></a><span class="c1"># firewall. This can help when users get themselves blocked, e.g. due to</span>
<a id="__codelineno-2-2138" name="__codelineno-2-2138" href="#__codelineno-2-2138"></a><span class="c1"># multiple login failures. The service is provided by two daemons running on</span>
<a id="__codelineno-2-2139" name="__codelineno-2-2139" href="#__codelineno-2-2139"></a><span class="c1"># ports providing either an HTML or TEXT message</span>
<a id="__codelineno-2-2140" name="__codelineno-2-2140" href="#__codelineno-2-2140"></a><span class="c1">#</span>
<a id="__codelineno-2-2141" name="__codelineno-2-2141" href="#__codelineno-2-2141"></a><span class="c1"># This feature does not work on servers that do not have the iptables module</span>
<a id="__codelineno-2-2142" name="__codelineno-2-2142" href="#__codelineno-2-2142"></a><span class="c1"># ipt_REDIRECT loaded. Typically, this will be with MONOLITHIC kernels. VPS</span>
<a id="__codelineno-2-2143" name="__codelineno-2-2143" href="#__codelineno-2-2143"></a><span class="c1"># server admins should check with their VPS host provider that the iptables</span>
<a id="__codelineno-2-2144" name="__codelineno-2-2144" href="#__codelineno-2-2144"></a><span class="c1"># module is included</span>
<a id="__codelineno-2-2145" name="__codelineno-2-2145" href="#__codelineno-2-2145"></a><span class="c1">#</span>
<a id="__codelineno-2-2146" name="__codelineno-2-2146" href="#__codelineno-2-2146"></a><span class="c1"># IPv6 will need the IO::Socket::INET6 perl module</span>
<a id="__codelineno-2-2147" name="__codelineno-2-2147" href="#__codelineno-2-2147"></a><span class="c1">#</span>
<a id="__codelineno-2-2148" name="__codelineno-2-2148" href="#__codelineno-2-2148"></a><span class="c1"># For further information on features and limitations refer to the csf</span>
<a id="__codelineno-2-2149" name="__codelineno-2-2149" href="#__codelineno-2-2149"></a><span class="c1"># readme.txt</span>
<a id="__codelineno-2-2150" name="__codelineno-2-2150" href="#__codelineno-2-2150"></a><span class="c1">#</span>
<a id="__codelineno-2-2151" name="__codelineno-2-2151" href="#__codelineno-2-2151"></a><span class="c1"># Note: Run /etc/csf/csftest.pl to check whether this option will function on</span>
<a id="__codelineno-2-2152" name="__codelineno-2-2152" href="#__codelineno-2-2152"></a><span class="c1"># this server</span>
<a id="__codelineno-2-2153" name="__codelineno-2-2153" href="#__codelineno-2-2153"></a><span class="c1">#</span>
<a id="__codelineno-2-2154" name="__codelineno-2-2154" href="#__codelineno-2-2154"></a><span class="c1"># 1 to enable, 0 to disable</span>
<a id="__codelineno-2-2155" name="__codelineno-2-2155" href="#__codelineno-2-2155"></a><span class="na">MESSENGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2156" name="__codelineno-2-2156" href="#__codelineno-2-2156"></a>
<a id="__codelineno-2-2157" name="__codelineno-2-2157" href="#__codelineno-2-2157"></a><span class="c1"># Provide this service to temporary IP address blocks</span>
<a id="__codelineno-2-2158" name="__codelineno-2-2158" href="#__codelineno-2-2158"></a><span class="na">MESSENGER_TEMP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2159" name="__codelineno-2-2159" href="#__codelineno-2-2159"></a>
<a id="__codelineno-2-2160" name="__codelineno-2-2160" href="#__codelineno-2-2160"></a><span class="c1"># Provide this service to permanent IP address blocks</span>
<a id="__codelineno-2-2161" name="__codelineno-2-2161" href="#__codelineno-2-2161"></a><span class="na">MESSENGER_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2162" name="__codelineno-2-2162" href="#__codelineno-2-2162"></a>
<a id="__codelineno-2-2163" name="__codelineno-2-2163" href="#__codelineno-2-2163"></a><span class="c1"># User account to run the service servers under. We recommend creating a</span>
<a id="__codelineno-2-2164" name="__codelineno-2-2164" href="#__codelineno-2-2164"></a><span class="c1"># specific non-priv, non-shell account for this purpose</span>
<a id="__codelineno-2-2165" name="__codelineno-2-2165" href="#__codelineno-2-2165"></a><span class="c1">#</span>
<a id="__codelineno-2-2166" name="__codelineno-2-2166" href="#__codelineno-2-2166"></a><span class="c1"># Note: When using MESSENGERV2, this account must NOT be a valid control panel</span>
<a id="__codelineno-2-2167" name="__codelineno-2-2167" href="#__codelineno-2-2167"></a><span class="c1"># account, it must be created manually as explained in the csf readme.txt</span>
<a id="__codelineno-2-2168" name="__codelineno-2-2168" href="#__codelineno-2-2168"></a><span class="na">MESSENGER_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"csf"</span>
<a id="__codelineno-2-2169" name="__codelineno-2-2169" href="#__codelineno-2-2169"></a>
<a id="__codelineno-2-2170" name="__codelineno-2-2170" href="#__codelineno-2-2170"></a><span class="c1"># This option points to the file(s) containing the Apache VirtualHost SSL</span>
<a id="__codelineno-2-2171" name="__codelineno-2-2171" href="#__codelineno-2-2171"></a><span class="c1"># definitions. This can be a file glob if there are multiple files to search.</span>
<a id="__codelineno-2-2172" name="__codelineno-2-2172" href="#__codelineno-2-2172"></a><span class="c1"># Only Apache v2 SSL VirtualHost definitions are supported</span>
<a id="__codelineno-2-2173" name="__codelineno-2-2173" href="#__codelineno-2-2173"></a><span class="c1">#</span>
<a id="__codelineno-2-2174" name="__codelineno-2-2174" href="#__codelineno-2-2174"></a><span class="c1"># This is used by MESSENGERV1 and MESSENGERV2 only</span>
<a id="__codelineno-2-2175" name="__codelineno-2-2175" href="#__codelineno-2-2175"></a><span class="na">MESSENGER_HTTPS_CONF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/httpd/conf.d/ssl.conf"</span>
<a id="__codelineno-2-2176" name="__codelineno-2-2176" href="#__codelineno-2-2176"></a>
<a id="__codelineno-2-2177" name="__codelineno-2-2177" href="#__codelineno-2-2177"></a><span class="c1"># The following options can be specified to provide a default fallback</span>
<a id="__codelineno-2-2178" name="__codelineno-2-2178" href="#__codelineno-2-2178"></a><span class="c1"># certificate to be used if either SNI is not supported or a hosted domain does</span>
<a id="__codelineno-2-2179" name="__codelineno-2-2179" href="#__codelineno-2-2179"></a><span class="c1"># not have an SSL certificate. If a fallback is not provided, one of the certs</span>
<a id="__codelineno-2-2180" name="__codelineno-2-2180" href="#__codelineno-2-2180"></a><span class="c1"># obtained from MESSENGER_HTTPS_CONF will be used</span>
<a id="__codelineno-2-2181" name="__codelineno-2-2181" href="#__codelineno-2-2181"></a><span class="c1">#</span>
<a id="__codelineno-2-2182" name="__codelineno-2-2182" href="#__codelineno-2-2182"></a><span class="c1"># This is used by MESSENGERV1 and MESSENGERV2 only</span>
<a id="__codelineno-2-2183" name="__codelineno-2-2183" href="#__codelineno-2-2183"></a><span class="na">MESSENGER_HTTPS_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/pki/tls/private/localhost.key"</span>
<a id="__codelineno-2-2184" name="__codelineno-2-2184" href="#__codelineno-2-2184"></a><span class="na">MESSENGER_HTTPS_CRT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/pki/tls/certs/localhost.crt"</span>
<a id="__codelineno-2-2185" name="__codelineno-2-2185" href="#__codelineno-2-2185"></a>
<a id="__codelineno-2-2186" name="__codelineno-2-2186" href="#__codelineno-2-2186"></a><span class="c1"># Set this to the port that will receive the HTTPS HTML message. You should</span>
<a id="__codelineno-2-2187" name="__codelineno-2-2187" href="#__codelineno-2-2187"></a><span class="c1"># configure this port to be &gt;1023 and different from the TEXT and HTML port. Do</span>
<a id="__codelineno-2-2188" name="__codelineno-2-2188" href="#__codelineno-2-2188"></a><span class="c1"># NOT enable access to this port in TCP_IN. This option requires the perl</span>
<a id="__codelineno-2-2189" name="__codelineno-2-2189" href="#__codelineno-2-2189"></a><span class="c1"># module IO::Socket::SSL at a version level that supports SNI (1.83+).</span>
<a id="__codelineno-2-2190" name="__codelineno-2-2190" href="#__codelineno-2-2190"></a><span class="c1"># Additionally the version of openssl on the server must also support SNI</span>
<a id="__codelineno-2-2191" name="__codelineno-2-2191" href="#__codelineno-2-2191"></a><span class="c1">#</span>
<a id="__codelineno-2-2192" name="__codelineno-2-2192" href="#__codelineno-2-2192"></a><span class="c1"># The option uses existing SSL certificates on the server for each domain to</span>
<a id="__codelineno-2-2193" name="__codelineno-2-2193" href="#__codelineno-2-2193"></a><span class="c1"># maintain a secure connection without browser warnings. It uses SNI to choose</span>
<a id="__codelineno-2-2194" name="__codelineno-2-2194" href="#__codelineno-2-2194"></a><span class="c1"># the correct certificate to use for each client connection</span>
<a id="__codelineno-2-2195" name="__codelineno-2-2195" href="#__codelineno-2-2195"></a><span class="c1">#</span>
<a id="__codelineno-2-2196" name="__codelineno-2-2196" href="#__codelineno-2-2196"></a><span class="c1"># Warning: On some servers the amount of memory used by the HTTPS MESSENGER</span>
<a id="__codelineno-2-2197" name="__codelineno-2-2197" href="#__codelineno-2-2197"></a><span class="c1"># service can become significant depending on various factors associated with</span>
<a id="__codelineno-2-2198" name="__codelineno-2-2198" href="#__codelineno-2-2198"></a><span class="c1"># the use of IO::Socket::SSL including the number of domains and certificates</span>
<a id="__codelineno-2-2199" name="__codelineno-2-2199" href="#__codelineno-2-2199"></a><span class="c1"># served. This is normally only an issue if using MESSENGERV1</span>
<a id="__codelineno-2-2200" name="__codelineno-2-2200" href="#__codelineno-2-2200"></a><span class="na">MESSENGER_HTTPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8887"</span>
<a id="__codelineno-2-2201" name="__codelineno-2-2201" href="#__codelineno-2-2201"></a>
<a id="__codelineno-2-2202" name="__codelineno-2-2202" href="#__codelineno-2-2202"></a><span class="c1"># This comma separated list are the HTTPS HTML ports that will be redirected</span>
<a id="__codelineno-2-2203" name="__codelineno-2-2203" href="#__codelineno-2-2203"></a><span class="c1"># for the blocked IP address. If you are using per application blocking</span>
<a id="__codelineno-2-2204" name="__codelineno-2-2204" href="#__codelineno-2-2204"></a><span class="c1"># (LF_TRIGGER) then only the relevant block port will be redirected to the</span>
<a id="__codelineno-2-2205" name="__codelineno-2-2205" href="#__codelineno-2-2205"></a><span class="c1"># messenger port</span>
<a id="__codelineno-2-2206" name="__codelineno-2-2206" href="#__codelineno-2-2206"></a><span class="c1">#</span>
<a id="__codelineno-2-2207" name="__codelineno-2-2207" href="#__codelineno-2-2207"></a><span class="c1"># Recommended setting "443" plus any end-user control panel SSL ports. So, for</span>
<a id="__codelineno-2-2208" name="__codelineno-2-2208" href="#__codelineno-2-2208"></a><span class="c1"># cPanel: "443,2083,2096"</span>
<a id="__codelineno-2-2209" name="__codelineno-2-2209" href="#__codelineno-2-2209"></a><span class="na">MESSENGER_HTTPS_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"443"</span>
<a id="__codelineno-2-2210" name="__codelineno-2-2210" href="#__codelineno-2-2210"></a>
<a id="__codelineno-2-2211" name="__codelineno-2-2211" href="#__codelineno-2-2211"></a><span class="c1"># Set this to the port that will receive the HTML message. You should configure</span>
<a id="__codelineno-2-2212" name="__codelineno-2-2212" href="#__codelineno-2-2212"></a><span class="c1"># this port to be &gt;1023 and different from the TEXT port. Do NOT enable access</span>
<a id="__codelineno-2-2213" name="__codelineno-2-2213" href="#__codelineno-2-2213"></a><span class="c1"># to this port in TCP_IN</span>
<a id="__codelineno-2-2214" name="__codelineno-2-2214" href="#__codelineno-2-2214"></a><span class="na">MESSENGER_HTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8888"</span>
<a id="__codelineno-2-2215" name="__codelineno-2-2215" href="#__codelineno-2-2215"></a>
<a id="__codelineno-2-2216" name="__codelineno-2-2216" href="#__codelineno-2-2216"></a><span class="c1"># This comma separated list are the HTML ports that will be redirected for the</span>
<a id="__codelineno-2-2217" name="__codelineno-2-2217" href="#__codelineno-2-2217"></a><span class="c1"># blocked IP address. If you are using per application blocking (LF_TRIGGER)</span>
<a id="__codelineno-2-2218" name="__codelineno-2-2218" href="#__codelineno-2-2218"></a><span class="c1"># then only the relevant block port will be redirected to the messenger port</span>
<a id="__codelineno-2-2219" name="__codelineno-2-2219" href="#__codelineno-2-2219"></a><span class="na">MESSENGER_HTML_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80"</span>
<a id="__codelineno-2-2220" name="__codelineno-2-2220" href="#__codelineno-2-2220"></a>
<a id="__codelineno-2-2221" name="__codelineno-2-2221" href="#__codelineno-2-2221"></a><span class="c1"># Set this to the port that will receive the TEXT message. You should configure</span>
<a id="__codelineno-2-2222" name="__codelineno-2-2222" href="#__codelineno-2-2222"></a><span class="c1"># this port to be &gt;1023 and different from the HTML port. Do NOT enable access</span>
<a id="__codelineno-2-2223" name="__codelineno-2-2223" href="#__codelineno-2-2223"></a><span class="c1"># to this port in TCP_IN</span>
<a id="__codelineno-2-2224" name="__codelineno-2-2224" href="#__codelineno-2-2224"></a><span class="na">MESSENGER_TEXT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8889"</span>
<a id="__codelineno-2-2225" name="__codelineno-2-2225" href="#__codelineno-2-2225"></a>
<a id="__codelineno-2-2226" name="__codelineno-2-2226" href="#__codelineno-2-2226"></a><span class="c1"># This comma separated list are the TEXT ports that will be redirected for the</span>
<a id="__codelineno-2-2227" name="__codelineno-2-2227" href="#__codelineno-2-2227"></a><span class="c1"># blocked IP address. If you are using per application blocking (LF_TRIGGER)</span>
<a id="__codelineno-2-2228" name="__codelineno-2-2228" href="#__codelineno-2-2228"></a><span class="c1"># then only the relevant block port will be redirected to the messenger port</span>
<a id="__codelineno-2-2229" name="__codelineno-2-2229" href="#__codelineno-2-2229"></a><span class="na">MESSENGER_TEXT_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"21"</span>
<a id="__codelineno-2-2230" name="__codelineno-2-2230" href="#__codelineno-2-2230"></a>
<a id="__codelineno-2-2231" name="__codelineno-2-2231" href="#__codelineno-2-2231"></a><span class="c1"># These settings limit the rate at which connections can be made to the</span>
<a id="__codelineno-2-2232" name="__codelineno-2-2232" href="#__codelineno-2-2232"></a><span class="c1"># messenger service servers. Its intention is to provide protection from</span>
<a id="__codelineno-2-2233" name="__codelineno-2-2233" href="#__codelineno-2-2233"></a><span class="c1"># attacks or excessive connections to the servers. If the rate is exceeded then</span>
<a id="__codelineno-2-2234" name="__codelineno-2-2234" href="#__codelineno-2-2234"></a><span class="c1"># iptables will revert for the duration to the normal blocking activity</span>
<a id="__codelineno-2-2235" name="__codelineno-2-2235" href="#__codelineno-2-2235"></a><span class="c1">#</span>
<a id="__codelineno-2-2236" name="__codelineno-2-2236" href="#__codelineno-2-2236"></a><span class="c1"># See the iptables man page for the correct --limit rate syntax</span>
<a id="__codelineno-2-2237" name="__codelineno-2-2237" href="#__codelineno-2-2237"></a><span class="na">MESSENGER_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100/s"</span>
<a id="__codelineno-2-2238" name="__codelineno-2-2238" href="#__codelineno-2-2238"></a><span class="na">MESSENGER_BURST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"150"</span>
<a id="__codelineno-2-2239" name="__codelineno-2-2239" href="#__codelineno-2-2239"></a>
<a id="__codelineno-2-2240" name="__codelineno-2-2240" href="#__codelineno-2-2240"></a><span class="c1"># MESSENGERV1 only:</span>
<a id="__codelineno-2-2241" name="__codelineno-2-2241" href="#__codelineno-2-2241"></a><span class="c1">#------------------------------------------------------------------------------</span>
<a id="__codelineno-2-2242" name="__codelineno-2-2242" href="#__codelineno-2-2242"></a><span class="c1"># This is the maximum concurrent connections allowed to each service server</span>
<a id="__codelineno-2-2243" name="__codelineno-2-2243" href="#__codelineno-2-2243"></a><span class="c1">#</span>
<a id="__codelineno-2-2244" name="__codelineno-2-2244" href="#__codelineno-2-2244"></a><span class="c1"># Note: This number should be increased to cater for the number of local images</span>
<a id="__codelineno-2-2245" name="__codelineno-2-2245" href="#__codelineno-2-2245"></a><span class="c1"># served by this page, including one for favicon.ico. This is because each</span>
<a id="__codelineno-2-2246" name="__codelineno-2-2246" href="#__codelineno-2-2246"></a><span class="c1"># image displayed counts as an additional connection</span>
<a id="__codelineno-2-2247" name="__codelineno-2-2247" href="#__codelineno-2-2247"></a><span class="na">MESSENGER_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20"</span>
<a id="__codelineno-2-2248" name="__codelineno-2-2248" href="#__codelineno-2-2248"></a>
<a id="__codelineno-2-2249" name="__codelineno-2-2249" href="#__codelineno-2-2249"></a><span class="c1"># This options ignores ServerAlias definitions that begin with "mail.". This</span>
<a id="__codelineno-2-2250" name="__codelineno-2-2250" href="#__codelineno-2-2250"></a><span class="c1"># can help reduce memory usage on systems that do not require the use of</span>
<a id="__codelineno-2-2251" name="__codelineno-2-2251" href="#__codelineno-2-2251"></a><span class="c1"># MESSENGER_HTTPS on those subdomains</span>
<a id="__codelineno-2-2252" name="__codelineno-2-2252" href="#__codelineno-2-2252"></a><span class="c1">#</span>
<a id="__codelineno-2-2253" name="__codelineno-2-2253" href="#__codelineno-2-2253"></a><span class="c1"># Set to 0 to include these ServerAlias definitions</span>
<a id="__codelineno-2-2254" name="__codelineno-2-2254" href="#__codelineno-2-2254"></a><span class="na">MESSENGER_HTTPS_SKIPMAIL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2255" name="__codelineno-2-2255" href="#__codelineno-2-2255"></a>
<a id="__codelineno-2-2256" name="__codelineno-2-2256" href="#__codelineno-2-2256"></a><span class="c1"># MESSENGERV2 only:</span>
<a id="__codelineno-2-2257" name="__codelineno-2-2257" href="#__codelineno-2-2257"></a><span class="c1">#------------------------------------------------------------------------------</span>
<a id="__codelineno-2-2258" name="__codelineno-2-2258" href="#__codelineno-2-2258"></a><span class="c1"># MESSENGERV2. This option is available on cPanel servers running Apache v2.4+</span>
<a id="__codelineno-2-2259" name="__codelineno-2-2259" href="#__codelineno-2-2259"></a><span class="c1"># under EA4.</span>
<a id="__codelineno-2-2260" name="__codelineno-2-2260" href="#__codelineno-2-2260"></a><span class="c1">#</span>
<a id="__codelineno-2-2261" name="__codelineno-2-2261" href="#__codelineno-2-2261"></a><span class="c1"># This uses the Apache http daemon to provide the web server functionality for</span>
<a id="__codelineno-2-2262" name="__codelineno-2-2262" href="#__codelineno-2-2262"></a><span class="c1"># the MESSENGER HTML and HTTPS services. It uses a fraction of the resources</span>
<a id="__codelineno-2-2263" name="__codelineno-2-2263" href="#__codelineno-2-2263"></a><span class="c1"># that the lfd inbuilt service uses and overcomes the memory overhead of using</span>
<a id="__codelineno-2-2264" name="__codelineno-2-2264" href="#__codelineno-2-2264"></a><span class="c1"># the MESSENGER HTTPS service</span>
<a id="__codelineno-2-2265" name="__codelineno-2-2265" href="#__codelineno-2-2265"></a><span class="c1">#</span>
<a id="__codelineno-2-2266" name="__codelineno-2-2266" href="#__codelineno-2-2266"></a><span class="c1"># For more information consult readme.txt before enabling this option</span>
<a id="__codelineno-2-2267" name="__codelineno-2-2267" href="#__codelineno-2-2267"></a><span class="c1">#MESSENGERV2 = "0"</span>
<a id="__codelineno-2-2268" name="__codelineno-2-2268" href="#__codelineno-2-2268"></a>
<a id="__codelineno-2-2269" name="__codelineno-2-2269" href="#__codelineno-2-2269"></a><span class="c1"># MESSENGERV3 only:</span>
<a id="__codelineno-2-2270" name="__codelineno-2-2270" href="#__codelineno-2-2270"></a><span class="c1">#------------------------------------------------------------------------------</span>
<a id="__codelineno-2-2271" name="__codelineno-2-2271" href="#__codelineno-2-2271"></a><span class="c1"># MESSENGERV3. This option is available on any server running Apache v2.4+,</span>
<a id="__codelineno-2-2272" name="__codelineno-2-2272" href="#__codelineno-2-2272"></a><span class="c1"># Litespeed or Openlitespeed</span>
<a id="__codelineno-2-2273" name="__codelineno-2-2273" href="#__codelineno-2-2273"></a><span class="c1">#</span>
<a id="__codelineno-2-2274" name="__codelineno-2-2274" href="#__codelineno-2-2274"></a><span class="c1"># This uses the web server http daemon to provide the web server functionality</span>
<a id="__codelineno-2-2275" name="__codelineno-2-2275" href="#__codelineno-2-2275"></a><span class="c1"># for the MESSENGER HTML and HTTPS services. It uses a fraction of the</span>
<a id="__codelineno-2-2276" name="__codelineno-2-2276" href="#__codelineno-2-2276"></a><span class="c1"># resources that the lfd inbuilt service uses and overcomes the memory overhead</span>
<a id="__codelineno-2-2277" name="__codelineno-2-2277" href="#__codelineno-2-2277"></a><span class="c1"># of using the MESSENGER HTTPS service</span>
<a id="__codelineno-2-2278" name="__codelineno-2-2278" href="#__codelineno-2-2278"></a><span class="c1">#</span>
<a id="__codelineno-2-2279" name="__codelineno-2-2279" href="#__codelineno-2-2279"></a><span class="c1"># For more information consult readme.txt before enabling this option</span>
<a id="__codelineno-2-2280" name="__codelineno-2-2280" href="#__codelineno-2-2280"></a><span class="na">MESSENGERV3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2281" name="__codelineno-2-2281" href="#__codelineno-2-2281"></a>
<a id="__codelineno-2-2282" name="__codelineno-2-2282" href="#__codelineno-2-2282"></a><span class="c1"># This is the file or directory where the additional web server configuration</span>
<a id="__codelineno-2-2283" name="__codelineno-2-2283" href="#__codelineno-2-2283"></a><span class="c1"># file should be included</span>
<a id="__codelineno-2-2284" name="__codelineno-2-2284" href="#__codelineno-2-2284"></a><span class="na">MESSENGERV3LOCATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/httpd/conf.d/"</span>
<a id="__codelineno-2-2285" name="__codelineno-2-2285" href="#__codelineno-2-2285"></a>
<a id="__codelineno-2-2286" name="__codelineno-2-2286" href="#__codelineno-2-2286"></a><span class="c1"># This is the command to restart the web server</span>
<a id="__codelineno-2-2287" name="__codelineno-2-2287" href="#__codelineno-2-2287"></a><span class="na">MESSENGERV3RESTART</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"service httpd restart"</span>
<a id="__codelineno-2-2288" name="__codelineno-2-2288" href="#__codelineno-2-2288"></a>
<a id="__codelineno-2-2289" name="__codelineno-2-2289" href="#__codelineno-2-2289"></a><span class="c1"># This is the command to test the validity of the web server configuration. If</span>
<a id="__codelineno-2-2290" name="__codelineno-2-2290" href="#__codelineno-2-2290"></a><span class="c1"># using Litespeed, set to ""</span>
<a id="__codelineno-2-2291" name="__codelineno-2-2291" href="#__codelineno-2-2291"></a><span class="na">MESSENGERV3TEST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/sbin/apachectl -t"</span>
<a id="__codelineno-2-2292" name="__codelineno-2-2292" href="#__codelineno-2-2292"></a>
<a id="__codelineno-2-2293" name="__codelineno-2-2293" href="#__codelineno-2-2293"></a><span class="c1"># This must be set to the main httpd.conf file for either Apache or Litespeed</span>
<a id="__codelineno-2-2294" name="__codelineno-2-2294" href="#__codelineno-2-2294"></a><span class="na">MESSENGERV3HTTPS_CONF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/httpd/conf/httpd.conf"</span>
<a id="__codelineno-2-2295" name="__codelineno-2-2295" href="#__codelineno-2-2295"></a>
<a id="__codelineno-2-2296" name="__codelineno-2-2296" href="#__codelineno-2-2296"></a><span class="c1"># This can be set to either:</span>
<a id="__codelineno-2-2297" name="__codelineno-2-2297" href="#__codelineno-2-2297"></a><span class="c1"># "apache" - for servers running Apache v2.4+ or Litespeed using Apache</span>
<a id="__codelineno-2-2298" name="__codelineno-2-2298" href="#__codelineno-2-2298"></a><span class="c1"># configuration</span>
<a id="__codelineno-2-2299" name="__codelineno-2-2299" href="#__codelineno-2-2299"></a><span class="c1"># "litespeed" - for Litespeed or Openlitespeed</span>
<a id="__codelineno-2-2300" name="__codelineno-2-2300" href="#__codelineno-2-2300"></a><span class="na">MESSENGERV3WEBSERVER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"apache"</span>
<a id="__codelineno-2-2301" name="__codelineno-2-2301" href="#__codelineno-2-2301"></a>
<a id="__codelineno-2-2302" name="__codelineno-2-2302" href="#__codelineno-2-2302"></a><span class="c1"># On creation, set the MESSENGER_USER public_html directory permissions to</span>
<a id="__codelineno-2-2303" name="__codelineno-2-2303" href="#__codelineno-2-2303"></a><span class="c1"># Note: If you precreate this directory the following setting will be ignored</span>
<a id="__codelineno-2-2304" name="__codelineno-2-2304" href="#__codelineno-2-2304"></a><span class="na">MESSENGERV3PERMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"711"</span>
<a id="__codelineno-2-2305" name="__codelineno-2-2305" href="#__codelineno-2-2305"></a>
<a id="__codelineno-2-2306" name="__codelineno-2-2306" href="#__codelineno-2-2306"></a><span class="c1"># On creation, set the MESSENGER_USER public_html directory group user to</span>
<a id="__codelineno-2-2307" name="__codelineno-2-2307" href="#__codelineno-2-2307"></a><span class="c1"># Note: If you precreate this directory the following setting will be ignored</span>
<a id="__codelineno-2-2308" name="__codelineno-2-2308" href="#__codelineno-2-2308"></a><span class="na">MESSENGERV3GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"apache"</span>
<a id="__codelineno-2-2309" name="__codelineno-2-2309" href="#__codelineno-2-2309"></a>
<a id="__codelineno-2-2310" name="__codelineno-2-2310" href="#__codelineno-2-2310"></a><span class="c1"># This is the web server configuration to allow PHP scripts to run. If left</span>
<a id="__codelineno-2-2311" name="__codelineno-2-2311" href="#__codelineno-2-2311"></a><span class="c1"># empty, the MESSENGER service will try to configure this. If this does not</span>
<a id="__codelineno-2-2312" name="__codelineno-2-2312" href="#__codelineno-2-2312"></a><span class="c1"># work, this should be set as an "Include /path/to/csf_php.conf" or similar</span>
<a id="__codelineno-2-2313" name="__codelineno-2-2313" href="#__codelineno-2-2313"></a><span class="c1"># file which must contain appropriate web server configuration to allow PHP</span>
<a id="__codelineno-2-2314" name="__codelineno-2-2314" href="#__codelineno-2-2314"></a><span class="c1"># scripts to run. This line will be included within each MESSENGER VirtualHost</span>
<a id="__codelineno-2-2315" name="__codelineno-2-2315" href="#__codelineno-2-2315"></a><span class="c1"># container. This will replace the [MESSENGERV3PHPHANDLER] line from the csf</span>
<a id="__codelineno-2-2316" name="__codelineno-2-2316" href="#__codelineno-2-2316"></a><span class="c1"># webserver template files</span>
<a id="__codelineno-2-2317" name="__codelineno-2-2317" href="#__codelineno-2-2317"></a><span class="na">MESSENGERV3PHPHANDLER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2318" name="__codelineno-2-2318" href="#__codelineno-2-2318"></a>
<a id="__codelineno-2-2319" name="__codelineno-2-2319" href="#__codelineno-2-2319"></a><span class="c1"># RECAPTCHA:</span>
<a id="__codelineno-2-2320" name="__codelineno-2-2320" href="#__codelineno-2-2320"></a><span class="c1">#------------------------------------------------------------------------------</span>
<a id="__codelineno-2-2321" name="__codelineno-2-2321" href="#__codelineno-2-2321"></a><span class="c1"># The RECAPTCHA options provide a way for end-users that have blocked</span>
<a id="__codelineno-2-2322" name="__codelineno-2-2322" href="#__codelineno-2-2322"></a><span class="c1"># themselves in the firewall to unblock themselves.</span>
<a id="__codelineno-2-2323" name="__codelineno-2-2323" href="#__codelineno-2-2323"></a><span class="c1">#</span>
<a id="__codelineno-2-2324" name="__codelineno-2-2324" href="#__codelineno-2-2324"></a><span class="c1"># A valid Google ReCAPTCHA (v2) key set is required for this feature from:</span>
<a id="__codelineno-2-2325" name="__codelineno-2-2325" href="#__codelineno-2-2325"></a><span class="c1"># https://www.google.com/recaptcha/intro/index.html</span>
<a id="__codelineno-2-2326" name="__codelineno-2-2326" href="#__codelineno-2-2326"></a><span class="c1">#</span>
<a id="__codelineno-2-2327" name="__codelineno-2-2327" href="#__codelineno-2-2327"></a><span class="c1"># When configuring a new reCAPTCHA API key set you must ensure that the option</span>
<a id="__codelineno-2-2328" name="__codelineno-2-2328" href="#__codelineno-2-2328"></a><span class="c1"># for "Domain Name Validation" is unticked so that the same reCAPTCHA can be</span>
<a id="__codelineno-2-2329" name="__codelineno-2-2329" href="#__codelineno-2-2329"></a><span class="c1"># used for all domains hosted on the server. lfd then checks that the hostname</span>
<a id="__codelineno-2-2330" name="__codelineno-2-2330" href="#__codelineno-2-2330"></a><span class="c1"># of the request resolves to an IP on this server</span>
<a id="__codelineno-2-2331" name="__codelineno-2-2331" href="#__codelineno-2-2331"></a><span class="c1">#</span>
<a id="__codelineno-2-2332" name="__codelineno-2-2332" href="#__codelineno-2-2332"></a><span class="c1"># This feature requires the installation of the LWP::UserAgent perl module (see</span>
<a id="__codelineno-2-2333" name="__codelineno-2-2333" href="#__codelineno-2-2333"></a><span class="c1"># option URLGET for more details)</span>
<a id="__codelineno-2-2334" name="__codelineno-2-2334" href="#__codelineno-2-2334"></a><span class="c1">#</span>
<a id="__codelineno-2-2335" name="__codelineno-2-2335" href="#__codelineno-2-2335"></a><span class="c1"># The template used for this feature is /etc/csf/messenger/index.recaptcha.html</span>
<a id="__codelineno-2-2336" name="__codelineno-2-2336" href="#__codelineno-2-2336"></a><span class="c1">#</span>
<a id="__codelineno-2-2337" name="__codelineno-2-2337" href="#__codelineno-2-2337"></a><span class="c1"># Note: An unblock will fail if the end-users IP is located in a netblock,</span>
<a id="__codelineno-2-2338" name="__codelineno-2-2338" href="#__codelineno-2-2338"></a><span class="c1"># blocklist or CC_* deny entry</span>
<a id="__codelineno-2-2339" name="__codelineno-2-2339" href="#__codelineno-2-2339"></a><span class="na">RECAPTCHA_SITEKEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2340" name="__codelineno-2-2340" href="#__codelineno-2-2340"></a><span class="na">RECAPTCHA_SECRET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2341" name="__codelineno-2-2341" href="#__codelineno-2-2341"></a>
<a id="__codelineno-2-2342" name="__codelineno-2-2342" href="#__codelineno-2-2342"></a><span class="c1"># Send an email when an IP address successfully attempts to unblock themselves.</span>
<a id="__codelineno-2-2343" name="__codelineno-2-2343" href="#__codelineno-2-2343"></a><span class="c1"># This does not necessarily mean the IP was unblocked, only that the</span>
<a id="__codelineno-2-2344" name="__codelineno-2-2344" href="#__codelineno-2-2344"></a><span class="c1"># post-recaptcha unblock request was attempted</span>
<a id="__codelineno-2-2345" name="__codelineno-2-2345" href="#__codelineno-2-2345"></a><span class="c1">#</span>
<a id="__codelineno-2-2346" name="__codelineno-2-2346" href="#__codelineno-2-2346"></a><span class="c1"># Set to "0" to disable</span>
<a id="__codelineno-2-2347" name="__codelineno-2-2347" href="#__codelineno-2-2347"></a><span class="na">RECAPTCHA_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2348" name="__codelineno-2-2348" href="#__codelineno-2-2348"></a>
<a id="__codelineno-2-2349" name="__codelineno-2-2349" href="#__codelineno-2-2349"></a><span class="c1"># If the server uses NAT then resolving the hostname to hosted IPs will likely</span>
<a id="__codelineno-2-2350" name="__codelineno-2-2350" href="#__codelineno-2-2350"></a><span class="c1"># not succeed. In that case, the external IP addresses must be listed as comma</span>
<a id="__codelineno-2-2351" name="__codelineno-2-2351" href="#__codelineno-2-2351"></a><span class="c1"># separated list here</span>
<a id="__codelineno-2-2352" name="__codelineno-2-2352" href="#__codelineno-2-2352"></a><span class="na">RECAPTCHA_NAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2353" name="__codelineno-2-2353" href="#__codelineno-2-2353"></a>
<a id="__codelineno-2-2354" name="__codelineno-2-2354" href="#__codelineno-2-2354"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2355" name="__codelineno-2-2355" href="#__codelineno-2-2355"></a><span class="c1"># SECTION:lfd Clustering</span>
<a id="__codelineno-2-2356" name="__codelineno-2-2356" href="#__codelineno-2-2356"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2357" name="__codelineno-2-2357" href="#__codelineno-2-2357"></a><span class="c1"># lfd Clustering. This allows the configuration of an lfd cluster environment</span>
<a id="__codelineno-2-2358" name="__codelineno-2-2358" href="#__codelineno-2-2358"></a><span class="c1"># where a group of servers can share blocks and configuration option changes.</span>
<a id="__codelineno-2-2359" name="__codelineno-2-2359" href="#__codelineno-2-2359"></a><span class="c1"># Included are CLI and UI options to send requests to the cluster.</span>
<a id="__codelineno-2-2360" name="__codelineno-2-2360" href="#__codelineno-2-2360"></a><span class="c1">#</span>
<a id="__codelineno-2-2361" name="__codelineno-2-2361" href="#__codelineno-2-2361"></a><span class="c1"># See the readme.txt file for more information and details on setup and</span>
<a id="__codelineno-2-2362" name="__codelineno-2-2362" href="#__codelineno-2-2362"></a><span class="c1"># security risks.</span>
<a id="__codelineno-2-2363" name="__codelineno-2-2363" href="#__codelineno-2-2363"></a><span class="c1">#</span>
<a id="__codelineno-2-2364" name="__codelineno-2-2364" href="#__codelineno-2-2364"></a><span class="c1"># Set this to a comma separated list of cluster member IP addresses to send</span>
<a id="__codelineno-2-2365" name="__codelineno-2-2365" href="#__codelineno-2-2365"></a><span class="c1"># requests to. Alternatively, it can be set to the full path of a file that</span>
<a id="__codelineno-2-2366" name="__codelineno-2-2366" href="#__codelineno-2-2366"></a><span class="c1"># will read in one IP per line, e.g.:</span>
<a id="__codelineno-2-2367" name="__codelineno-2-2367" href="#__codelineno-2-2367"></a><span class="c1"># "/etc/csf/cluster_sendto.txt"</span>
<a id="__codelineno-2-2368" name="__codelineno-2-2368" href="#__codelineno-2-2368"></a><span class="na">CLUSTER_SENDTO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2369" name="__codelineno-2-2369" href="#__codelineno-2-2369"></a>
<a id="__codelineno-2-2370" name="__codelineno-2-2370" href="#__codelineno-2-2370"></a><span class="c1"># Set this to a comma separated list of cluster member IP addresses to receive</span>
<a id="__codelineno-2-2371" name="__codelineno-2-2371" href="#__codelineno-2-2371"></a><span class="c1"># requests from. Alternatively, it can be set to the full path of a file that</span>
<a id="__codelineno-2-2372" name="__codelineno-2-2372" href="#__codelineno-2-2372"></a><span class="c1"># will read in one IP per line, e.g.:</span>
<a id="__codelineno-2-2373" name="__codelineno-2-2373" href="#__codelineno-2-2373"></a><span class="c1"># "/etc/csf/cluster_recvfrom.txt"</span>
<a id="__codelineno-2-2374" name="__codelineno-2-2374" href="#__codelineno-2-2374"></a><span class="na">CLUSTER_RECVFROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2375" name="__codelineno-2-2375" href="#__codelineno-2-2375"></a>
<a id="__codelineno-2-2376" name="__codelineno-2-2376" href="#__codelineno-2-2376"></a><span class="c1"># IP address of the master node in the cluster allowed to send CLUSTER_CONFIG</span>
<a id="__codelineno-2-2377" name="__codelineno-2-2377" href="#__codelineno-2-2377"></a><span class="c1"># changes</span>
<a id="__codelineno-2-2378" name="__codelineno-2-2378" href="#__codelineno-2-2378"></a><span class="na">CLUSTER_MASTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2379" name="__codelineno-2-2379" href="#__codelineno-2-2379"></a>
<a id="__codelineno-2-2380" name="__codelineno-2-2380" href="#__codelineno-2-2380"></a><span class="c1"># If this is a NAT server, set this to the public IP address of this server</span>
<a id="__codelineno-2-2381" name="__codelineno-2-2381" href="#__codelineno-2-2381"></a><span class="na">CLUSTER_NAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2382" name="__codelineno-2-2382" href="#__codelineno-2-2382"></a>
<a id="__codelineno-2-2383" name="__codelineno-2-2383" href="#__codelineno-2-2383"></a><span class="c1"># If a cluster member should send requests on an IP other than the default IP,</span>
<a id="__codelineno-2-2384" name="__codelineno-2-2384" href="#__codelineno-2-2384"></a><span class="c1"># set it here</span>
<a id="__codelineno-2-2385" name="__codelineno-2-2385" href="#__codelineno-2-2385"></a><span class="na">CLUSTER_LOCALADDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2386" name="__codelineno-2-2386" href="#__codelineno-2-2386"></a>
<a id="__codelineno-2-2387" name="__codelineno-2-2387" href="#__codelineno-2-2387"></a><span class="c1"># Cluster communication port (must be the same on all member servers). There</span>
<a id="__codelineno-2-2388" name="__codelineno-2-2388" href="#__codelineno-2-2388"></a><span class="c1"># is no need to open this port in the firewall as csf will automatically add</span>
<a id="__codelineno-2-2389" name="__codelineno-2-2389" href="#__codelineno-2-2389"></a><span class="c1"># in and out bound rules to allow communication between cluster members</span>
<a id="__codelineno-2-2390" name="__codelineno-2-2390" href="#__codelineno-2-2390"></a><span class="na">CLUSTER_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"7777"</span>
<a id="__codelineno-2-2391" name="__codelineno-2-2391" href="#__codelineno-2-2391"></a>
<a id="__codelineno-2-2392" name="__codelineno-2-2392" href="#__codelineno-2-2392"></a><span class="c1"># This is a secret key used to encrypt cluster communications using the</span>
<a id="__codelineno-2-2393" name="__codelineno-2-2393" href="#__codelineno-2-2393"></a><span class="c1"># Blowfish algorithm. It should be between 8 and 56 characters long,</span>
<a id="__codelineno-2-2394" name="__codelineno-2-2394" href="#__codelineno-2-2394"></a><span class="c1"># preferably &gt; 20 random characters</span>
<a id="__codelineno-2-2395" name="__codelineno-2-2395" href="#__codelineno-2-2395"></a><span class="c1"># 56 chars:    01234567890123456789012345678901234567890123456789012345</span>
<a id="__codelineno-2-2396" name="__codelineno-2-2396" href="#__codelineno-2-2396"></a><span class="na">CLUSTER_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2397" name="__codelineno-2-2397" href="#__codelineno-2-2397"></a>
<a id="__codelineno-2-2398" name="__codelineno-2-2398" href="#__codelineno-2-2398"></a><span class="c1"># Automatically send lfd blocks to all members of CLUSTER_SENDTO. Those</span>
<a id="__codelineno-2-2399" name="__codelineno-2-2399" href="#__codelineno-2-2399"></a><span class="c1"># servers must have this servers IP address listed in their CLUSTER_RECVFROM</span>
<a id="__codelineno-2-2400" name="__codelineno-2-2400" href="#__codelineno-2-2400"></a><span class="c1">#</span>
<a id="__codelineno-2-2401" name="__codelineno-2-2401" href="#__codelineno-2-2401"></a><span class="c1"># Set to 0 to disable this feature</span>
<a id="__codelineno-2-2402" name="__codelineno-2-2402" href="#__codelineno-2-2402"></a><span class="na">CLUSTER_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2403" name="__codelineno-2-2403" href="#__codelineno-2-2403"></a>
<a id="__codelineno-2-2404" name="__codelineno-2-2404" href="#__codelineno-2-2404"></a><span class="c1"># This option allows the enabling and disabling of the Cluster configuration</span>
<a id="__codelineno-2-2405" name="__codelineno-2-2405" href="#__codelineno-2-2405"></a><span class="c1"># changing options --cconfig, --cconfigr, --cfile, --ccfile sent from the</span>
<a id="__codelineno-2-2406" name="__codelineno-2-2406" href="#__codelineno-2-2406"></a><span class="c1"># CLUSTER_MASTER server</span>
<a id="__codelineno-2-2407" name="__codelineno-2-2407" href="#__codelineno-2-2407"></a><span class="c1">#</span>
<a id="__codelineno-2-2408" name="__codelineno-2-2408" href="#__codelineno-2-2408"></a><span class="c1"># Set this option to 1 to allow Cluster configurations to be received</span>
<a id="__codelineno-2-2409" name="__codelineno-2-2409" href="#__codelineno-2-2409"></a><span class="na">CLUSTER_CONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2410" name="__codelineno-2-2410" href="#__codelineno-2-2410"></a>
<a id="__codelineno-2-2411" name="__codelineno-2-2411" href="#__codelineno-2-2411"></a><span class="c1"># Maximum number of child processes to listen on. High blocking rates or large</span>
<a id="__codelineno-2-2412" name="__codelineno-2-2412" href="#__codelineno-2-2412"></a><span class="c1"># clusters may need to increase this</span>
<a id="__codelineno-2-2413" name="__codelineno-2-2413" href="#__codelineno-2-2413"></a><span class="na">CLUSTER_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-2-2414" name="__codelineno-2-2414" href="#__codelineno-2-2414"></a>
<a id="__codelineno-2-2415" name="__codelineno-2-2415" href="#__codelineno-2-2415"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2416" name="__codelineno-2-2416" href="#__codelineno-2-2416"></a><span class="c1"># SECTION:Port Knocking</span>
<a id="__codelineno-2-2417" name="__codelineno-2-2417" href="#__codelineno-2-2417"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2418" name="__codelineno-2-2418" href="#__codelineno-2-2418"></a><span class="c1"># Port Knocking. This feature allows port knocking to be enabled on multiple</span>
<a id="__codelineno-2-2419" name="__codelineno-2-2419" href="#__codelineno-2-2419"></a><span class="c1"># ports with a variable number of knocked ports and a timeout. There must be a</span>
<a id="__codelineno-2-2420" name="__codelineno-2-2420" href="#__codelineno-2-2420"></a><span class="c1"># minimum of 3 ports to knock for an entry to be valid</span>
<a id="__codelineno-2-2421" name="__codelineno-2-2421" href="#__codelineno-2-2421"></a><span class="c1">#</span>
<a id="__codelineno-2-2422" name="__codelineno-2-2422" href="#__codelineno-2-2422"></a><span class="c1"># See the following for information regarding Port Knocking:</span>
<a id="__codelineno-2-2423" name="__codelineno-2-2423" href="#__codelineno-2-2423"></a><span class="c1"># http://www.portknocking.org/</span>
<a id="__codelineno-2-2424" name="__codelineno-2-2424" href="#__codelineno-2-2424"></a><span class="c1">#</span>
<a id="__codelineno-2-2425" name="__codelineno-2-2425" href="#__codelineno-2-2425"></a><span class="c1"># This feature does not work on servers that do not have the iptables module</span>
<a id="__codelineno-2-2426" name="__codelineno-2-2426" href="#__codelineno-2-2426"></a><span class="c1"># ipt_recent loaded. Typically, this will be with MONOLITHIC kernels. VPS</span>
<a id="__codelineno-2-2427" name="__codelineno-2-2427" href="#__codelineno-2-2427"></a><span class="c1"># server admins should check with their VPS host provider that the iptables</span>
<a id="__codelineno-2-2428" name="__codelineno-2-2428" href="#__codelineno-2-2428"></a><span class="c1"># module is included</span>
<a id="__codelineno-2-2429" name="__codelineno-2-2429" href="#__codelineno-2-2429"></a><span class="c1">#</span>
<a id="__codelineno-2-2430" name="__codelineno-2-2430" href="#__codelineno-2-2430"></a><span class="c1"># For further information and syntax refer to the Port Knocking section of the</span>
<a id="__codelineno-2-2431" name="__codelineno-2-2431" href="#__codelineno-2-2431"></a><span class="c1"># csf readme.txt</span>
<a id="__codelineno-2-2432" name="__codelineno-2-2432" href="#__codelineno-2-2432"></a><span class="c1">#</span>
<a id="__codelineno-2-2433" name="__codelineno-2-2433" href="#__codelineno-2-2433"></a><span class="c1"># Note: Run /etc/csf/csftest.pl to check whether this option will function on</span>
<a id="__codelineno-2-2434" name="__codelineno-2-2434" href="#__codelineno-2-2434"></a><span class="c1"># this server</span>
<a id="__codelineno-2-2435" name="__codelineno-2-2435" href="#__codelineno-2-2435"></a><span class="c1">#</span>
<a id="__codelineno-2-2436" name="__codelineno-2-2436" href="#__codelineno-2-2436"></a><span class="c1"># openport;protocol;timeout;kport1;kport2;kport3[...;kportN],...</span>
<a id="__codelineno-2-2437" name="__codelineno-2-2437" href="#__codelineno-2-2437"></a><span class="c1"># e.g.: 22;TCP;20;100;200;300;400</span>
<a id="__codelineno-2-2438" name="__codelineno-2-2438" href="#__codelineno-2-2438"></a><span class="na">PORTKNOCKING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2439" name="__codelineno-2-2439" href="#__codelineno-2-2439"></a>
<a id="__codelineno-2-2440" name="__codelineno-2-2440" href="#__codelineno-2-2440"></a><span class="c1"># Enable PORTKNOCKING logging by iptables</span>
<a id="__codelineno-2-2441" name="__codelineno-2-2441" href="#__codelineno-2-2441"></a><span class="na">PORTKNOCKING_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2442" name="__codelineno-2-2442" href="#__codelineno-2-2442"></a>
<a id="__codelineno-2-2443" name="__codelineno-2-2443" href="#__codelineno-2-2443"></a><span class="c1"># Send an email alert if the PORTKNOCKING port is opened. PORTKNOCKING_LOG must</span>
<a id="__codelineno-2-2444" name="__codelineno-2-2444" href="#__codelineno-2-2444"></a><span class="c1"># also be enabled to use this option</span>
<a id="__codelineno-2-2445" name="__codelineno-2-2445" href="#__codelineno-2-2445"></a><span class="c1">#</span>
<a id="__codelineno-2-2446" name="__codelineno-2-2446" href="#__codelineno-2-2446"></a><span class="c1"># SECURITY NOTE: This option is affected by the RESTRICT_SYSLOG option. Read</span>
<a id="__codelineno-2-2447" name="__codelineno-2-2447" href="#__codelineno-2-2447"></a><span class="c1"># this file about RESTRICT_SYSLOG before enabling this option:</span>
<a id="__codelineno-2-2448" name="__codelineno-2-2448" href="#__codelineno-2-2448"></a><span class="na">PORTKNOCKING_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2449" name="__codelineno-2-2449" href="#__codelineno-2-2449"></a>
<a id="__codelineno-2-2450" name="__codelineno-2-2450" href="#__codelineno-2-2450"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2451" name="__codelineno-2-2451" href="#__codelineno-2-2451"></a><span class="c1"># SECTION:Log Scanner</span>
<a id="__codelineno-2-2452" name="__codelineno-2-2452" href="#__codelineno-2-2452"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2453" name="__codelineno-2-2453" href="#__codelineno-2-2453"></a><span class="c1"># Log Scanner. This feature will send out an email summary of the log lines of</span>
<a id="__codelineno-2-2454" name="__codelineno-2-2454" href="#__codelineno-2-2454"></a><span class="c1"># each log listed in /etc/csf/csf.logfiles. All lines will be reported unless</span>
<a id="__codelineno-2-2455" name="__codelineno-2-2455" href="#__codelineno-2-2455"></a><span class="c1"># they match a regular expression in /etc/csf/csf.logignore</span>
<a id="__codelineno-2-2456" name="__codelineno-2-2456" href="#__codelineno-2-2456"></a><span class="c1">#</span>
<a id="__codelineno-2-2457" name="__codelineno-2-2457" href="#__codelineno-2-2457"></a><span class="c1"># File globbing is supported for logs listed in /etc/csf/csf.logfiles. However,</span>
<a id="__codelineno-2-2458" name="__codelineno-2-2458" href="#__codelineno-2-2458"></a><span class="c1"># be aware that the more files lfd has to track, the greater the performance</span>
<a id="__codelineno-2-2459" name="__codelineno-2-2459" href="#__codelineno-2-2459"></a><span class="c1"># hit. Note: File globs are only evaluated when lfd is started</span>
<a id="__codelineno-2-2460" name="__codelineno-2-2460" href="#__codelineno-2-2460"></a><span class="c1">#</span>
<a id="__codelineno-2-2461" name="__codelineno-2-2461" href="#__codelineno-2-2461"></a><span class="c1"># Note: lfd builds the report continuously from lines logged after lfd has</span>
<a id="__codelineno-2-2462" name="__codelineno-2-2462" href="#__codelineno-2-2462"></a><span class="c1"># started, so any lines logged when lfd is not running will not be reported</span>
<a id="__codelineno-2-2463" name="__codelineno-2-2463" href="#__codelineno-2-2463"></a><span class="c1"># (e.g. during reboot). If lfd is restarted, then the report will include any</span>
<a id="__codelineno-2-2464" name="__codelineno-2-2464" href="#__codelineno-2-2464"></a><span class="c1"># lines logged during the previous lfd logging period that weren't reported</span>
<a id="__codelineno-2-2465" name="__codelineno-2-2465" href="#__codelineno-2-2465"></a><span class="c1">#</span>
<a id="__codelineno-2-2466" name="__codelineno-2-2466" href="#__codelineno-2-2466"></a><span class="c1"># 1 to enable, 0 to disable</span>
<a id="__codelineno-2-2467" name="__codelineno-2-2467" href="#__codelineno-2-2467"></a><span class="na">LOGSCANNER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2468" name="__codelineno-2-2468" href="#__codelineno-2-2468"></a>
<a id="__codelineno-2-2469" name="__codelineno-2-2469" href="#__codelineno-2-2469"></a><span class="c1"># This is the interval each report will be sent based on the logalert.txt</span>
<a id="__codelineno-2-2470" name="__codelineno-2-2470" href="#__codelineno-2-2470"></a><span class="c1"># template</span>
<a id="__codelineno-2-2471" name="__codelineno-2-2471" href="#__codelineno-2-2471"></a><span class="c1">#</span>
<a id="__codelineno-2-2472" name="__codelineno-2-2472" href="#__codelineno-2-2472"></a><span class="c1"># The interval can be set to:</span>
<a id="__codelineno-2-2473" name="__codelineno-2-2473" href="#__codelineno-2-2473"></a><span class="c1"># "hourly" - sent on the hour</span>
<a id="__codelineno-2-2474" name="__codelineno-2-2474" href="#__codelineno-2-2474"></a><span class="c1"># "daily"  - sent at midnight (00:00)</span>
<a id="__codelineno-2-2475" name="__codelineno-2-2475" href="#__codelineno-2-2475"></a><span class="c1"># "manual" - sent whenever "csf --logrun" is run. This allows for scheduling</span>
<a id="__codelineno-2-2476" name="__codelineno-2-2476" href="#__codelineno-2-2476"></a><span class="c1">#            via cron job</span>
<a id="__codelineno-2-2477" name="__codelineno-2-2477" href="#__codelineno-2-2477"></a><span class="na">LOGSCANNER_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"hourly"</span>
<a id="__codelineno-2-2478" name="__codelineno-2-2478" href="#__codelineno-2-2478"></a>
<a id="__codelineno-2-2479" name="__codelineno-2-2479" href="#__codelineno-2-2479"></a><span class="c1"># Report Style</span>
<a id="__codelineno-2-2480" name="__codelineno-2-2480" href="#__codelineno-2-2480"></a><span class="c1"># 1 = Separate chronological log lines per log file</span>
<a id="__codelineno-2-2481" name="__codelineno-2-2481" href="#__codelineno-2-2481"></a><span class="c1"># 2 = Simply chronological log of all lines</span>
<a id="__codelineno-2-2482" name="__codelineno-2-2482" href="#__codelineno-2-2482"></a><span class="na">LOGSCANNER_STYLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2483" name="__codelineno-2-2483" href="#__codelineno-2-2483"></a>
<a id="__codelineno-2-2484" name="__codelineno-2-2484" href="#__codelineno-2-2484"></a><span class="c1"># Send the report email even if no log lines reported</span>
<a id="__codelineno-2-2485" name="__codelineno-2-2485" href="#__codelineno-2-2485"></a><span class="c1"># 1 to enable, 0 to disable</span>
<a id="__codelineno-2-2486" name="__codelineno-2-2486" href="#__codelineno-2-2486"></a><span class="na">LOGSCANNER_EMPTY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2487" name="__codelineno-2-2487" href="#__codelineno-2-2487"></a>
<a id="__codelineno-2-2488" name="__codelineno-2-2488" href="#__codelineno-2-2488"></a><span class="c1"># Maximum number of lines in the report before it is truncated. This is to</span>
<a id="__codelineno-2-2489" name="__codelineno-2-2489" href="#__codelineno-2-2489"></a><span class="c1"># prevent log lines flooding resulting in an excessively large report. This</span>
<a id="__codelineno-2-2490" name="__codelineno-2-2490" href="#__codelineno-2-2490"></a><span class="c1"># might need to be increased if you choose a daily report</span>
<a id="__codelineno-2-2491" name="__codelineno-2-2491" href="#__codelineno-2-2491"></a><span class="na">LOGSCANNER_LINES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5000"</span>
<a id="__codelineno-2-2492" name="__codelineno-2-2492" href="#__codelineno-2-2492"></a>
<a id="__codelineno-2-2493" name="__codelineno-2-2493" href="#__codelineno-2-2493"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2494" name="__codelineno-2-2494" href="#__codelineno-2-2494"></a><span class="c1"># SECTION:Statistics Settings</span>
<a id="__codelineno-2-2495" name="__codelineno-2-2495" href="#__codelineno-2-2495"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2496" name="__codelineno-2-2496" href="#__codelineno-2-2496"></a><span class="c1"># Statistics</span>
<a id="__codelineno-2-2497" name="__codelineno-2-2497" href="#__codelineno-2-2497"></a><span class="c1">#</span>
<a id="__codelineno-2-2498" name="__codelineno-2-2498" href="#__codelineno-2-2498"></a><span class="c1"># Some of the Statistics output requires the gd graphics library and the</span>
<a id="__codelineno-2-2499" name="__codelineno-2-2499" href="#__codelineno-2-2499"></a><span class="c1"># GD::Graph perl module with all dependent modules to be installed for the UI</span>
<a id="__codelineno-2-2500" name="__codelineno-2-2500" href="#__codelineno-2-2500"></a><span class="c1"># for them to be displayed</span>
<a id="__codelineno-2-2501" name="__codelineno-2-2501" href="#__codelineno-2-2501"></a><span class="c1">#</span>
<a id="__codelineno-2-2502" name="__codelineno-2-2502" href="#__codelineno-2-2502"></a><span class="c1"># This option enabled statistical data gathering</span>
<a id="__codelineno-2-2503" name="__codelineno-2-2503" href="#__codelineno-2-2503"></a><span class="na">ST_ENABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2504" name="__codelineno-2-2504" href="#__codelineno-2-2504"></a>
<a id="__codelineno-2-2505" name="__codelineno-2-2505" href="#__codelineno-2-2505"></a><span class="c1"># This option determines how many iptables log lines to store for reports</span>
<a id="__codelineno-2-2506" name="__codelineno-2-2506" href="#__codelineno-2-2506"></a><span class="na">ST_IPTABLES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100"</span>
<a id="__codelineno-2-2507" name="__codelineno-2-2507" href="#__codelineno-2-2507"></a>
<a id="__codelineno-2-2508" name="__codelineno-2-2508" href="#__codelineno-2-2508"></a><span class="c1"># This option indicates whether rDNS and CC lookups are performed at the time</span>
<a id="__codelineno-2-2509" name="__codelineno-2-2509" href="#__codelineno-2-2509"></a><span class="c1"># the log line is recorded (this is not performed when viewing the reports)</span>
<a id="__codelineno-2-2510" name="__codelineno-2-2510" href="#__codelineno-2-2510"></a><span class="c1">#</span>
<a id="__codelineno-2-2511" name="__codelineno-2-2511" href="#__codelineno-2-2511"></a><span class="c1"># Warning: If DROP_IP_LOGGING is enabled and there are frequent iptables hits,</span>
<a id="__codelineno-2-2512" name="__codelineno-2-2512" href="#__codelineno-2-2512"></a><span class="c1"># then enabling this setting could cause serious performance problems</span>
<a id="__codelineno-2-2513" name="__codelineno-2-2513" href="#__codelineno-2-2513"></a><span class="na">ST_LOOKUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2514" name="__codelineno-2-2514" href="#__codelineno-2-2514"></a>
<a id="__codelineno-2-2515" name="__codelineno-2-2515" href="#__codelineno-2-2515"></a><span class="c1"># This option will gather basic system statstics. Through the UI it displays</span>
<a id="__codelineno-2-2516" name="__codelineno-2-2516" href="#__codelineno-2-2516"></a><span class="c1"># various graphs for disk, cpu, memory, network, etc usage over 4 intervals:</span>
<a id="__codelineno-2-2517" name="__codelineno-2-2517" href="#__codelineno-2-2517"></a><span class="c1">#  . Hourly (per minute)</span>
<a id="__codelineno-2-2518" name="__codelineno-2-2518" href="#__codelineno-2-2518"></a><span class="c1">#  . 24 hours (per minute)</span>
<a id="__codelineno-2-2519" name="__codelineno-2-2519" href="#__codelineno-2-2519"></a><span class="c1">#  . 7 days (per minute averaged over an hour)</span>
<a id="__codelineno-2-2520" name="__codelineno-2-2520" href="#__codelineno-2-2520"></a><span class="c1">#  . 30 days (per minute averaged over an hour) - user definable</span>
<a id="__codelineno-2-2521" name="__codelineno-2-2521" href="#__codelineno-2-2521"></a><span class="c1"># The data is stored in /var/lib/csf/stats/system and the option requires the</span>
<a id="__codelineno-2-2522" name="__codelineno-2-2522" href="#__codelineno-2-2522"></a><span class="c1"># perl GD::Graph module</span>
<a id="__codelineno-2-2523" name="__codelineno-2-2523" href="#__codelineno-2-2523"></a><span class="c1">#</span>
<a id="__codelineno-2-2524" name="__codelineno-2-2524" href="#__codelineno-2-2524"></a><span class="c1"># Note: Disk graphs do not show on Virtuozzo/OpenVZ servers as the kernel on</span>
<a id="__codelineno-2-2525" name="__codelineno-2-2525" href="#__codelineno-2-2525"></a><span class="c1"># those systems do not store the required information in /proc/diskstats</span>
<a id="__codelineno-2-2526" name="__codelineno-2-2526" href="#__codelineno-2-2526"></a><span class="c1"># On new installations or when enabling this option it will take time for these</span>
<a id="__codelineno-2-2527" name="__codelineno-2-2527" href="#__codelineno-2-2527"></a><span class="c1"># graphs to be populated</span>
<a id="__codelineno-2-2528" name="__codelineno-2-2528" href="#__codelineno-2-2528"></a><span class="na">ST_SYSTEM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2529" name="__codelineno-2-2529" href="#__codelineno-2-2529"></a>
<a id="__codelineno-2-2530" name="__codelineno-2-2530" href="#__codelineno-2-2530"></a><span class="c1"># Set the maximum days to collect statistics for. The default is 30 days, the</span>
<a id="__codelineno-2-2531" name="__codelineno-2-2531" href="#__codelineno-2-2531"></a><span class="c1"># more data that is collected the longer it will take for each of the graphs to</span>
<a id="__codelineno-2-2532" name="__codelineno-2-2532" href="#__codelineno-2-2532"></a><span class="c1"># be generated</span>
<a id="__codelineno-2-2533" name="__codelineno-2-2533" href="#__codelineno-2-2533"></a><span class="na">ST_SYSTEM_MAXDAYS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"30"</span>
<a id="__codelineno-2-2534" name="__codelineno-2-2534" href="#__codelineno-2-2534"></a>
<a id="__codelineno-2-2535" name="__codelineno-2-2535" href="#__codelineno-2-2535"></a><span class="c1"># If ST_SYSTEM is enabled, then these options can collect MySQL statistical</span>
<a id="__codelineno-2-2536" name="__codelineno-2-2536" href="#__codelineno-2-2536"></a><span class="c1"># data. To use this option the server must have the perl modules DBI and</span>
<a id="__codelineno-2-2537" name="__codelineno-2-2537" href="#__codelineno-2-2537"></a><span class="c1"># DBD::mysql installed.</span>
<a id="__codelineno-2-2538" name="__codelineno-2-2538" href="#__codelineno-2-2538"></a><span class="c1">#</span>
<a id="__codelineno-2-2539" name="__codelineno-2-2539" href="#__codelineno-2-2539"></a><span class="c1"># Set this option to "0" to disable MySQL data collection</span>
<a id="__codelineno-2-2540" name="__codelineno-2-2540" href="#__codelineno-2-2540"></a><span class="na">ST_MYSQL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2541" name="__codelineno-2-2541" href="#__codelineno-2-2541"></a>
<a id="__codelineno-2-2542" name="__codelineno-2-2542" href="#__codelineno-2-2542"></a><span class="c1"># The following options are for authentication for MySQL data collection. If</span>
<a id="__codelineno-2-2543" name="__codelineno-2-2543" href="#__codelineno-2-2543"></a><span class="c1"># the password is left blank and the user set to "root" then the procedure will</span>
<a id="__codelineno-2-2544" name="__codelineno-2-2544" href="#__codelineno-2-2544"></a><span class="c1"># look for authentication data in /root/.my.cnf. Otherwise, you will need to</span>
<a id="__codelineno-2-2545" name="__codelineno-2-2545" href="#__codelineno-2-2545"></a><span class="c1"># provide a MySQL username and password to collect the data. Any MySQL user</span>
<a id="__codelineno-2-2546" name="__codelineno-2-2546" href="#__codelineno-2-2546"></a><span class="c1"># account can be used</span>
<a id="__codelineno-2-2547" name="__codelineno-2-2547" href="#__codelineno-2-2547"></a><span class="na">ST_MYSQL_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"root"</span>
<a id="__codelineno-2-2548" name="__codelineno-2-2548" href="#__codelineno-2-2548"></a><span class="na">ST_MYSQL_PASS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-2-2549" name="__codelineno-2-2549" href="#__codelineno-2-2549"></a><span class="na">ST_MYSQL_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"localhost"</span>
<a id="__codelineno-2-2550" name="__codelineno-2-2550" href="#__codelineno-2-2550"></a>
<a id="__codelineno-2-2551" name="__codelineno-2-2551" href="#__codelineno-2-2551"></a><span class="c1"># If ST_SYSTEM is enabled, then this option can collect Apache statistical data</span>
<a id="__codelineno-2-2552" name="__codelineno-2-2552" href="#__codelineno-2-2552"></a><span class="c1"># The value for PT_APACHESTATUS must be correctly set</span>
<a id="__codelineno-2-2553" name="__codelineno-2-2553" href="#__codelineno-2-2553"></a><span class="na">ST_APACHE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2554" name="__codelineno-2-2554" href="#__codelineno-2-2554"></a>
<a id="__codelineno-2-2555" name="__codelineno-2-2555" href="#__codelineno-2-2555"></a><span class="c1"># The following options measure disk write performance using dd (location set</span>
<a id="__codelineno-2-2556" name="__codelineno-2-2556" href="#__codelineno-2-2556"></a><span class="c1"># via the DD setting). It creates a 64MB file called /var/lib/dd_write_test and</span>
<a id="__codelineno-2-2557" name="__codelineno-2-2557" href="#__codelineno-2-2557"></a><span class="c1"># the statistics will plot the MB/s response time of the disk. As this is an IO</span>
<a id="__codelineno-2-2558" name="__codelineno-2-2558" href="#__codelineno-2-2558"></a><span class="c1"># intensive operation, it may not be prudent to run this test too often, so by</span>
<a id="__codelineno-2-2559" name="__codelineno-2-2559" href="#__codelineno-2-2559"></a><span class="c1"># default it is only run every 5 minutes and the result duplicated for each</span>
<a id="__codelineno-2-2560" name="__codelineno-2-2560" href="#__codelineno-2-2560"></a><span class="c1"># intervening minute for the statistics</span>
<a id="__codelineno-2-2561" name="__codelineno-2-2561" href="#__codelineno-2-2561"></a><span class="c1">#</span>
<a id="__codelineno-2-2562" name="__codelineno-2-2562" href="#__codelineno-2-2562"></a><span class="c1"># This is not necessrily a good measure of disk performance, primarily because</span>
<a id="__codelineno-2-2563" name="__codelineno-2-2563" href="#__codelineno-2-2563"></a><span class="c1"># the measurements are for relatively small amounts of data over a small amount</span>
<a id="__codelineno-2-2564" name="__codelineno-2-2564" href="#__codelineno-2-2564"></a><span class="c1"># of time. To properly test disk performance there are a variety of tools</span>
<a id="__codelineno-2-2565" name="__codelineno-2-2565" href="#__codelineno-2-2565"></a><span class="c1"># available that should be run for extended periods of time to obtain an</span>
<a id="__codelineno-2-2566" name="__codelineno-2-2566" href="#__codelineno-2-2566"></a><span class="c1"># accurate measurement. This metric is provided to give an idea of how the disk</span>
<a id="__codelineno-2-2567" name="__codelineno-2-2567" href="#__codelineno-2-2567"></a><span class="c1"># is performing over time</span>
<a id="__codelineno-2-2568" name="__codelineno-2-2568" href="#__codelineno-2-2568"></a><span class="c1">#</span>
<a id="__codelineno-2-2569" name="__codelineno-2-2569" href="#__codelineno-2-2569"></a><span class="c1"># Note: There is a 15 second timeout performing the check</span>
<a id="__codelineno-2-2570" name="__codelineno-2-2570" href="#__codelineno-2-2570"></a><span class="c1">#</span>
<a id="__codelineno-2-2571" name="__codelineno-2-2571" href="#__codelineno-2-2571"></a><span class="c1"># Set to 0 to disable, 1 to enable</span>
<a id="__codelineno-2-2572" name="__codelineno-2-2572" href="#__codelineno-2-2572"></a><span class="na">ST_DISKW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2573" name="__codelineno-2-2573" href="#__codelineno-2-2573"></a>
<a id="__codelineno-2-2574" name="__codelineno-2-2574" href="#__codelineno-2-2574"></a><span class="c1"># The number of minutes that elapse between tests. Default is 5, minimum is 1.</span>
<a id="__codelineno-2-2575" name="__codelineno-2-2575" href="#__codelineno-2-2575"></a><span class="na">ST_DISKW_FREQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-2-2576" name="__codelineno-2-2576" href="#__codelineno-2-2576"></a>
<a id="__codelineno-2-2577" name="__codelineno-2-2577" href="#__codelineno-2-2577"></a><span class="c1"># This is the command line passed to dd. If you are familiar with dd, or wish</span>
<a id="__codelineno-2-2578" name="__codelineno-2-2578" href="#__codelineno-2-2578"></a><span class="c1"># to move the output file (of) to a different disk, then you can alter this</span>
<a id="__codelineno-2-2579" name="__codelineno-2-2579" href="#__codelineno-2-2579"></a><span class="c1"># command. Take great care when making any changes to this command as it is</span>
<a id="__codelineno-2-2580" name="__codelineno-2-2580" href="#__codelineno-2-2580"></a><span class="c1"># very easy to overwrite a disk using dd if you make a mistake</span>
<a id="__codelineno-2-2581" name="__codelineno-2-2581" href="#__codelineno-2-2581"></a><span class="na">ST_DISKW_DD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"if=/dev/zero of=/var/lib/csf/dd_test bs=1MB count=64 conv=fdatasync"</span>
<a id="__codelineno-2-2582" name="__codelineno-2-2582" href="#__codelineno-2-2582"></a>
<a id="__codelineno-2-2583" name="__codelineno-2-2583" href="#__codelineno-2-2583"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2584" name="__codelineno-2-2584" href="#__codelineno-2-2584"></a><span class="c1"># SECTION:Docker Settings</span>
<a id="__codelineno-2-2585" name="__codelineno-2-2585" href="#__codelineno-2-2585"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2586" name="__codelineno-2-2586" href="#__codelineno-2-2586"></a><span class="c1"># This section provides the configuration of iptables rules to allow Docker</span>
<a id="__codelineno-2-2587" name="__codelineno-2-2587" href="#__codelineno-2-2587"></a><span class="c1"># containers to communicate through the host. If the generated rules do not</span>
<a id="__codelineno-2-2588" name="__codelineno-2-2588" href="#__codelineno-2-2588"></a><span class="c1"># work with your setup you will have to use a /etc/csf/csfpost.sh file and add</span>
<a id="__codelineno-2-2589" name="__codelineno-2-2589" href="#__codelineno-2-2589"></a><span class="c1"># your own iptables configuration instead</span>
<a id="__codelineno-2-2590" name="__codelineno-2-2590" href="#__codelineno-2-2590"></a><span class="c1">#</span>
<a id="__codelineno-2-2591" name="__codelineno-2-2591" href="#__codelineno-2-2591"></a><span class="c1"># 1 to enable, 0 to disable</span>
<a id="__codelineno-2-2592" name="__codelineno-2-2592" href="#__codelineno-2-2592"></a><span class="na">DOCKER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2593" name="__codelineno-2-2593" href="#__codelineno-2-2593"></a>
<a id="__codelineno-2-2594" name="__codelineno-2-2594" href="#__codelineno-2-2594"></a><span class="c1"># The network device on the host</span>
<a id="__codelineno-2-2595" name="__codelineno-2-2595" href="#__codelineno-2-2595"></a><span class="na">DOCKER_DEVICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"docker0"</span>
<a id="__codelineno-2-2596" name="__codelineno-2-2596" href="#__codelineno-2-2596"></a>
<a id="__codelineno-2-2597" name="__codelineno-2-2597" href="#__codelineno-2-2597"></a><span class="c1"># Docker container IPv4 range</span>
<a id="__codelineno-2-2598" name="__codelineno-2-2598" href="#__codelineno-2-2598"></a><span class="na">DOCKER_NETWORK4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"172.17.0.0/16"</span>
<a id="__codelineno-2-2599" name="__codelineno-2-2599" href="#__codelineno-2-2599"></a>
<a id="__codelineno-2-2600" name="__codelineno-2-2600" href="#__codelineno-2-2600"></a><span class="c1"># Docker container IPv6 range. IPV6 must be enabled and the IPv6 nat table</span>
<a id="__codelineno-2-2601" name="__codelineno-2-2601" href="#__codelineno-2-2601"></a><span class="c1"># available (see IPv6 section). Leave blank to disable</span>
<a id="__codelineno-2-2602" name="__codelineno-2-2602" href="#__codelineno-2-2602"></a><span class="na">DOCKER_NETWORK6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2001:db8:1::/64"</span>
<a id="__codelineno-2-2603" name="__codelineno-2-2603" href="#__codelineno-2-2603"></a>
<a id="__codelineno-2-2604" name="__codelineno-2-2604" href="#__codelineno-2-2604"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2605" name="__codelineno-2-2605" href="#__codelineno-2-2605"></a><span class="c1"># SECTION:OS Specific Settings</span>
<a id="__codelineno-2-2606" name="__codelineno-2-2606" href="#__codelineno-2-2606"></a><span class="c1">###############################################################################</span>
<a id="__codelineno-2-2607" name="__codelineno-2-2607" href="#__codelineno-2-2607"></a><span class="c1"># Binary locations</span>
<a id="__codelineno-2-2608" name="__codelineno-2-2608" href="#__codelineno-2-2608"></a><span class="na">IPTABLES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/iptables"</span>
<a id="__codelineno-2-2609" name="__codelineno-2-2609" href="#__codelineno-2-2609"></a><span class="na">IPTABLES_SAVE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/iptables-save"</span>
<a id="__codelineno-2-2610" name="__codelineno-2-2610" href="#__codelineno-2-2610"></a><span class="na">IPTABLES_RESTORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/iptables-restore"</span>
<a id="__codelineno-2-2611" name="__codelineno-2-2611" href="#__codelineno-2-2611"></a><span class="na">IP6TABLES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ip6tables"</span>
<a id="__codelineno-2-2612" name="__codelineno-2-2612" href="#__codelineno-2-2612"></a><span class="na">IP6TABLES_SAVE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ip6tables-save"</span>
<a id="__codelineno-2-2613" name="__codelineno-2-2613" href="#__codelineno-2-2613"></a><span class="na">IP6TABLES_RESTORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ip6tables-restore"</span>
<a id="__codelineno-2-2614" name="__codelineno-2-2614" href="#__codelineno-2-2614"></a><span class="na">MODPROBE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/modprobe"</span>
<a id="__codelineno-2-2615" name="__codelineno-2-2615" href="#__codelineno-2-2615"></a><span class="na">IFCONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ifconfig"</span>
<a id="__codelineno-2-2616" name="__codelineno-2-2616" href="#__codelineno-2-2616"></a><span class="na">SENDMAIL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/sbin/sendmail"</span>
<a id="__codelineno-2-2617" name="__codelineno-2-2617" href="#__codelineno-2-2617"></a><span class="na">PS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/ps"</span>
<a id="__codelineno-2-2618" name="__codelineno-2-2618" href="#__codelineno-2-2618"></a><span class="na">VMSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/vmstat"</span>
<a id="__codelineno-2-2619" name="__codelineno-2-2619" href="#__codelineno-2-2619"></a><span class="na">NETSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/netstat"</span>
<a id="__codelineno-2-2620" name="__codelineno-2-2620" href="#__codelineno-2-2620"></a><span class="na">LS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/ls"</span>
<a id="__codelineno-2-2621" name="__codelineno-2-2621" href="#__codelineno-2-2621"></a><span class="na">MD5SUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/md5sum"</span>
<a id="__codelineno-2-2622" name="__codelineno-2-2622" href="#__codelineno-2-2622"></a><span class="na">TAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/tar"</span>
<a id="__codelineno-2-2623" name="__codelineno-2-2623" href="#__codelineno-2-2623"></a><span class="na">CHATTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/chattr"</span>
<a id="__codelineno-2-2624" name="__codelineno-2-2624" href="#__codelineno-2-2624"></a><span class="na">UNZIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/unzip"</span>
<a id="__codelineno-2-2625" name="__codelineno-2-2625" href="#__codelineno-2-2625"></a><span class="na">GUNZIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/gunzip"</span>
<a id="__codelineno-2-2626" name="__codelineno-2-2626" href="#__codelineno-2-2626"></a><span class="na">DD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/dd"</span>
<a id="__codelineno-2-2627" name="__codelineno-2-2627" href="#__codelineno-2-2627"></a><span class="na">TAIL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/tail"</span>
<a id="__codelineno-2-2628" name="__codelineno-2-2628" href="#__codelineno-2-2628"></a><span class="na">GREP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/grep"</span>
<a id="__codelineno-2-2629" name="__codelineno-2-2629" href="#__codelineno-2-2629"></a><span class="na">ZGREP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/zgrep"</span>
<a id="__codelineno-2-2630" name="__codelineno-2-2630" href="#__codelineno-2-2630"></a><span class="na">IPSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ipset"</span>
<a id="__codelineno-2-2631" name="__codelineno-2-2631" href="#__codelineno-2-2631"></a><span class="na">SYSTEMCTL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/systemctl"</span>
<a id="__codelineno-2-2632" name="__codelineno-2-2632" href="#__codelineno-2-2632"></a><span class="na">HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/host"</span>
<a id="__codelineno-2-2633" name="__codelineno-2-2633" href="#__codelineno-2-2633"></a><span class="na">IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/ip"</span>
<a id="__codelineno-2-2634" name="__codelineno-2-2634" href="#__codelineno-2-2634"></a><span class="na">CURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/curl"</span>
<a id="__codelineno-2-2635" name="__codelineno-2-2635" href="#__codelineno-2-2635"></a><span class="na">WGET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/wget"</span>
<a id="__codelineno-2-2636" name="__codelineno-2-2636" href="#__codelineno-2-2636"></a>
<a id="__codelineno-2-2637" name="__codelineno-2-2637" href="#__codelineno-2-2637"></a><span class="c1"># Log file locations</span>
<a id="__codelineno-2-2638" name="__codelineno-2-2638" href="#__codelineno-2-2638"></a><span class="c1">#</span>
<a id="__codelineno-2-2639" name="__codelineno-2-2639" href="#__codelineno-2-2639"></a><span class="c1"># File globbing is allowed for the following logs. However, be aware that the</span>
<a id="__codelineno-2-2640" name="__codelineno-2-2640" href="#__codelineno-2-2640"></a><span class="c1"># more files lfd has to track, the greater the performance hit</span>
<a id="__codelineno-2-2641" name="__codelineno-2-2641" href="#__codelineno-2-2641"></a><span class="c1">#</span>
<a id="__codelineno-2-2642" name="__codelineno-2-2642" href="#__codelineno-2-2642"></a><span class="c1"># Note: File globs are only evaluated when lfd is started</span>
<a id="__codelineno-2-2643" name="__codelineno-2-2643" href="#__codelineno-2-2643"></a><span class="c1">#</span>
<a id="__codelineno-2-2644" name="__codelineno-2-2644" href="#__codelineno-2-2644"></a><span class="na">HTACCESS_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/apache2/error.log"</span>
<a id="__codelineno-2-2645" name="__codelineno-2-2645" href="#__codelineno-2-2645"></a><span class="na">MODSEC_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/apache2/error.log"</span>
<a id="__codelineno-2-2646" name="__codelineno-2-2646" href="#__codelineno-2-2646"></a><span class="na">SSHD_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/auth.log"</span>
<a id="__codelineno-2-2647" name="__codelineno-2-2647" href="#__codelineno-2-2647"></a><span class="na">SU_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-2-2648" name="__codelineno-2-2648" href="#__codelineno-2-2648"></a><span class="na">SUDO_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/secure"</span>
<a id="__codelineno-2-2649" name="__codelineno-2-2649" href="#__codelineno-2-2649"></a><span class="na">FTPD_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-2-2650" name="__codelineno-2-2650" href="#__codelineno-2-2650"></a><span class="na">SMTPAUTH_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/secure"</span>
<a id="__codelineno-2-2651" name="__codelineno-2-2651" href="#__codelineno-2-2651"></a><span class="na">POP3D_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/mail.log"</span>
<a id="__codelineno-2-2652" name="__codelineno-2-2652" href="#__codelineno-2-2652"></a><span class="na">IMAPD_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/mail.log"</span>
<a id="__codelineno-2-2653" name="__codelineno-2-2653" href="#__codelineno-2-2653"></a><span class="na">IPTABLES_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-2-2654" name="__codelineno-2-2654" href="#__codelineno-2-2654"></a><span class="na">SUHOSIN_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-2-2655" name="__codelineno-2-2655" href="#__codelineno-2-2655"></a><span class="na">BIND_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-2-2656" name="__codelineno-2-2656" href="#__codelineno-2-2656"></a><span class="na">SYSLOG_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-2-2657" name="__codelineno-2-2657" href="#__codelineno-2-2657"></a><span class="na">WEBMIN_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/auth.log"</span>
<a id="__codelineno-2-2658" name="__codelineno-2-2658" href="#__codelineno-2-2658"></a>
<a id="__codelineno-2-2659" name="__codelineno-2-2659" href="#__codelineno-2-2659"></a><span class="na">CUSTOM1_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2660" name="__codelineno-2-2660" href="#__codelineno-2-2660"></a><span class="na">CUSTOM2_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2661" name="__codelineno-2-2661" href="#__codelineno-2-2661"></a><span class="na">CUSTOM3_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2662" name="__codelineno-2-2662" href="#__codelineno-2-2662"></a><span class="na">CUSTOM4_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2663" name="__codelineno-2-2663" href="#__codelineno-2-2663"></a><span class="na">CUSTOM5_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2664" name="__codelineno-2-2664" href="#__codelineno-2-2664"></a><span class="na">CUSTOM6_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2665" name="__codelineno-2-2665" href="#__codelineno-2-2665"></a><span class="na">CUSTOM7_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2666" name="__codelineno-2-2666" href="#__codelineno-2-2666"></a><span class="na">CUSTOM8_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2667" name="__codelineno-2-2667" href="#__codelineno-2-2667"></a><span class="na">CUSTOM9_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-2-2668" name="__codelineno-2-2668" href="#__codelineno-2-2668"></a>
<a id="__codelineno-2-2669" name="__codelineno-2-2669" href="#__codelineno-2-2669"></a><span class="c1"># The following are comma separated lists used if LF_SELECT is enabled,</span>
<a id="__codelineno-2-2670" name="__codelineno-2-2670" href="#__codelineno-2-2670"></a><span class="c1"># otherwise they are not used. They are derived from the application returned</span>
<a id="__codelineno-2-2671" name="__codelineno-2-2671" href="#__codelineno-2-2671"></a><span class="c1"># from a regex match in /usr/local/csf/bin/regex.pm</span>
<a id="__codelineno-2-2672" name="__codelineno-2-2672" href="#__codelineno-2-2672"></a><span class="c1">#</span>
<a id="__codelineno-2-2673" name="__codelineno-2-2673" href="#__codelineno-2-2673"></a><span class="c1"># All ports default to tcp blocks. To specify udp or tcp use the format:</span>
<a id="__codelineno-2-2674" name="__codelineno-2-2674" href="#__codelineno-2-2674"></a><span class="c1"># port;protocol,port;protocol,... For example, "53;udp,53;tcp"</span>
<a id="__codelineno-2-2675" name="__codelineno-2-2675" href="#__codelineno-2-2675"></a><span class="na">PORTS_pop3d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"110,995"</span>
<a id="__codelineno-2-2676" name="__codelineno-2-2676" href="#__codelineno-2-2676"></a><span class="na">PORTS_imapd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"143,993"</span>
<a id="__codelineno-2-2677" name="__codelineno-2-2677" href="#__codelineno-2-2677"></a><span class="na">PORTS_htpasswd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-2-2678" name="__codelineno-2-2678" href="#__codelineno-2-2678"></a><span class="na">PORTS_mod_security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-2-2679" name="__codelineno-2-2679" href="#__codelineno-2-2679"></a><span class="na">PORTS_mod_qos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-2-2680" name="__codelineno-2-2680" href="#__codelineno-2-2680"></a><span class="na">PORTS_symlink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-2-2681" name="__codelineno-2-2681" href="#__codelineno-2-2681"></a><span class="na">PORTS_suhosin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-2-2682" name="__codelineno-2-2682" href="#__codelineno-2-2682"></a><span class="na">PORTS_cxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-2-2683" name="__codelineno-2-2683" href="#__codelineno-2-2683"></a><span class="na">PORTS_bind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"53;udp,53;tcp"</span>
<a id="__codelineno-2-2684" name="__codelineno-2-2684" href="#__codelineno-2-2684"></a><span class="na">PORTS_ftpd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21"</span>
<a id="__codelineno-2-2685" name="__codelineno-2-2685" href="#__codelineno-2-2685"></a><span class="na">PORTS_webmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10000"</span>
<a id="__codelineno-2-2686" name="__codelineno-2-2686" href="#__codelineno-2-2686"></a><span class="na">PORTS_smtpauth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"25,465,587"</span>
<a id="__codelineno-2-2687" name="__codelineno-2-2687" href="#__codelineno-2-2687"></a><span class="na">PORTS_eximsyntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"25,465,587"</span>
<a id="__codelineno-2-2688" name="__codelineno-2-2688" href="#__codelineno-2-2688"></a><span class="c1"># This list is replaced, if present, by "Port" definitions in</span>
<a id="__codelineno-2-2689" name="__codelineno-2-2689" href="#__codelineno-2-2689"></a><span class="c1"># /etc/ssh/sshd_config</span>
<a id="__codelineno-2-2690" name="__codelineno-2-2690" href="#__codelineno-2-2690"></a><span class="na">PORTS_sshd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"22"</span>
<a id="__codelineno-2-2691" name="__codelineno-2-2691" href="#__codelineno-2-2691"></a>
<a id="__codelineno-2-2692" name="__codelineno-2-2692" href="#__codelineno-2-2692"></a><span class="c1"># This configuration is for use with generic Linux servers, do not change the</span>
<a id="__codelineno-2-2693" name="__codelineno-2-2693" href="#__codelineno-2-2693"></a><span class="c1"># following setting:</span>
<a id="__codelineno-2-2694" name="__codelineno-2-2694" href="#__codelineno-2-2694"></a><span class="na">GENERIC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-2-2695" name="__codelineno-2-2695" href="#__codelineno-2-2695"></a>
<a id="__codelineno-2-2696" name="__codelineno-2-2696" href="#__codelineno-2-2696"></a><span class="c1"># For internal use only. You should not enable this option as it could cause</span>
<a id="__codelineno-2-2697" name="__codelineno-2-2697" href="#__codelineno-2-2697"></a><span class="c1"># instability in csf and lfd</span>
<a id="__codelineno-2-2698" name="__codelineno-2-2698" href="#__codelineno-2-2698"></a><span class="na">DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-2-2699" name="__codelineno-2-2699" href="#__codelineno-2-2699"></a><span class="c1">###############################################################################</span>
</code></pre></div>
<p><br></p>
<hr>
<p><br></p>
<h2 id="clean-version">Clean Version<a class="headerlink" data-preview="" href="#clean-version" title="Permanent link">¶</a></h2>
<p>This is a copy of our <strong>clean</strong> version of the <abbr title="ConfigServer Security &amp; Firewall">CSF</abbr> <code>/etc/csf/csf.conf</code> config file available from our <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM252.8 8c-138.7 0-244.8 105.3-244.8 244 0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1 100-33.2 167.8-128.1 167.8-239 0-138.7-112.5-244-251.2-244zM105.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></span> <a href="https://github.com/Aetherinox/csf-firewall">repository</a>. It contains all of the settings available in our <a data-preview="" href="#full-version">full version</a>, but with all comments removed.</p>
<div class="language-ini highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="na">TESTING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="na">TESTING_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="na">RESTRICT_SYSLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="na">RESTRICT_SYSLOG_GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"mysyslog"</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="na">RESTRICT_UI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="na">AUTO_UPDATES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="na">LF_SPI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="na">TCP_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,143,443,465,587,993,995,5000"</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="na">TCP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,113,443,587,993,995"</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="na">UDP_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,80,443"</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="na">UDP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,113,123"</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="na">ICMP_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="na">ICMP_IN_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1/s"</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="na">ICMP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="na">ICMP_OUT_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a><span class="na">ICMP_TIMESTAMPDROP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a><span class="na">IPV6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a><span class="na">IPV6_ICMP_STRICT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a><span class="na">IPV6_SPI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a><span class="na">TCP6_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,143,443,465,587,993,995,5000"</span>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a><span class="na">TCP6_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,22,25,53,853,80,110,113,443,587,993,995"</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a><span class="na">UDP6_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,80,443"</span>
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a><span class="na">UDP6_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21,53,853,113,123"</span>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a><span class="na">ETH_DEVICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="na">ETH6_DEVICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="na">ETH_DEVICE_SKIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a><span class="na">USE_CONNTRACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a><span class="na">USE_FTPHELPER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a><span class="na">SYSLOG_CHECK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a><span class="na">IGNORE_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a><span class="na">DNS_STRICT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a><span class="na">DNS_STRICT_NS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="na">DENY_IP_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"200"</span>
<a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="na">DENY_TEMP_IP_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100"</span>
<a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="na">LF_DAEMON</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="na">LF_CSF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="na">FASTSTART</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="na">LF_IPSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="na">WAITLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="na">WAITLOCK_TIMEOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="na">LF_IPSET_HASHSIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1024"</span>
<a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="na">LF_IPSET_MAXELEM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"65536"</span>
<a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="na">LFDSTART</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="na">VERBOSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="na">PACKET_FILTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="na">LF_LOOKUPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a><span class="na">STYLE_CUSTOM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a><span class="na">STYLE_MOBILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a><span class="na">SMTP_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a><span class="na">SMTP_ALLOWLOCAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a><span class="na">SMTP_REDIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a><span class="na">SMTP_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"25,465,587"</span>
<a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="na">SMTP_ALLOWUSER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="na">SMTP_ALLOWGROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"mail,mailman"</span>
<a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="na">SMTPAUTH_RESTRICT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a><span class="na">SYNFLOOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a><span class="na">SYNFLOOD_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100/s"</span>
<a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a><span class="na">SYNFLOOD_BURST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"150"</span>
<a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a><span class="na">CONNLIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a><span class="na">PORTFLOOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a><span class="na">UDPFLOOD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a><span class="na">UDPFLOOD_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100/s"</span>
<a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="na">UDPFLOOD_BURST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"500"</span>
<a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="na">UDPFLOOD_ALLOWUSER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"named"</span>
<a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="na">SYSLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a><span class="na">DROP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"DROP"</span>
<a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a><span class="na">DROP_OUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"REJECT"</span>
<a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a><span class="na">DROP_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a><span class="na">DROP_IP_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a><span class="na">DROP_OUT_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a><span class="na">DROP_UID_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a><span class="na">DROP_ONLYRES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a><span class="na">DROP_NOLOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"23,67,68,111,113,135:139,445,500,513,520"</span>
<a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="na">DROP_PF_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="na">CONNLIMIT_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a><span class="na">UDPFLOOD_LOGGING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a><span class="na">LOGFLOOD_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a><span class="na">LF_ALERT_TO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a><span class="na">LF_ALERT_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a><span class="na">LF_ALERT_SMTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-81" name="__codelineno-3-81" href="#__codelineno-3-81"></a><span class="na">BLOCK_REPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-82" name="__codelineno-3-82" href="#__codelineno-3-82"></a><span class="na">UNBLOCK_REPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-83" name="__codelineno-3-83" href="#__codelineno-3-83"></a><span class="na">X_ARF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-84" name="__codelineno-3-84" href="#__codelineno-3-84"></a><span class="na">X_ARF_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-85" name="__codelineno-3-85" href="#__codelineno-3-85"></a><span class="na">X_ARF_TO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-86" name="__codelineno-3-86" href="#__codelineno-3-86"></a><span class="na">X_ARF_ABUSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-87" name="__codelineno-3-87" href="#__codelineno-3-87"></a><span class="na">LF_PERMBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-88" name="__codelineno-3-88" href="#__codelineno-3-88"></a><span class="na">LF_PERMBLOCK_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"86400"</span>
<a id="__codelineno-3-89" name="__codelineno-3-89" href="#__codelineno-3-89"></a><span class="na">LF_PERMBLOCK_COUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"4"</span>
<a id="__codelineno-3-90" name="__codelineno-3-90" href="#__codelineno-3-90"></a><span class="na">LF_PERMBLOCK_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-91" name="__codelineno-3-91" href="#__codelineno-3-91"></a><span class="na">LF_NETBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-92" name="__codelineno-3-92" href="#__codelineno-3-92"></a><span class="na">LF_NETBLOCK_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"86400"</span>
<a id="__codelineno-3-93" name="__codelineno-3-93" href="#__codelineno-3-93"></a><span class="na">LF_NETBLOCK_COUNT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"4"</span>
<a id="__codelineno-3-94" name="__codelineno-3-94" href="#__codelineno-3-94"></a><span class="na">LF_NETBLOCK_CLASS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"C"</span>
<a id="__codelineno-3-95" name="__codelineno-3-95" href="#__codelineno-3-95"></a><span class="na">LF_NETBLOCK_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-96" name="__codelineno-3-96" href="#__codelineno-3-96"></a><span class="na">LF_NETBLOCK_IPV6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-97" name="__codelineno-3-97" href="#__codelineno-3-97"></a><span class="na">SAFECHAINUPDATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-98" name="__codelineno-3-98" href="#__codelineno-3-98"></a><span class="na">DYNDNS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-99" name="__codelineno-3-99" href="#__codelineno-3-99"></a><span class="na">DYNDNS_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-100" name="__codelineno-3-100" href="#__codelineno-3-100"></a><span class="na">LF_GLOBAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-101" name="__codelineno-3-101" href="#__codelineno-3-101"></a><span class="na">GLOBAL_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-102" name="__codelineno-3-102" href="#__codelineno-3-102"></a><span class="na">GLOBAL_DENY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-103" name="__codelineno-3-103" href="#__codelineno-3-103"></a><span class="na">GLOBAL_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-104" name="__codelineno-3-104" href="#__codelineno-3-104"></a><span class="na">GLOBAL_DYNDNS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-105" name="__codelineno-3-105" href="#__codelineno-3-105"></a><span class="na">GLOBAL_DYNDNS_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"600"</span>
<a id="__codelineno-3-106" name="__codelineno-3-106" href="#__codelineno-3-106"></a><span class="na">GLOBAL_DYNDNS_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-107" name="__codelineno-3-107" href="#__codelineno-3-107"></a><span class="na">LF_BOGON_SKIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-108" name="__codelineno-3-108" href="#__codelineno-3-108"></a><span class="na">URLGET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-3-109" name="__codelineno-3-109" href="#__codelineno-3-109"></a><span class="na">URLPROXY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-110" name="__codelineno-3-110" href="#__codelineno-3-110"></a><span class="na">MM_LICENSE_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-111" name="__codelineno-3-111" href="#__codelineno-3-111"></a><span class="na">CC_SRC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-3-112" name="__codelineno-3-112" href="#__codelineno-3-112"></a><span class="na">CC_DENY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-113" name="__codelineno-3-113" href="#__codelineno-3-113"></a><span class="na">CC_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-114" name="__codelineno-3-114" href="#__codelineno-3-114"></a><span class="na">CC_ALLOW_FILTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-115" name="__codelineno-3-115" href="#__codelineno-3-115"></a><span class="na">CC_ALLOW_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-116" name="__codelineno-3-116" href="#__codelineno-3-116"></a><span class="na">CC_ALLOW_PORTS_TCP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-117" name="__codelineno-3-117" href="#__codelineno-3-117"></a><span class="na">CC_ALLOW_PORTS_UDP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-118" name="__codelineno-3-118" href="#__codelineno-3-118"></a><span class="na">CC_DENY_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-119" name="__codelineno-3-119" href="#__codelineno-3-119"></a><span class="na">CC_DENY_PORTS_TCP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-120" name="__codelineno-3-120" href="#__codelineno-3-120"></a><span class="na">CC_DENY_PORTS_UDP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-121" name="__codelineno-3-121" href="#__codelineno-3-121"></a><span class="na">CC_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-122" name="__codelineno-3-122" href="#__codelineno-3-122"></a><span class="na">CC_ALLOW_SMTPAUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-123" name="__codelineno-3-123" href="#__codelineno-3-123"></a><span class="na">CC_MESSENGER_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-124" name="__codelineno-3-124" href="#__codelineno-3-124"></a><span class="na">CC_MESSENGER_DENY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-125" name="__codelineno-3-125" href="#__codelineno-3-125"></a><span class="na">CC_DROP_CIDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-126" name="__codelineno-3-126" href="#__codelineno-3-126"></a><span class="na">CC_LOOKUPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-127" name="__codelineno-3-127" href="#__codelineno-3-127"></a><span class="na">CC6_LOOKUPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-128" name="__codelineno-3-128" href="#__codelineno-3-128"></a><span class="na">CC_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"14"</span>
<a id="__codelineno-3-129" name="__codelineno-3-129" href="#__codelineno-3-129"></a><span class="na">LF_TRIGGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-130" name="__codelineno-3-130" href="#__codelineno-3-130"></a><span class="na">LF_TRIGGER_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-131" name="__codelineno-3-131" href="#__codelineno-3-131"></a><span class="na">LF_SELECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-132" name="__codelineno-3-132" href="#__codelineno-3-132"></a><span class="na">LF_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-133" name="__codelineno-3-133" href="#__codelineno-3-133"></a><span class="na">LF_TEMP_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-134" name="__codelineno-3-134" href="#__codelineno-3-134"></a><span class="na">LF_SSHD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-135" name="__codelineno-3-135" href="#__codelineno-3-135"></a><span class="na">LF_SSHD_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-136" name="__codelineno-3-136" href="#__codelineno-3-136"></a><span class="na">LF_FTPD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-3-137" name="__codelineno-3-137" href="#__codelineno-3-137"></a><span class="na">LF_FTPD_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-138" name="__codelineno-3-138" href="#__codelineno-3-138"></a><span class="na">LF_SMTPAUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-139" name="__codelineno-3-139" href="#__codelineno-3-139"></a><span class="na">LF_SMTPAUTH_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-140" name="__codelineno-3-140" href="#__codelineno-3-140"></a><span class="na">LF_EXIMSYNTAX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-3-141" name="__codelineno-3-141" href="#__codelineno-3-141"></a><span class="na">LF_EXIMSYNTAX_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-142" name="__codelineno-3-142" href="#__codelineno-3-142"></a><span class="na">LF_POP3D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-143" name="__codelineno-3-143" href="#__codelineno-3-143"></a><span class="na">LF_POP3D_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-144" name="__codelineno-3-144" href="#__codelineno-3-144"></a><span class="na">LF_IMAPD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-145" name="__codelineno-3-145" href="#__codelineno-3-145"></a><span class="na">LF_IMAPD_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-146" name="__codelineno-3-146" href="#__codelineno-3-146"></a><span class="na">LF_HTACCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-147" name="__codelineno-3-147" href="#__codelineno-3-147"></a><span class="na">LF_HTACCESS_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-148" name="__codelineno-3-148" href="#__codelineno-3-148"></a><span class="na">LF_MODSEC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-149" name="__codelineno-3-149" href="#__codelineno-3-149"></a><span class="na">LF_MODSEC_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-150" name="__codelineno-3-150" href="#__codelineno-3-150"></a><span class="na">LF_BIND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-151" name="__codelineno-3-151" href="#__codelineno-3-151"></a><span class="na">LF_BIND_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-152" name="__codelineno-3-152" href="#__codelineno-3-152"></a><span class="na">LF_SUHOSIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-153" name="__codelineno-3-153" href="#__codelineno-3-153"></a><span class="na">LF_SUHOSIN_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-154" name="__codelineno-3-154" href="#__codelineno-3-154"></a><span class="na">LF_CXS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-155" name="__codelineno-3-155" href="#__codelineno-3-155"></a><span class="na">LF_CXS_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-156" name="__codelineno-3-156" href="#__codelineno-3-156"></a><span class="na">LF_QOS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-157" name="__codelineno-3-157" href="#__codelineno-3-157"></a><span class="na">LF_QOS_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-158" name="__codelineno-3-158" href="#__codelineno-3-158"></a><span class="na">LF_SYMLINK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-159" name="__codelineno-3-159" href="#__codelineno-3-159"></a><span class="na">LF_SYMLINK_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-160" name="__codelineno-3-160" href="#__codelineno-3-160"></a><span class="na">LF_WEBMIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-161" name="__codelineno-3-161" href="#__codelineno-3-161"></a><span class="na">LF_WEBMIN_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-162" name="__codelineno-3-162" href="#__codelineno-3-162"></a><span class="na">LF_SSH_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-163" name="__codelineno-3-163" href="#__codelineno-3-163"></a><span class="na">LF_SU_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-164" name="__codelineno-3-164" href="#__codelineno-3-164"></a><span class="na">LF_SUDO_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-165" name="__codelineno-3-165" href="#__codelineno-3-165"></a><span class="na">LF_WEBMIN_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-166" name="__codelineno-3-166" href="#__codelineno-3-166"></a><span class="na">LF_CONSOLE_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-167" name="__codelineno-3-167" href="#__codelineno-3-167"></a><span class="na">LF_APACHE_404</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-168" name="__codelineno-3-168" href="#__codelineno-3-168"></a><span class="na">LF_APACHE_404_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-169" name="__codelineno-3-169" href="#__codelineno-3-169"></a><span class="na">LF_APACHE_403</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-170" name="__codelineno-3-170" href="#__codelineno-3-170"></a><span class="na">LF_APACHE_403_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-171" name="__codelineno-3-171" href="#__codelineno-3-171"></a><span class="na">LF_APACHE_401</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-172" name="__codelineno-3-172" href="#__codelineno-3-172"></a><span class="na">LF_APACHE_ERRPORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-173" name="__codelineno-3-173" href="#__codelineno-3-173"></a><span class="na">LF_APACHE_401_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-174" name="__codelineno-3-174" href="#__codelineno-3-174"></a><span class="na">LF_MODSECIPDB_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-175" name="__codelineno-3-175" href="#__codelineno-3-175"></a><span class="na">LF_MODSECIPDB_FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/run/modsecurity/data/ip.pag"</span>
<a id="__codelineno-3-176" name="__codelineno-3-176" href="#__codelineno-3-176"></a><span class="na">LF_EXPLOIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-3-177" name="__codelineno-3-177" href="#__codelineno-3-177"></a><span class="na">LF_EXPLOIT_IGNORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-178" name="__codelineno-3-178" href="#__codelineno-3-178"></a><span class="na">LF_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-179" name="__codelineno-3-179" href="#__codelineno-3-179"></a><span class="na">LF_PARSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-180" name="__codelineno-3-180" href="#__codelineno-3-180"></a><span class="na">LF_FLUSH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-181" name="__codelineno-3-181" href="#__codelineno-3-181"></a><span class="na">LF_REPEATBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-182" name="__codelineno-3-182" href="#__codelineno-3-182"></a><span class="na">LF_BLOCKINONLY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-183" name="__codelineno-3-183" href="#__codelineno-3-183"></a><span class="na">CF_ENABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-184" name="__codelineno-3-184" href="#__codelineno-3-184"></a><span class="na">CF_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"block"</span>
<a id="__codelineno-3-185" name="__codelineno-3-185" href="#__codelineno-3-185"></a><span class="na">CF_TEMP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-186" name="__codelineno-3-186" href="#__codelineno-3-186"></a><span class="na">LF_DIRWATCH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-3-187" name="__codelineno-3-187" href="#__codelineno-3-187"></a><span class="na">LF_DIRWATCH_DISABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-188" name="__codelineno-3-188" href="#__codelineno-3-188"></a><span class="na">LF_DIRWATCH_FILE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-189" name="__codelineno-3-189" href="#__codelineno-3-189"></a><span class="na">LF_INTEGRITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-190" name="__codelineno-3-190" href="#__codelineno-3-190"></a><span class="na">LF_DISTATTACK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-191" name="__codelineno-3-191" href="#__codelineno-3-191"></a><span class="na">LF_DISTATTACK_UNIQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-3-192" name="__codelineno-3-192" href="#__codelineno-3-192"></a><span class="na">LF_DISTFTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-193" name="__codelineno-3-193" href="#__codelineno-3-193"></a><span class="na">LF_DISTFTP_UNIQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3"</span>
<a id="__codelineno-3-194" name="__codelineno-3-194" href="#__codelineno-3-194"></a><span class="na">LF_DISTFTP_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-195" name="__codelineno-3-195" href="#__codelineno-3-195"></a><span class="na">LF_DISTFTP_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-196" name="__codelineno-3-196" href="#__codelineno-3-196"></a><span class="na">LF_DISTSMTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-197" name="__codelineno-3-197" href="#__codelineno-3-197"></a><span class="na">LF_DISTSMTP_UNIQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3"</span>
<a id="__codelineno-3-198" name="__codelineno-3-198" href="#__codelineno-3-198"></a><span class="na">LF_DISTSMTP_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-199" name="__codelineno-3-199" href="#__codelineno-3-199"></a><span class="na">LF_DISTSMTP_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-200" name="__codelineno-3-200" href="#__codelineno-3-200"></a><span class="na">LF_DIST_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-3-201" name="__codelineno-3-201" href="#__codelineno-3-201"></a><span class="na">LF_DIST_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-202" name="__codelineno-3-202" href="#__codelineno-3-202"></a><span class="na">LT_POP3D</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-203" name="__codelineno-3-203" href="#__codelineno-3-203"></a><span class="na">LT_IMAPD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-204" name="__codelineno-3-204" href="#__codelineno-3-204"></a><span class="na">LT_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-205" name="__codelineno-3-205" href="#__codelineno-3-205"></a><span class="na">LT_SKIPPERMBLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-206" name="__codelineno-3-206" href="#__codelineno-3-206"></a><span class="na">CT_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-207" name="__codelineno-3-207" href="#__codelineno-3-207"></a><span class="na">CT_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"30"</span>
<a id="__codelineno-3-208" name="__codelineno-3-208" href="#__codelineno-3-208"></a><span class="na">CT_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-209" name="__codelineno-3-209" href="#__codelineno-3-209"></a><span class="na">CT_PERMANENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-210" name="__codelineno-3-210" href="#__codelineno-3-210"></a><span class="na">CT_BLOCK_TIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1800"</span>
<a id="__codelineno-3-211" name="__codelineno-3-211" href="#__codelineno-3-211"></a><span class="na">CT_SKIP_TIME_WAIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-212" name="__codelineno-3-212" href="#__codelineno-3-212"></a><span class="na">CT_STATES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-213" name="__codelineno-3-213" href="#__codelineno-3-213"></a><span class="na">CT_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-214" name="__codelineno-3-214" href="#__codelineno-3-214"></a><span class="na">CT_SUBNET_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-215" name="__codelineno-3-215" href="#__codelineno-3-215"></a><span class="na">PT_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"60"</span>
<a id="__codelineno-3-216" name="__codelineno-3-216" href="#__codelineno-3-216"></a><span class="na">PT_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"60"</span>
<a id="__codelineno-3-217" name="__codelineno-3-217" href="#__codelineno-3-217"></a><span class="na">PT_SKIP_HTTP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-218" name="__codelineno-3-218" href="#__codelineno-3-218"></a><span class="na">PT_DELETED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-219" name="__codelineno-3-219" href="#__codelineno-3-219"></a><span class="na">PT_DELETED_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-220" name="__codelineno-3-220" href="#__codelineno-3-220"></a><span class="na">PT_USERPROC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-3-221" name="__codelineno-3-221" href="#__codelineno-3-221"></a><span class="na">PT_USERMEM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"512"</span>
<a id="__codelineno-3-222" name="__codelineno-3-222" href="#__codelineno-3-222"></a><span class="na">PT_USERRSS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"256"</span>
<a id="__codelineno-3-223" name="__codelineno-3-223" href="#__codelineno-3-223"></a><span class="na">PT_USERTIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1800"</span>
<a id="__codelineno-3-224" name="__codelineno-3-224" href="#__codelineno-3-224"></a><span class="na">PT_USERKILL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-225" name="__codelineno-3-225" href="#__codelineno-3-225"></a><span class="na">PT_USERKILL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-226" name="__codelineno-3-226" href="#__codelineno-3-226"></a><span class="na">PT_USER_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-227" name="__codelineno-3-227" href="#__codelineno-3-227"></a><span class="na">PT_LOAD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"30"</span>
<a id="__codelineno-3-228" name="__codelineno-3-228" href="#__codelineno-3-228"></a><span class="na">PT_LOAD_AVG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-229" name="__codelineno-3-229" href="#__codelineno-3-229"></a><span class="na">PT_LOAD_LEVEL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"6"</span>
<a id="__codelineno-3-230" name="__codelineno-3-230" href="#__codelineno-3-230"></a><span class="na">PT_LOAD_SKIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-231" name="__codelineno-3-231" href="#__codelineno-3-231"></a><span class="na">PT_APACHESTATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"http://127.0.0.1/server-status"</span>
<a id="__codelineno-3-232" name="__codelineno-3-232" href="#__codelineno-3-232"></a><span class="na">PT_LOAD_ACTION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-233" name="__codelineno-3-233" href="#__codelineno-3-233"></a><span class="na">PT_FORKBOMB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-234" name="__codelineno-3-234" href="#__codelineno-3-234"></a><span class="na">PT_SSHDKILL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-235" name="__codelineno-3-235" href="#__codelineno-3-235"></a><span class="na">PT_SSHDHUNG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-236" name="__codelineno-3-236" href="#__codelineno-3-236"></a><span class="na">PS_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-237" name="__codelineno-3-237" href="#__codelineno-3-237"></a><span class="na">PS_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-3-238" name="__codelineno-3-238" href="#__codelineno-3-238"></a><span class="na">PS_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0:65535,ICMP"</span>
<a id="__codelineno-3-239" name="__codelineno-3-239" href="#__codelineno-3-239"></a><span class="na">PS_DIVERSITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-240" name="__codelineno-3-240" href="#__codelineno-3-240"></a><span class="na">PS_PERMANENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-241" name="__codelineno-3-241" href="#__codelineno-3-241"></a><span class="na">PS_BLOCK_TIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"3600"</span>
<a id="__codelineno-3-242" name="__codelineno-3-242" href="#__codelineno-3-242"></a><span class="na">PS_EMAIL_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-243" name="__codelineno-3-243" href="#__codelineno-3-243"></a><span class="na">UID_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-244" name="__codelineno-3-244" href="#__codelineno-3-244"></a><span class="na">UID_LIMIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-3-245" name="__codelineno-3-245" href="#__codelineno-3-245"></a><span class="na">UID_PORTS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0:65535,ICMP"</span>
<a id="__codelineno-3-246" name="__codelineno-3-246" href="#__codelineno-3-246"></a><span class="na">AT_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2"</span>
<a id="__codelineno-3-247" name="__codelineno-3-247" href="#__codelineno-3-247"></a><span class="na">AT_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"60"</span>
<a id="__codelineno-3-248" name="__codelineno-3-248" href="#__codelineno-3-248"></a><span class="na">AT_NEW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-249" name="__codelineno-3-249" href="#__codelineno-3-249"></a><span class="na">AT_OLD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-250" name="__codelineno-3-250" href="#__codelineno-3-250"></a><span class="na">AT_PASSWD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-251" name="__codelineno-3-251" href="#__codelineno-3-251"></a><span class="na">AT_UID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-252" name="__codelineno-3-252" href="#__codelineno-3-252"></a><span class="na">AT_GID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-253" name="__codelineno-3-253" href="#__codelineno-3-253"></a><span class="na">AT_DIR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-254" name="__codelineno-3-254" href="#__codelineno-3-254"></a><span class="na">AT_SHELL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-255" name="__codelineno-3-255" href="#__codelineno-3-255"></a><span class="na">UI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-256" name="__codelineno-3-256" href="#__codelineno-3-256"></a><span class="na">UI_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8546"</span>
<a id="__codelineno-3-257" name="__codelineno-3-257" href="#__codelineno-3-257"></a><span class="na">UI_IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-258" name="__codelineno-3-258" href="#__codelineno-3-258"></a><span class="na">UI_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"admin"</span>
<a id="__codelineno-3-259" name="__codelineno-3-259" href="#__codelineno-3-259"></a><span class="na">UI_PASS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"password"</span>
<a id="__codelineno-3-260" name="__codelineno-3-260" href="#__codelineno-3-260"></a><span class="na">UI_BLOCK_PRIVATE_NET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-261" name="__codelineno-3-261" href="#__codelineno-3-261"></a><span class="na">UI_TIMEOUT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"300"</span>
<a id="__codelineno-3-262" name="__codelineno-3-262" href="#__codelineno-3-262"></a><span class="na">UI_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-263" name="__codelineno-3-263" href="#__codelineno-3-263"></a><span class="na">UI_RETRY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-264" name="__codelineno-3-264" href="#__codelineno-3-264"></a><span class="na">UI_BAN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-265" name="__codelineno-3-265" href="#__codelineno-3-265"></a><span class="na">UI_ALLOW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-266" name="__codelineno-3-266" href="#__codelineno-3-266"></a><span class="na">UI_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-267" name="__codelineno-3-267" href="#__codelineno-3-267"></a><span class="na">UI_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"4"</span>
<a id="__codelineno-3-268" name="__codelineno-3-268" href="#__codelineno-3-268"></a><span class="na">UI_CIPHER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"ALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:-LOW:-SSLv2:-EXP:!kEDH"</span>
<a id="__codelineno-3-269" name="__codelineno-3-269" href="#__codelineno-3-269"></a><span class="na">UI_SSL_VERSION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"SSLv23:!SSLv3:!SSLv2"</span>
<a id="__codelineno-3-270" name="__codelineno-3-270" href="#__codelineno-3-270"></a><span class="na">UI_CXS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-271" name="__codelineno-3-271" href="#__codelineno-3-271"></a><span class="na">UI_CSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-272" name="__codelineno-3-272" href="#__codelineno-3-272"></a><span class="na">MESSENGER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-273" name="__codelineno-3-273" href="#__codelineno-3-273"></a><span class="na">MESSENGER_TEMP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-274" name="__codelineno-3-274" href="#__codelineno-3-274"></a><span class="na">MESSENGER_PERM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-275" name="__codelineno-3-275" href="#__codelineno-3-275"></a><span class="na">MESSENGER_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"csf"</span>
<a id="__codelineno-3-276" name="__codelineno-3-276" href="#__codelineno-3-276"></a><span class="na">MESSENGER_HTTPS_CONF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/httpd/conf.d/ssl.conf"</span>
<a id="__codelineno-3-277" name="__codelineno-3-277" href="#__codelineno-3-277"></a><span class="na">MESSENGER_HTTPS_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/pki/tls/private/localhost.key"</span>
<a id="__codelineno-3-278" name="__codelineno-3-278" href="#__codelineno-3-278"></a><span class="na">MESSENGER_HTTPS_CRT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/pki/tls/certs/localhost.crt"</span>
<a id="__codelineno-3-279" name="__codelineno-3-279" href="#__codelineno-3-279"></a><span class="na">MESSENGER_HTTPS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8887"</span>
<a id="__codelineno-3-280" name="__codelineno-3-280" href="#__codelineno-3-280"></a><span class="na">MESSENGER_HTTPS_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"443"</span>
<a id="__codelineno-3-281" name="__codelineno-3-281" href="#__codelineno-3-281"></a><span class="na">MESSENGER_HTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8888"</span>
<a id="__codelineno-3-282" name="__codelineno-3-282" href="#__codelineno-3-282"></a><span class="na">MESSENGER_HTML_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80"</span>
<a id="__codelineno-3-283" name="__codelineno-3-283" href="#__codelineno-3-283"></a><span class="na">MESSENGER_TEXT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"8889"</span>
<a id="__codelineno-3-284" name="__codelineno-3-284" href="#__codelineno-3-284"></a><span class="na">MESSENGER_TEXT_IN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"21"</span>
<a id="__codelineno-3-285" name="__codelineno-3-285" href="#__codelineno-3-285"></a><span class="na">MESSENGER_RATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100/s"</span>
<a id="__codelineno-3-286" name="__codelineno-3-286" href="#__codelineno-3-286"></a><span class="na">MESSENGER_BURST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"150"</span>
<a id="__codelineno-3-287" name="__codelineno-3-287" href="#__codelineno-3-287"></a><span class="na">MESSENGER_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20"</span>
<a id="__codelineno-3-288" name="__codelineno-3-288" href="#__codelineno-3-288"></a><span class="na">MESSENGER_HTTPS_SKIPMAIL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-289" name="__codelineno-3-289" href="#__codelineno-3-289"></a><span class="na">MESSENGERV3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-290" name="__codelineno-3-290" href="#__codelineno-3-290"></a><span class="na">MESSENGERV3LOCATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/httpd/conf.d/"</span>
<a id="__codelineno-3-291" name="__codelineno-3-291" href="#__codelineno-3-291"></a><span class="na">MESSENGERV3RESTART</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"service httpd restart"</span>
<a id="__codelineno-3-292" name="__codelineno-3-292" href="#__codelineno-3-292"></a><span class="na">MESSENGERV3TEST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/sbin/apachectl -t"</span>
<a id="__codelineno-3-293" name="__codelineno-3-293" href="#__codelineno-3-293"></a><span class="na">MESSENGERV3HTTPS_CONF</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/etc/httpd/conf/httpd.conf"</span>
<a id="__codelineno-3-294" name="__codelineno-3-294" href="#__codelineno-3-294"></a><span class="na">MESSENGERV3WEBSERVER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"apache"</span>
<a id="__codelineno-3-295" name="__codelineno-3-295" href="#__codelineno-3-295"></a><span class="na">MESSENGERV3PERMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"711"</span>
<a id="__codelineno-3-296" name="__codelineno-3-296" href="#__codelineno-3-296"></a><span class="na">MESSENGERV3GROUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"apache"</span>
<a id="__codelineno-3-297" name="__codelineno-3-297" href="#__codelineno-3-297"></a><span class="na">MESSENGERV3PHPHANDLER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-298" name="__codelineno-3-298" href="#__codelineno-3-298"></a><span class="na">RECAPTCHA_SITEKEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-299" name="__codelineno-3-299" href="#__codelineno-3-299"></a><span class="na">RECAPTCHA_SECRET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-300" name="__codelineno-3-300" href="#__codelineno-3-300"></a><span class="na">RECAPTCHA_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-301" name="__codelineno-3-301" href="#__codelineno-3-301"></a><span class="na">RECAPTCHA_NAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-302" name="__codelineno-3-302" href="#__codelineno-3-302"></a><span class="na">CLUSTER_SENDTO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-303" name="__codelineno-3-303" href="#__codelineno-3-303"></a><span class="na">CLUSTER_RECVFROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-304" name="__codelineno-3-304" href="#__codelineno-3-304"></a><span class="na">CLUSTER_MASTER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-305" name="__codelineno-3-305" href="#__codelineno-3-305"></a><span class="na">CLUSTER_NAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-306" name="__codelineno-3-306" href="#__codelineno-3-306"></a><span class="na">CLUSTER_LOCALADDR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-307" name="__codelineno-3-307" href="#__codelineno-3-307"></a><span class="na">CLUSTER_PORT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"7777"</span>
<a id="__codelineno-3-308" name="__codelineno-3-308" href="#__codelineno-3-308"></a><span class="na">CLUSTER_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-309" name="__codelineno-3-309" href="#__codelineno-3-309"></a><span class="na">CLUSTER_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-310" name="__codelineno-3-310" href="#__codelineno-3-310"></a><span class="na">CLUSTER_CONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-311" name="__codelineno-3-311" href="#__codelineno-3-311"></a><span class="na">CLUSTER_CHILDREN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10"</span>
<a id="__codelineno-3-312" name="__codelineno-3-312" href="#__codelineno-3-312"></a><span class="na">PORTKNOCKING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-313" name="__codelineno-3-313" href="#__codelineno-3-313"></a><span class="na">PORTKNOCKING_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-314" name="__codelineno-3-314" href="#__codelineno-3-314"></a><span class="na">PORTKNOCKING_ALERT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-315" name="__codelineno-3-315" href="#__codelineno-3-315"></a><span class="na">LOGSCANNER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-316" name="__codelineno-3-316" href="#__codelineno-3-316"></a><span class="na">LOGSCANNER_INTERVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"hourly"</span>
<a id="__codelineno-3-317" name="__codelineno-3-317" href="#__codelineno-3-317"></a><span class="na">LOGSCANNER_STYLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-318" name="__codelineno-3-318" href="#__codelineno-3-318"></a><span class="na">LOGSCANNER_EMPTY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-319" name="__codelineno-3-319" href="#__codelineno-3-319"></a><span class="na">LOGSCANNER_LINES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5000"</span>
<a id="__codelineno-3-320" name="__codelineno-3-320" href="#__codelineno-3-320"></a><span class="na">ST_ENABLE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-321" name="__codelineno-3-321" href="#__codelineno-3-321"></a><span class="na">ST_IPTABLES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"100"</span>
<a id="__codelineno-3-322" name="__codelineno-3-322" href="#__codelineno-3-322"></a><span class="na">ST_LOOKUP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-323" name="__codelineno-3-323" href="#__codelineno-3-323"></a><span class="na">ST_SYSTEM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-324" name="__codelineno-3-324" href="#__codelineno-3-324"></a><span class="na">ST_SYSTEM_MAXDAYS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"30"</span>
<a id="__codelineno-3-325" name="__codelineno-3-325" href="#__codelineno-3-325"></a><span class="na">ST_MYSQL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-326" name="__codelineno-3-326" href="#__codelineno-3-326"></a><span class="na">ST_MYSQL_USER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"root"</span>
<a id="__codelineno-3-327" name="__codelineno-3-327" href="#__codelineno-3-327"></a><span class="na">ST_MYSQL_PASS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">""</span>
<a id="__codelineno-3-328" name="__codelineno-3-328" href="#__codelineno-3-328"></a><span class="na">ST_MYSQL_HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"localhost"</span>
<a id="__codelineno-3-329" name="__codelineno-3-329" href="#__codelineno-3-329"></a><span class="na">ST_APACHE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-330" name="__codelineno-3-330" href="#__codelineno-3-330"></a><span class="na">ST_DISKW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-331" name="__codelineno-3-331" href="#__codelineno-3-331"></a><span class="na">ST_DISKW_FREQ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"5"</span>
<a id="__codelineno-3-332" name="__codelineno-3-332" href="#__codelineno-3-332"></a><span class="na">ST_DISKW_DD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"if=/dev/zero of=/var/lib/csf/dd_test bs=1MB count=64 conv=fdatasync"</span>
<a id="__codelineno-3-333" name="__codelineno-3-333" href="#__codelineno-3-333"></a><span class="na">DOCKER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
<a id="__codelineno-3-334" name="__codelineno-3-334" href="#__codelineno-3-334"></a><span class="na">DOCKER_DEVICE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"docker0"</span>
<a id="__codelineno-3-335" name="__codelineno-3-335" href="#__codelineno-3-335"></a><span class="na">DOCKER_NETWORK4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"172.17.0.0/16"</span>
<a id="__codelineno-3-336" name="__codelineno-3-336" href="#__codelineno-3-336"></a><span class="na">DOCKER_NETWORK6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"2001:db8:1::/64"</span>
<a id="__codelineno-3-337" name="__codelineno-3-337" href="#__codelineno-3-337"></a><span class="na">IPTABLES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/iptables"</span>
<a id="__codelineno-3-338" name="__codelineno-3-338" href="#__codelineno-3-338"></a><span class="na">IPTABLES_SAVE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/iptables-save"</span>
<a id="__codelineno-3-339" name="__codelineno-3-339" href="#__codelineno-3-339"></a><span class="na">IPTABLES_RESTORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/iptables-restore"</span>
<a id="__codelineno-3-340" name="__codelineno-3-340" href="#__codelineno-3-340"></a><span class="na">IP6TABLES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ip6tables"</span>
<a id="__codelineno-3-341" name="__codelineno-3-341" href="#__codelineno-3-341"></a><span class="na">IP6TABLES_SAVE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ip6tables-save"</span>
<a id="__codelineno-3-342" name="__codelineno-3-342" href="#__codelineno-3-342"></a><span class="na">IP6TABLES_RESTORE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ip6tables-restore"</span>
<a id="__codelineno-3-343" name="__codelineno-3-343" href="#__codelineno-3-343"></a><span class="na">MODPROBE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/modprobe"</span>
<a id="__codelineno-3-344" name="__codelineno-3-344" href="#__codelineno-3-344"></a><span class="na">IFCONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ifconfig"</span>
<a id="__codelineno-3-345" name="__codelineno-3-345" href="#__codelineno-3-345"></a><span class="na">SENDMAIL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/sbin/sendmail"</span>
<a id="__codelineno-3-346" name="__codelineno-3-346" href="#__codelineno-3-346"></a><span class="na">PS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/ps"</span>
<a id="__codelineno-3-347" name="__codelineno-3-347" href="#__codelineno-3-347"></a><span class="na">VMSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/vmstat"</span>
<a id="__codelineno-3-348" name="__codelineno-3-348" href="#__codelineno-3-348"></a><span class="na">NETSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/netstat"</span>
<a id="__codelineno-3-349" name="__codelineno-3-349" href="#__codelineno-3-349"></a><span class="na">LS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/ls"</span>
<a id="__codelineno-3-350" name="__codelineno-3-350" href="#__codelineno-3-350"></a><span class="na">MD5SUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/md5sum"</span>
<a id="__codelineno-3-351" name="__codelineno-3-351" href="#__codelineno-3-351"></a><span class="na">TAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/tar"</span>
<a id="__codelineno-3-352" name="__codelineno-3-352" href="#__codelineno-3-352"></a><span class="na">CHATTR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/chattr"</span>
<a id="__codelineno-3-353" name="__codelineno-3-353" href="#__codelineno-3-353"></a><span class="na">UNZIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/unzip"</span>
<a id="__codelineno-3-354" name="__codelineno-3-354" href="#__codelineno-3-354"></a><span class="na">GUNZIP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/gunzip"</span>
<a id="__codelineno-3-355" name="__codelineno-3-355" href="#__codelineno-3-355"></a><span class="na">DD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/dd"</span>
<a id="__codelineno-3-356" name="__codelineno-3-356" href="#__codelineno-3-356"></a><span class="na">TAIL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/tail"</span>
<a id="__codelineno-3-357" name="__codelineno-3-357" href="#__codelineno-3-357"></a><span class="na">GREP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/grep"</span>
<a id="__codelineno-3-358" name="__codelineno-3-358" href="#__codelineno-3-358"></a><span class="na">ZGREP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/zgrep"</span>
<a id="__codelineno-3-359" name="__codelineno-3-359" href="#__codelineno-3-359"></a><span class="na">IPSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/sbin/ipset"</span>
<a id="__codelineno-3-360" name="__codelineno-3-360" href="#__codelineno-3-360"></a><span class="na">SYSTEMCTL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/systemctl"</span>
<a id="__codelineno-3-361" name="__codelineno-3-361" href="#__codelineno-3-361"></a><span class="na">HOST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/host"</span>
<a id="__codelineno-3-362" name="__codelineno-3-362" href="#__codelineno-3-362"></a><span class="na">IP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/bin/ip"</span>
<a id="__codelineno-3-363" name="__codelineno-3-363" href="#__codelineno-3-363"></a><span class="na">CURL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/curl"</span>
<a id="__codelineno-3-364" name="__codelineno-3-364" href="#__codelineno-3-364"></a><span class="na">WGET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/usr/bin/wget"</span>
<a id="__codelineno-3-365" name="__codelineno-3-365" href="#__codelineno-3-365"></a><span class="na">HTACCESS_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/apache2/error.log"</span>
<a id="__codelineno-3-366" name="__codelineno-3-366" href="#__codelineno-3-366"></a><span class="na">MODSEC_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/apache2/error.log"</span>
<a id="__codelineno-3-367" name="__codelineno-3-367" href="#__codelineno-3-367"></a><span class="na">SSHD_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/auth.log"</span>
<a id="__codelineno-3-368" name="__codelineno-3-368" href="#__codelineno-3-368"></a><span class="na">SU_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-3-369" name="__codelineno-3-369" href="#__codelineno-3-369"></a><span class="na">SUDO_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/secure"</span>
<a id="__codelineno-3-370" name="__codelineno-3-370" href="#__codelineno-3-370"></a><span class="na">FTPD_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-3-371" name="__codelineno-3-371" href="#__codelineno-3-371"></a><span class="na">SMTPAUTH_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/secure"</span>
<a id="__codelineno-3-372" name="__codelineno-3-372" href="#__codelineno-3-372"></a><span class="na">POP3D_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/mail.log"</span>
<a id="__codelineno-3-373" name="__codelineno-3-373" href="#__codelineno-3-373"></a><span class="na">IMAPD_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/mail.log"</span>
<a id="__codelineno-3-374" name="__codelineno-3-374" href="#__codelineno-3-374"></a><span class="na">IPTABLES_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-3-375" name="__codelineno-3-375" href="#__codelineno-3-375"></a><span class="na">SUHOSIN_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-3-376" name="__codelineno-3-376" href="#__codelineno-3-376"></a><span class="na">BIND_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-3-377" name="__codelineno-3-377" href="#__codelineno-3-377"></a><span class="na">SYSLOG_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/messages"</span>
<a id="__codelineno-3-378" name="__codelineno-3-378" href="#__codelineno-3-378"></a><span class="na">WEBMIN_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/auth.log"</span>
<a id="__codelineno-3-379" name="__codelineno-3-379" href="#__codelineno-3-379"></a><span class="na">CUSTOM1_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-380" name="__codelineno-3-380" href="#__codelineno-3-380"></a><span class="na">CUSTOM2_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-381" name="__codelineno-3-381" href="#__codelineno-3-381"></a><span class="na">CUSTOM3_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-382" name="__codelineno-3-382" href="#__codelineno-3-382"></a><span class="na">CUSTOM4_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-383" name="__codelineno-3-383" href="#__codelineno-3-383"></a><span class="na">CUSTOM5_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-384" name="__codelineno-3-384" href="#__codelineno-3-384"></a><span class="na">CUSTOM6_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-385" name="__codelineno-3-385" href="#__codelineno-3-385"></a><span class="na">CUSTOM7_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-386" name="__codelineno-3-386" href="#__codelineno-3-386"></a><span class="na">CUSTOM8_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-387" name="__codelineno-3-387" href="#__codelineno-3-387"></a><span class="na">CUSTOM9_LOG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"/var/log/customlog"</span>
<a id="__codelineno-3-388" name="__codelineno-3-388" href="#__codelineno-3-388"></a><span class="na">PORTS_pop3d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"110,995"</span>
<a id="__codelineno-3-389" name="__codelineno-3-389" href="#__codelineno-3-389"></a><span class="na">PORTS_imapd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"143,993"</span>
<a id="__codelineno-3-390" name="__codelineno-3-390" href="#__codelineno-3-390"></a><span class="na">PORTS_htpasswd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-3-391" name="__codelineno-3-391" href="#__codelineno-3-391"></a><span class="na">PORTS_mod_security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-3-392" name="__codelineno-3-392" href="#__codelineno-3-392"></a><span class="na">PORTS_mod_qos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-3-393" name="__codelineno-3-393" href="#__codelineno-3-393"></a><span class="na">PORTS_symlink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-3-394" name="__codelineno-3-394" href="#__codelineno-3-394"></a><span class="na">PORTS_suhosin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-3-395" name="__codelineno-3-395" href="#__codelineno-3-395"></a><span class="na">PORTS_cxs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"80,443"</span>
<a id="__codelineno-3-396" name="__codelineno-3-396" href="#__codelineno-3-396"></a><span class="na">PORTS_bind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"53;udp,53;tcp"</span>
<a id="__codelineno-3-397" name="__codelineno-3-397" href="#__codelineno-3-397"></a><span class="na">PORTS_ftpd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"20,21"</span>
<a id="__codelineno-3-398" name="__codelineno-3-398" href="#__codelineno-3-398"></a><span class="na">PORTS_webmin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"10000"</span>
<a id="__codelineno-3-399" name="__codelineno-3-399" href="#__codelineno-3-399"></a><span class="na">PORTS_smtpauth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"25,465,587"</span>
<a id="__codelineno-3-400" name="__codelineno-3-400" href="#__codelineno-3-400"></a><span class="na">PORTS_eximsyntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"25,465,587"</span>
<a id="__codelineno-3-401" name="__codelineno-3-401" href="#__codelineno-3-401"></a><span class="na">PORTS_sshd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"22"</span>
<a id="__codelineno-3-402" name="__codelineno-3-402" href="#__codelineno-3-402"></a><span class="na">GENERIC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"1"</span>
<a id="__codelineno-3-403" name="__codelineno-3-403" href="#__codelineno-3-403"></a><span class="na">DEBUG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"0"</span>
</code></pre></div>
<p><br></p>
<hr>
<p><br></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"></path></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="October 11, 2025 01:34:59 UTC"><span class="timeago" datetime="2025-10-11T01:34:59+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="October 11, 2025 01:34:59 UTC">2025-10-11</span>
  </span>

    
    
    
      
  
  <span class="md-source-file__fact">
    <span class="md-icon" title="Contributors">
      
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 5.5A3.5 3.5 0 0 1 15.5 9a3.5 3.5 0 0 1-3.5 3.5A3.5 3.5 0 0 1 8.5 9 3.5 3.5 0 0 1 12 5.5M5 8c.56 0 1.08.15 1.53.42-.15 1.43.27 2.85 1.13 3.96C7.16 13.34 6.16 14 5 14a3 3 0 0 1-3-3 3 3 0 0 1 3-3m14 0a3 3 0 0 1 3 3 3 3 0 0 1-3 3c-1.16 0-2.16-.66-2.66-1.62a5.536 5.536 0 0 0 1.13-3.96c.45-.27.97-.42 1.53-.42M5.5 18.25c0-2.07 2.91-3.75 6.5-3.75s6.5 1.68 6.5 3.75V20h-13v-1.75M0 20v-1.5c0-1.39 1.89-2.56 4.45-2.9-.59.68-.95 1.62-.95 2.65V20H0m24 0h-3.5v-1.75c0-1.03-.36-1.97-.95-2.65 2.56.34 4.45 1.51 4.45 2.9V20Z"></path></svg>
      
    </span>
    <nav>
      
        <a href="mailto:github-actions[bot]@users.noreply.github.com">github-actions[bot]</a>, 
        <a href="mailto:aetherinox@proton.me">Aetherinox</a>
    </nav>
  </span>

    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"></path></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/Aetherinox" class="md-author" title="@Aetherinox">
          
          <img src="https://avatars.githubusercontent.com/u/118329232?v=4&amp;size=72" alt="Aetherinox">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer">
        
          
          <a href="../commands/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Commands">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Commands
              </div>
            </div>
          </a>
        
        
          
          <a href="../ports/" class="md-footer__link md-footer__link--next" aria-label="Next: Ports">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Ports
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 - 2026 ConfigServer Security &amp; Firewall

    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://download.configserver.dev" target="_blank" rel="noopener" title="Download CSF" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M256 32c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 210.7-41.4-41.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l96 96c12.5 12.5 32.8 12.5 45.3 0l96-96c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L256 242.7 256 32zM64 320c-35.3 0-64 28.7-64 64l0 32c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-32c0-35.3-28.7-64-64-64l-46.9 0-56.6 56.6c-31.2 31.2-81.9 31.2-113.1 0L110.9 320 64 320zm304 56a24 24 0 1 1 0 48 24 24 0 1 1 0-48z"></path></svg>
    </a>
  
    
    
    
    
    <a href="https://blocklist.configserver.dev" target="_blank" rel="noopener" title="Service › Blocklists" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M224 32l192 0 0 80-192 0 0-80zm-32 80l-96 0 0-16c0-35.3 28.7-64 64-64l32 0 0 80zM96 144l208 0 0 96-208 0 0-96zm0 224l0-96 96 0 0 96-96 0zm0 32l176.7 0c-.5 4.7-.7 9.4-.7 14.1 0 22.9 3.7 45.1 10.6 65.9L160 480c-35.3 0-64-28.7-64-64l0-16zM544 144l0 60.2c-12 .3-23.8 3.9-34.1 11-7.9-7.9-15.9-15.6-24.2-23.1-23.8-21.4-60-21.5-83.9-.2-17 15.2-32.9 31.4-47.2 48.1l-18.6 0 0-96 208 0zM224 272l105.2 0c-6.4 8.8-12.3 17.6-17.7 26.3-13.2 21.3-25.1 45.2-32.3 69.7l-55.2 0 0-96zM544 112l-96 0 0-80 32 0c35.3 0 64 28.7 64 64l0 16zM505.7 272.3L518 258.5c5.4-6.1 13.3-8.8 20.9-8.9 7.2 0 14.3 2.6 19.9 7.8 19.7 18.3 39.8 43.2 55 70.6 15.1 27.2 26.2 58.1 26.2 88.1 0 88.7-71.3 159.8-160 159.8-89.6 0-160-71.3-160-159.8 0-37.3 16-73.4 36.8-104.5 20.9-31.3 47.5-59 70.9-80.2 5.7-5.2 13.1-7.7 20.3-7.5s13.4 3.2 18.8 7.5c14.4 11.4 38.9 40.7 38.9 40.7zM544 464.2c0-36.5-37-73-54.8-88.4-5.4-4.7-13.1-4.7-18.5 0-17.7 15.4-54.8 51.9-54.8 88.4 0 35.3 28.7 64 64 64s64-28.7 64-64z"></path></svg>
    </a>
  
    
    
    
    
    <a href="https://tickets.configserver.dev" target="_blank" rel="noopener" title="Submit Issue / Ticket" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3l48.2 0c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Aetherinox/csf-firewall" target="_blank" rel="noopener" title="View Github Repo" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg>
    </a>
  
    
    
    
    
    <a href="https://discord.configserver.dev" target="_blank" rel="noopener" title="Discord" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1 .1s-.6 .4-.8 .8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2c-41.3 7.1-81.6 19.6-119.7 37.1-.3 .1-.6 .4-.8 .7-76.2 113.8-97.1 224.9-86.9 334.5 0 .3 .1 .5 .2 .8s.3 .4 .5 .6c44.4 32.9 94 58 146.8 74.2 .4 .1 .8 .1 1.1 0s.7-.4 .9-.7c11.3-15.4 21.4-31.8 30-48.8 .1-.2 .2-.5 .2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6 .2-.9 .3-.5 .6-.7c3.1-2.3 6.2-4.7 9.1-7.1 .3-.2 .6-.4 .9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1 .7-.2 1-.2s.7 .2 .9 .4c2.9 2.4 6 4.9 9.1 7.2 .2 .2 .4 .4 .6 .7s.2 .6 .2 .9-.1 .6-.3 .9-.4 .5-.6 .6c-14.7 8.6-30 15.9-45.9 21.8-.2 .1-.5 .2-.7 .4s-.3 .4-.4 .7-.1 .5-.1 .8 .1 .5 .2 .8c8.8 17 18.8 33.3 30 48.8 .2 .3 .6 .6 .9 .7s.8 .1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2 .2-.2 .4-.4 .5-.6s.2-.5 .2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2zm195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2z"></path></svg>
    </a>
  
    
    
    
    
    <a href="https://buymeacoffee.com/aetherinox" target="_blank" rel="noopener" title="Sponsor" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M241 87.1l15 20.7 15-20.7C296 52.5 336.2 32 378.9 32 452.4 32 512 91.6 512 165.1l0 2.6c0 112.2-139.9 242.5-212.9 298.2-12.4 9.4-27.6 14.1-43.1 14.1s-30.8-4.6-43.1-14.1C139.9 410.2 0 279.9 0 167.7l0-2.6C0 91.6 59.6 32 133.1 32 175.8 32 216 52.5 241 87.1z"></path></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie Consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings">
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "toc.follow", "content.action.edit", "content.action.view", "content.tooltips", "search.highlight", "search.share", "search.suggest", "content.code.annotate", "content.code.select", "content.code.copy", "navigation.tabs", "navigation.sections", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.instant.prefetch", "navigation.tracking", "navigation.path", "navigation.top"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": {"CSS": "css", "HTML5": "html", "JavaScript": "js"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script>
    
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../js/timeago.min.js"></script>
      
        <script src="../../../js/timeago_mkdocs_material.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../../../javascripts/tablesort.js"></script>
      
        <script src="../../../javascripts/all.js?v7.000"></script>
      
        <script src="../../../javascripts/sponsors.js"></script>
      
    
    <script src="../../../assets/javascripts/custom.129bd6ad.min.js"></script>

  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>